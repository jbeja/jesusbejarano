/*
 jQuery v3.1.0 | (c) jQuery Foundation | jquery.org/license  Cropper.js v0.8.1
 https://github.com/fengyuanchen/cropperjs

 Copyright (c) 2015-2016 Fengyuan Chen
 Released under the MIT license

 Date: 2016-09-03T04:55:16.458Z
*/
!function(h,f){"object"==typeof module&&"object"==typeof module.exports?module.exports=h.document?f(h,!0):function(e){if(!e.document)throw Error("jQuery requires a window with a document");return f(e)}:f(h)}("undefined"!=typeof window?window:this,function(h,f){function e(a,c){c=c||V;var d=c.createElement("script");d.text=a;c.head.appendChild(d).parentNode.removeChild(d)}function b(a){var c=!!a&&"length"in a&&a.length,d=l.type(a);return"function"!==d&&!l.isWindow(a)&&("array"===d||0===c||"number"==
typeof c&&0<c&&c-1 in a)}function g(a,c,d){if(l.isFunction(c))return l.grep(a,function(a,b){return!!c.call(a,b,a)!==d});if(c.nodeType)return l.grep(a,function(a){return a===c!==d});if("string"==typeof c){if(nb.test(c))return l.filter(c,a,d);c=l.filter(c,a)}return l.grep(a,function(a){return-1<wa.call(c,a)!==d&&1===a.nodeType})}function d(a,c){for(;(a=a[c])&&1!==a.nodeType;);return a}function a(a){var c={};return l.each(a.match(ca)||[],function(a,d){c[d]=!0}),c}function c(a){return a}function m(a){throw a;
}function k(a,c,d){var b;try{a&&l.isFunction(b=a.promise)?b.call(a).done(c).fail(d):a&&l.isFunction(b=a.then)?b.call(a,c,d):c.call(void 0,a)}catch(Oa){d.call(void 0,Oa)}}function p(){V.removeEventListener("DOMContentLoaded",p);h.removeEventListener("load",p);l.ready()}function q(){this.expando=l.expando+q.uid++}function n(a,c,d){var b;if(void 0===d&&1===a.nodeType)if(b="data-"+c.replace(ob,"-$&").toLowerCase(),d=a.getAttribute(b),"string"==typeof d){try{d="true"===d||"false"!==d&&("null"===d?null:
+d+""===d?+d:pb.test(d)?JSON.parse(d):d)}catch(Oa){}aa.set(a,c,d)}else d=void 0;return d}function t(a,c,d,b){var g,e=1,f=20,m=b?function(){return b.cur()}:function(){return l.css(a,c,"")},k=m(),F=d&&d[3]||(l.cssNumber[c]?"":"px"),h=(l.cssNumber[c]||"px"!==F&&+k)&&ma.exec(l.css(a,c));if(h&&h[3]!==F){F=F||h[3];d=d||[];h=+k||1;do e=e||".5",h/=e,l.style(a,c,h+F);while(e!==(e=m()/k)&&1!==e&&--f)}return d&&(h=+h||+k||0,g=d[1]?h+(d[1]+1)*d[2]:+d[2],b&&(b.unit=F,b.start=h,b.end=g)),g}function r(a,c){for(var d,
b,g=[],e=0,f=a.length;e<f;e++)if(b=a[e],b.style)if(d=b.style.display,c){if("none"===d&&(g[e]=Q.get(b,"display")||null,g[e]||(b.style.display="")),""===b.style.display&&ya(b)){d=e;var m,k=void 0;m=b.ownerDocument;var F=b.nodeName;m=(b=Pa[F])?b:(k=m.body.appendChild(m.createElement(F)),b=l.css(k,"display"),k.parentNode.removeChild(k),"none"===b&&(b="block"),Pa[F]=b,b);g[d]=m}}else"none"!==d&&(g[e]="none",Q.set(b,"display",d));for(e=0;e<f;e++)null!=g[e]&&(a[e].style.display=g[e]);return a}function u(a,
d){var c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(d||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(d||"*"):[];return void 0===d||d&&l.nodeName(a,d)?l.merge([a],c):c}function A(a,d){for(var c=0,b=a.length;c<b;c++)Q.set(a[c],"globalEval",!d||Q.get(d[c],"globalEval"))}function y(a,d,c,b,g){for(var e,f,m,k,F=d.createDocumentFragment(),h=[],p=0,T=a.length;p<T;p++)if(e=a[p],e||0===e)if("object"===l.type(e))l.merge(h,e.nodeType?[e]:e);else if(sb.test(e)){f=f||F.appendChild(d.createElement("div"));
m=(Qa.exec(e)||["",""])[1].toLowerCase();m=ea[m]||ea._default;f.innerHTML=m[1]+l.htmlPrefilter(e)+m[2];for(m=m[0];m--;)f=f.lastChild;l.merge(h,f.childNodes);f=F.firstChild;f.textContent=""}else h.push(d.createTextNode(e));F.textContent="";for(p=0;e=h[p++];)if(b&&-1<l.inArray(e,b))g&&g.push(e);else if(k=l.contains(e.ownerDocument,e),f=u(F.appendChild(e),"script"),k&&A(f),c)for(m=0;e=f[m++];)Ra.test(e.type||"")&&c.push(e);return F}function v(){return!0}function x(){return!1}function z(){try{return V.activeElement}catch(F){}}
function w(a,d,c,b,g,e){var f,m;if("object"==typeof d){"string"!=typeof c&&(b=b||c,c=void 0);for(m in d)w(a,m,c,b,d[m],e);return a}if(null==b&&null==g?(g=c,b=c=void 0):null==g&&("string"==typeof c?(g=b,b=void 0):(g=b,b=c,c=void 0)),!1===g)g=x;else if(!g)return a;return 1===e&&(f=g,g=function(a){return l().off(a),f.apply(this,arguments)},g.guid=f.guid||(f.guid=l.guid++)),a.each(function(){l.event.add(this,d,g,b,c)})}function B(a,c){return l.nodeName(a,"table")&&l.nodeName(11!==c.nodeType?c:c.firstChild,
"tr")?a.getElementsByTagName("tbody")[0]||a:a}function C(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function E(a){var c=tb.exec(a.type);return c?a.type=c[1]:a.removeAttribute("type"),a}function I(a,c){var d,b,g,e,f,m;if(1===c.nodeType){if(Q.hasData(a)&&(d=Q.access(a),b=Q.set(c,d),m=d.events))for(g in delete b.handle,b.events={},m)for(d=0,b=m[g].length;d<b;d++)l.event.add(c,g,m[g][d]);aa.hasData(a)&&(e=aa.access(a),f=l.extend({},e),aa.set(c,f))}}function J(a,c,d,b){c=za.apply([],
c);var g,f,m,k,F=0,h=a.length,p=h-1,T=c[0],r=l.isFunction(T);if(r||1<h&&"string"==typeof T&&!W.checkClone&&ub.test(T))return a.each(function(g){var e=a.eq(g);r&&(c[0]=T.call(this,g,e.html()));J(e,c,d,b)});if(h&&(g=y(c,a[0].ownerDocument,!1,a,b),f=g.firstChild,1===g.childNodes.length&&(g=f),f||b)){f=l.map(u(g,"script"),C);for(m=f.length;F<h;F++)k=g,F!==p&&(k=l.clone(k,!0,!0),m&&l.merge(f,u(k,"script"))),d.call(a[F],k,F);if(m)for(g=f[f.length-1].ownerDocument,l.map(f,E),F=0;F<m;F++)k=f[F],Ra.test(k.type||
"")&&!Q.access(k,"globalEval")&&l.contains(g,k)&&(k.src?l._evalUrl&&l._evalUrl(k.src):e(k.textContent.replace(vb,""),g))}return a}function D(a,c,d){for(var b=c?l.filter(c,a):a,g=0;null!=(c=b[g]);g++)d||1!==c.nodeType||l.cleanData(u(c)),c.parentNode&&(d&&l.contains(c.ownerDocument,c)&&A(u(c,"script")),c.parentNode.removeChild(c));return a}function N(a,c,d){var b,g,e,f,m=a.style;return d=d||Aa(a),d&&(f=d.getPropertyValue(c)||d[c],""!==f||l.contains(a.ownerDocument,a)||(f=l.style(a,c)),!W.pixelMarginRight()&&
Fa.test(f)&&Sa.test(c)&&(b=m.width,g=m.minWidth,e=m.maxWidth,m.minWidth=m.maxWidth=m.width=f,f=d.width,m.width=b,m.minWidth=g,m.maxWidth=e)),void 0!==f?f+"":f}function O(a,c){return{get:function(){return a()?void delete this.get:(this.get=c).apply(this,arguments)}}}function G(a){if(a in Ta)return a;for(var c=a[0].toUpperCase()+a.slice(1),d=Ua.length;d--;)if(a=Ua[d]+c,a in Ta)return a}function L(a,c,d){return(a=ma.exec(c))?Math.max(0,a[2]-(d||0))+(a[3]||"px"):c}function M(a,c,d,b,g){c=d===(b?"border":
"content")?4:"width"===c?1:0;for(var e=0;4>c;c+=2)"margin"===d&&(e+=l.css(a,d+na[c],!0,g)),b?("content"===d&&(e-=l.css(a,"padding"+na[c],!0,g)),"margin"!==d&&(e-=l.css(a,"border"+na[c]+"Width",!0,g))):(e+=l.css(a,"padding"+na[c],!0,g),"padding"!==d&&(e+=l.css(a,"border"+na[c]+"Width",!0,g)));return e}function P(a,c,d){var b,g=!0,e=Aa(a),f="border-box"===l.css(a,"boxSizing",!1,e);if(a.getClientRects().length&&(b=a.getBoundingClientRect()[c]),0>=b||null==b){if(b=N(a,c,e),(0>b||null==b)&&(b=a.style[c]),
Fa.test(b))return b;g=f&&(W.boxSizingReliable()||b===a.style[c]);b=parseFloat(b)||0}return b+M(a,c,d||(f?"border":"content"),g,e)+"px"}function R(a,c,d,b,g){return new R.prototype.init(a,c,d,b,g)}function S(){ra&&(h.requestAnimationFrame(S),l.fx.tick())}function H(){return h.setTimeout(function(){ia=void 0}),ia=l.now()}function Z(a,c){var d,b=0,g={height:a};for(c=c?1:0;4>b;b+=2-c)d=na[b],g["margin"+d]=g["padding"+d]=a;return c&&(g.opacity=g.width=a),g}function ba(a,c,d){for(var b,g=(X.tweeners[c]||
[]).concat(X.tweeners["*"]),e=0,f=g.length;e<f;e++)if(b=g[e].call(d,c,a))return b}function fa(a,c){var d,b,g,e,f;for(d in a)if(b=l.camelCase(d),g=c[b],e=a[d],l.isArray(e)&&(g=e[1],e=a[d]=e[0]),d!==b&&(a[b]=e,delete a[d]),f=l.cssHooks[b],f&&"expand"in f)for(d in e=f.expand(e),delete a[b],e)d in a||(a[d]=e[d],c[d]=g);else c[b]=g}function X(a,c,d){var b,g=0,e=X.prefilters.length,f=l.Deferred().always(function(){delete m.elem}),m=function(){if(b)return!1;for(var c=ia||H(),c=Math.max(0,k.startTime+k.duration-
c),d=1-(c/k.duration||0),g=0,e=k.tweens.length;g<e;g++)k.tweens[g].run(d);return f.notifyWith(a,[k,d,c]),1>d&&e?c:(f.resolveWith(a,[k]),!1)},k=f.promise({elem:a,props:l.extend({},c),opts:l.extend(!0,{specialEasing:{},easing:l.easing._default},d),originalProperties:c,originalOptions:d,startTime:ia||H(),duration:d.duration,tweens:[],createTween:function(c,d){var b=l.Tween(a,k.opts,c,d,k.opts.specialEasing[c]||k.opts.easing);return k.tweens.push(b),b},stop:function(c){var d=0,g=c?k.tweens.length:0;if(b)return this;
for(b=!0;d<g;d++)k.tweens[d].run(1);return c?(f.notifyWith(a,[k,1,0]),f.resolveWith(a,[k,c])):f.rejectWith(a,[k,c]),this}});d=k.props;for(fa(d,k.opts.specialEasing);g<e;g++)if(c=X.prefilters[g].call(k,a,d,k.opts))return l.isFunction(c.stop)&&(l._queueHooks(k.elem,k.opts.queue).stop=l.proxy(c.stop,c)),c;return l.map(d,ba,k),l.isFunction(k.opts.start)&&k.opts.start.call(a,k),l.fx.timer(l.extend(m,{elem:a,anim:k,queue:k.opts.queue})),k.progress(k.opts.progress).done(k.opts.done,k.opts.complete).fail(k.opts.fail).always(k.opts.always)}
function Y(a){return a.getAttribute&&a.getAttribute("class")||""}function U(a,c,d,b){var g;if(l.isArray(c))l.each(c,function(c,g){d||wb.test(a)?b(a,g):U(a+"["+("object"==typeof g&&null!=g?c:"")+"]",g,d,b)});else if(d||"object"!==l.type(c))b(a,c);else for(g in c)U(a+"["+g+"]",c[g],d,b)}function K(a){return function(c,d){"string"!=typeof c&&(d=c,c="*");var b,g=0,e=c.toLowerCase().match(ca)||[];if(l.isFunction(d))for(;b=e[g++];)"+"===b[0]?(b=b.slice(1)||"*",(a[b]=a[b]||[]).unshift(d)):(a[b]=a[b]||[]).push(d)}}
function da(a,c,d,b){function g(m){var k;return e[m]=!0,l.each(a[m]||[],function(a,m){var h=m(c,d,b);return"string"!=typeof h||f||e[h]?f?!(k=h):void 0:(c.dataTypes.unshift(h),g(h),!1)}),k}var e={},f=a===Ga;return g(c.dataTypes[0])||!e["*"]&&g("*")}function ga(a,c){var d,b,g=l.ajaxSettings.flatOptions||{};for(d in c)void 0!==c[d]&&((g[d]?a:b||(b={}))[d]=c[d]);return b&&l.extend(!0,a,b),a}function ha(a){return l.isWindow(a)?a:9===a.nodeType&&a.defaultView}var la=[],V=h.document,Ha=Object.getPrototypeOf,
oa=la.slice,za=la.concat,xa=la.push,wa=la.indexOf,Ba={},Va=Ba.toString,Ca=Ba.hasOwnProperty,Wa=Ca.toString,xb=Wa.call(Object),W={},l=function(a,c){return new l.fn.init(a,c)},yb=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,zb=/^-ms-/,Ab=/-([a-z])/g,Bb=function(a,c){return c.toUpperCase()};l.fn=l.prototype={jquery:"3.1.0",constructor:l,length:0,toArray:function(){return oa.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:oa.call(this)},pushStack:function(a){a=l.merge(this.constructor(),
a);return a.prevObject=this,a},each:function(a){return l.each(this,a)},map:function(a){return this.pushStack(l.map(this,function(c,d){return a.call(c,d,c)}))},slice:function(){return this.pushStack(oa.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var c=this.length;a=+a+(0>a?c:0);return this.pushStack(0<=a&&a<c?[this[a]]:[])},end:function(){return this.prevObject||this.constructor()},push:xa,sort:la.sort,splice:la.splice};l.extend=l.fn.extend=
function(){var a,c,d,b,g,e,f=arguments[0]||{},m=1,k=arguments.length,h=!1;"boolean"==typeof f&&(h=f,f=arguments[m]||{},m++);"object"==typeof f||l.isFunction(f)||(f={});for(m===k&&(f=this,m--);m<k;m++)if(null!=(a=arguments[m]))for(c in a)d=f[c],b=a[c],f!==b&&(h&&b&&(l.isPlainObject(b)||(g=l.isArray(b)))?(g?(g=!1,e=d&&l.isArray(d)?d:[]):e=d&&l.isPlainObject(d)?d:{},f[c]=l.extend(h,e,b)):void 0!==b&&(f[c]=b));return f};l.extend({expando:"jQuery"+("3.1.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a);
},noop:function(){},isFunction:function(a){return"function"===l.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var c=l.type(a);return("number"===c||"string"===c)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var c,d;return!(!a||"[object Object]"!==Va.call(a))&&(!(c=Ha(a))||(d=Ca.call(c,"constructor")&&c.constructor,"function"==typeof d&&Wa.call(d)===xb))},isEmptyObject:function(a){for(var c in a)return!1;return!0},type:function(a){return null==
a?a+"":"object"==typeof a||"function"==typeof a?Ba[Va.call(a)]||"object":typeof a},globalEval:function(a){e(a)},camelCase:function(a){return a.replace(zb,"ms-").replace(Ab,Bb)},nodeName:function(a,c){return a.nodeName&&a.nodeName.toLowerCase()===c.toLowerCase()},each:function(a,c){var d,g=0;if(b(a))for(d=a.length;g<d&&!1!==c.call(a[g],g,a[g]);g++);else for(g in a)if(!1===c.call(a[g],g,a[g]))break;return a},trim:function(a){return null==a?"":(a+"").replace(yb,"")},makeArray:function(a,c){var d=c||
[];return null!=a&&(b(Object(a))?l.merge(d,"string"==typeof a?[a]:a):xa.call(d,a)),d},inArray:function(a,c,d){return null==c?-1:wa.call(c,a,d)},merge:function(a,c){for(var d=+c.length,b=0,g=a.length;b<d;b++)a[g++]=c[b];return a.length=g,a},grep:function(a,c,d){for(var b=[],g=0,e=a.length,f=!d;g<e;g++)d=!c(a[g],g),d!==f&&b.push(a[g]);return b},map:function(a,c,d){var g,e,f=0,m=[];if(b(a))for(g=a.length;f<g;f++)e=c(a[f],f,d),null!=e&&m.push(e);else for(f in a)e=c(a[f],f,d),null!=e&&m.push(e);return za.apply([],
m)},guid:1,proxy:function(a,c){var d,b,g;if("string"==typeof c&&(d=a[c],c=a,a=d),l.isFunction(a))return b=oa.call(arguments,2),g=function(){return a.apply(c||this,b.concat(oa.call(arguments)))},g.guid=a.guid=a.guid||l.guid++,g},now:Date.now,support:W});"function"==typeof Symbol&&(l.fn[Symbol.iterator]=la[Symbol.iterator]);l.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,c){Ba["[object "+c+"]"]=c.toLowerCase()});var ja=function(a){function c(a,c,d,
b){var g,e,f,m,k,h=c&&c.ownerDocument,p=c?c.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==p&&9!==p&&11!==p)return d;if(!b&&((c?c.ownerDocument||c:K)!==G&&E(c),c=c||G,M)){if(11!==p&&(m=sa.exec(a)))if(g=m[1])if(9===p){if(!(e=c.getElementById(g)))return d;if(e.id===g)return d.push(e),d}else{if(h&&(e=h.getElementById(g))&&I(c,e)&&e.id===g)return d.push(e),d}else{if(m[2])return W.apply(d,c.getElementsByTagName(a)),d;if((g=m[3])&&v.getElementsByClassName&&c.getElementsByClassName)return W.apply(d,c.getElementsByClassName(g)),
d}if(!(!v.qsa||fa[a+" "]||U&&U.test(a))){if(1!==p)h=c,k=a;else if("object"!==c.nodeName.toLowerCase()){(f=c.getAttribute("id"))?f=f.replace(ta,ua):c.setAttribute("id",f=P);e=B(a);for(g=e.length;g--;)e[g]="#"+f+" "+q(e[g]);k=e.join(",");h=ma.test(a)&&F(c.parentNode)||c}if(k)try{return W.apply(d,h.querySelectorAll(k)),d}catch(ic){}finally{f===P&&c.removeAttribute("id")}}}return N(a.replace(ca,"$1"),c,d,b)}function d(){function a(d,b){return c.push(d+" ")>w.cacheLength&&delete a[c.shift()],a[d+" "]=
b}var c=[];return a}function b(a){return a[P]=!0,a}function g(a){var c=G.createElement("fieldset");try{return!!a(c)}catch(gc){return!1}finally{c.parentNode&&c.parentNode.removeChild(c)}}function e(a,c){for(var d=a.split("|"),b=d.length;b--;)w.attrHandle[d[b]]=c}function f(a,c){var d=c&&a,b=d&&1===a.nodeType&&1===c.nodeType&&a.sourceIndex-c.sourceIndex;if(b)return b;if(d)for(;d=d.nextSibling;)if(d===c)return-1;return a?1:-1}function m(a){return function(c){return"input"===c.nodeName.toLowerCase()&&
c.type===a}}function k(a){return function(c){var d=c.nodeName.toLowerCase();return("input"===d||"button"===d)&&c.type===a}}function h(a){return function(c){return"label"in c&&c.disabled===a||"form"in c&&c.disabled===a||"form"in c&&!1===c.disabled&&(c.isDisabled===a||c.isDisabled!==!a&&("label"in c||!wa(c))!==a)}}function p(a){return b(function(c){return c=+c,b(function(d,b){for(var g,e=a([],d.length,c),f=e.length;f--;)d[g=e[f]]&&(d[g]=!(b[g]=d[g]))})})}function F(a){return a&&"undefined"!=typeof a.getElementsByTagName&&
a}function r(){}function q(a){for(var c=0,d=a.length,b="";c<d;c++)b+=a[c].value;return b}function n(a,c,d){var b=c.dir,g=c.next,e=g||b,f=d&&"parentNode"===e,m=J++;return c.first?function(c,d,g){for(;c=c[b];)if(1===c.nodeType||f)return a(c,d,g)}:function(c,d,k){var h,p,F,r=[ba,m];if(k)for(;c=c[b];){if((1===c.nodeType||f)&&a(c,d,k))return!0}else for(;c=c[b];)if(1===c.nodeType||f)if(F=c[P]||(c[P]={}),p=F[c.uniqueID]||(F[c.uniqueID]={}),g&&g===c.nodeName.toLowerCase())c=c[b]||c;else{if((h=p[e])&&h[0]===
ba&&h[1]===m)return r[2]=h[2];if(p[e]=r,r[2]=a(c,d,k))return!0}}}function u(a){return 1<a.length?function(c,d,b){for(var g=a.length;g--;)if(!a[g](c,d,b))return!1;return!0}:a[0]}function l(a,c,d,b,g){for(var e,f=[],m=0,k=a.length,h=null!=c;m<k;m++)(e=a[m])&&(d&&!d(e,b,g)||(f.push(e),h&&c.push(m)));return f}function A(a,d,g,e,f,m){return e&&!e[P]&&(e=A(e)),f&&!f[P]&&(f=A(f,m)),b(function(b,m,k,h){var p,F,r=[],q=[],n=m.length,u;if(!(u=b)){u=d||"*";for(var T=k.nodeType?[k]:k,A=[],t=0,y=T.length;t<y;t++)c(u,
T[t],A);u=A}u=!a||!b&&d?u:l(u,r,a,k,h);T=g?f||(b?a:n||e)?[]:m:u;if(g&&g(u,T,k,h),e)for(p=l(T,q),e(p,[],k,h),k=p.length;k--;)(F=p[k])&&(T[q[k]]=!(u[q[k]]=F));if(b){if(f||a){if(f){p=[];for(k=T.length;k--;)(F=T[k])&&p.push(u[k]=F);f(null,T=[],p,h)}for(k=T.length;k--;)(F=T[k])&&-1<(p=f?aa(b,F):r[k])&&(b[p]=!(m[p]=F))}}else T=l(T===m?T.splice(n,T.length):T),f?f(null,m,T,h):W.apply(m,T)})}function t(a){var c,d,b,g=a.length,e=w.relative[a[0].type];d=e||w.relative[" "];for(var f=e?1:0,m=n(function(a){return a===
c},d,!0),k=n(function(a){return-1<aa(c,a)},d,!0),h=[function(a,d,b){a=!e&&(b||d!==O)||((c=d).nodeType?m(a,d,b):k(a,d,b));return c=null,a}];f<g;f++)if(d=w.relative[a[f].type])h=[n(u(h),d)];else{if(d=w.filter[a[f].type].apply(null,a[f].matches),d[P]){for(b=++f;b<g&&!w.relative[a[b].type];b++);return A(1<f&&u(h),1<f&&q(a.slice(0,f-1).concat({value:" "===a[f-2].type?"*":""})).replace(ca,"$1"),d,f<b&&t(a.slice(f,b)),b<g&&t(a=a.slice(b)),b<g&&q(a))}h.push(d)}return u(h)}function y(a,d){var g=0<d.length,
e=0<a.length,f=function(b,f,m,k,h){var p,F,r,q=0,n="0",u=b&&[],T=[],A=O,t=b||e&&w.find.TAG("*",h),y=ba+=null==A?1:Math.random()||.1,v=t.length;for(h&&(O=f===G||f||h);n!==v&&null!=(p=t[n]);n++){if(e&&p){F=0;for(f||p.ownerDocument===G||(E(p),m=!M);r=a[F++];)if(r(p,f||G,m)){k.push(p);break}h&&(ba=y)}g&&((p=!r&&p)&&q--,b&&u.push(p))}if(q+=n,g&&n!==q){for(F=0;r=d[F++];)r(u,T,f,m);if(b){if(0<q)for(;n--;)u[n]||T[n]||(T[n]=V.call(k));T=l(T)}W.apply(k,T);h&&!b&&0<T.length&&1<q+d.length&&c.uniqueSort(k)}return h&&
(ba=y,O=A),u};return g?b(f):f}var z,v,w,x,R,B,C,N,O,H,S,E,G,L,M,U,Z,D,I,P="sizzle"+1*new Date,K=a.document,ba=0,J=0,X=d(),Y=d(),fa=d(),da=function(a,c){return a===c&&(S=!0),0},ga={}.hasOwnProperty,Q=[],V=Q.pop,ha=Q.push,W=Q.push,la=Q.slice,aa=function(a,c){for(var d=0,b=a.length;d<b;d++)if(a[d]===c)return d;return-1},ea=RegExp("[\\x20\\t\\r\\n\\f]+","g"),ca=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),oa=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,ka=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,
na=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),Ha=/:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,xa=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,ja={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,
ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},za=/^(?:input|select|textarea|button)$/i,ra=/^h\d$/i,ia=/^[^{]+\{\s*\[native \w/,sa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ma=/[+~]/,pa=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),qa=function(a,c,
d){a="0x"+c-65536;return a!==a||d?c:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320)},ta=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,ua=function(a,c){return c?"\x00"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},va=function(){E()},wa=n(function(a){return!0===a.disabled},{dir:"parentNode",next:"legend"});try{W.apply(Q=la.call(K.childNodes),K.childNodes),Q[K.childNodes.length].nodeType}catch(fc){W={apply:Q.length?function(a,c){ha.apply(a,
la.call(c))}:function(a,c){for(var d=a.length,b=0;a[d++]=c[b++];);a.length=d-1}}}v=c.support={};R=c.isXML=function(a){a=a&&(a.ownerDocument||a).documentElement;return!!a&&"HTML"!==a.nodeName};E=c.setDocument=function(a){var c,d;a=a?a.ownerDocument||a:K;return a!==G&&9===a.nodeType&&a.documentElement?(G=a,L=G.documentElement,M=!R(G),K!==G&&(d=G.defaultView)&&d.top!==d&&(d.addEventListener?d.addEventListener("unload",va,!1):d.attachEvent&&d.attachEvent("onunload",va)),v.attributes=g(function(a){return a.className=
"i",!a.getAttribute("className")}),v.getElementsByTagName=g(function(a){return a.appendChild(G.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=ia.test(G.getElementsByClassName),v.getById=g(function(a){return L.appendChild(a).id=P,!G.getElementsByName||!G.getElementsByName(P).length}),v.getById?(w.find.ID=function(a,c){if("undefined"!=typeof c.getElementById&&M){var d=c.getElementById(a);return d?[d]:[]}},w.filter.ID=function(a){var c=a.replace(pa,qa);return function(a){return a.getAttribute("id")===
c}}):(delete w.find.ID,w.filter.ID=function(a){var c=a.replace(pa,qa);return function(a){return(a="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===c}}),w.find.TAG=v.getElementsByTagName?function(a,c){return"undefined"!=typeof c.getElementsByTagName?c.getElementsByTagName(a):v.qsa?c.querySelectorAll(a):void 0}:function(a,c){var d,b=[],g=0,e=c.getElementsByTagName(a);if("*"===a){for(;d=e[g++];)1===d.nodeType&&b.push(d);return b}return e},w.find.CLASS=v.getElementsByClassName&&
function(a,c){if("undefined"!=typeof c.getElementsByClassName&&M)return c.getElementsByClassName(a)},Z=[],U=[],(v.qsa=ia.test(G.querySelectorAll))&&(g(function(a){L.appendChild(a).innerHTML="<a id='"+P+"'></a><select id='"+P+"-\r\\' msallowcapture=''><option selected=''></option></select>";a.querySelectorAll("[msallowcapture^='']").length&&U.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||U.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
a.querySelectorAll("[id~="+P+"-]").length||U.push("~=");a.querySelectorAll(":checked").length||U.push(":checked");a.querySelectorAll("a#"+P+"+*").length||U.push(".#.+[+~]")}),g(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var c=G.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&U.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==a.querySelectorAll(":enabled").length&&
U.push(":enabled",":disabled");L.appendChild(a).disabled=!0;2!==a.querySelectorAll(":disabled").length&&U.push(":enabled",":disabled");a.querySelectorAll("*,:x");U.push(",.*:")})),(v.matchesSelector=ia.test(D=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&g(function(a){v.disconnectedMatch=D.call(a,"*");D.call(a,"[s!='']:x");Z.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")}),
U=U.length&&new RegExp(U.join("|")),Z=Z.length&&new RegExp(Z.join("|")),c=ia.test(L.compareDocumentPosition),I=c||ia.test(L.contains)?function(a,c){var d=9===a.nodeType?a.documentElement:a,b=c&&c.parentNode;return a===b||!(!b||1!==b.nodeType||!(d.contains?d.contains(b):a.compareDocumentPosition&&16&a.compareDocumentPosition(b)))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1},da=c?function(a,c){if(a===c)return S=!0,0;var d=!a.compareDocumentPosition-!c.compareDocumentPosition;
return d?d:(d=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1,1&d||!v.sortDetached&&c.compareDocumentPosition(a)===d?a===G||a.ownerDocument===K&&I(K,a)?-1:c===G||c.ownerDocument===K&&I(K,c)?1:H?aa(H,a)-aa(H,c):0:4&d?-1:1)}:function(a,c){if(a===c)return S=!0,0;var d,b=0;d=a.parentNode;var g=c.parentNode,e=[a],m=[c];if(!d||!g)return a===G?-1:c===G?1:d?-1:g?1:H?aa(H,a)-aa(H,c):0;if(d===g)return f(a,c);for(d=a;d=d.parentNode;)e.unshift(d);for(d=c;d=d.parentNode;)m.unshift(d);
for(;e[b]===m[b];)b++;return b?f(e[b],m[b]):e[b]===K?-1:m[b]===K?1:0},G):G};c.matches=function(a,d){return c(a,null,null,d)};c.matchesSelector=function(a,d){if((a.ownerDocument||a)!==G&&E(a),d=d.replace(na,"='$1']"),!(!v.matchesSelector||!M||fa[d+" "]||Z&&Z.test(d)||U&&U.test(d)))try{var b=D.call(a,d);if(b||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return b}catch(hc){}return 0<c(d,G,null,[a]).length};c.contains=function(a,c){return(a.ownerDocument||a)!==G&&E(a),I(a,c)};c.attr=function(a,
c){(a.ownerDocument||a)!==G&&E(a);var d=w.attrHandle[c.toLowerCase()],d=d&&ga.call(w.attrHandle,c.toLowerCase())?d(a,c,!M):void 0;return void 0!==d?d:v.attributes||!M?a.getAttribute(c):(d=a.getAttributeNode(c))&&d.specified?d.value:null};c.escape=function(a){return(a+"").replace(ta,ua)};c.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};c.uniqueSort=function(a){var c,d=[],b=0,g=0;if(S=!v.detectDuplicates,H=!v.sortStable&&a.slice(0),a.sort(da),S){for(;c=a[g++];)c===a[g]&&
(b=d.push(g));for(;b--;)a.splice(d[b],1)}return H=null,a};x=c.getText=function(a){var c,d="",b=0;if(c=a.nodeType)if(1===c||9===c||11===c){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)d+=x(a)}else{if(3===c||4===c)return a.nodeValue}else for(;c=a[b++];)d+=x(c);return d};w=c.selectors={cacheLength:50,createPseudo:b,match:ja,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},
preFilter:{ATTR:function(a){return a[1]=a[1].replace(pa,qa),a[3]=(a[3]||a[4]||a[5]||"").replace(pa,qa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||c.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&c.error(a[0]),a},PSEUDO:function(a){var c,d=!a[6]&&a[2];return ja.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":d&&Ha.test(d)&&(c=B(d,!0))&&(c=d.indexOf(")",
d.length-c)-d.length)&&(a[0]=a[0].slice(0,c),a[2]=d.slice(0,c)),a.slice(0,3))}},filter:{TAG:function(a){var c=a.replace(pa,qa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===c}},CLASS:function(a){var c=X[a+" "];return c||(c=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"),X(a,function(a){return c.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")}))},ATTR:function(a,
d,b){return function(g){g=c.attr(g,a);return null==g?"!="===d:!d||(g+="","="===d?g===b:"!="===d?g!==b:"^="===d?b&&0===g.indexOf(b):"*="===d?b&&-1<g.indexOf(b):"$="===d?b&&g.slice(-b.length)===b:"~="===d?-1<(" "+g.replace(ea," ")+" ").indexOf(b):"|="===d&&(g===b||g.slice(0,b.length+1)===b+"-"))}},CHILD:function(a,c,d,b,g){var e="nth"!==a.slice(0,3),f="last"!==a.slice(-4),m="of-type"===c;return 1===b&&0===g?function(a){return!!a.parentNode}:function(c,d,k){var h,p,F,r,q,n;d=e!==f?"nextSibling":"previousSibling";
var u=c.parentNode,T=m&&c.nodeName.toLowerCase();k=!k&&!m;var l=!1;if(u){if(e){for(;d;){for(r=c;r=r[d];)if(m?r.nodeName.toLowerCase()===T:1===r.nodeType)return!1;n=d="only"===a&&!n&&"nextSibling"}return!0}if(n=[f?u.firstChild:u.lastChild],f&&k)for(r=u,F=r[P]||(r[P]={}),p=F[r.uniqueID]||(F[r.uniqueID]={}),h=p[a]||[],l=(q=h[0]===ba&&h[1])&&h[2],r=q&&u.childNodes[q];r=++q&&r&&r[d]||(l=q=0)||n.pop();){if(1===r.nodeType&&++l&&r===c){p[a]=[ba,q,l];break}}else if(k&&(r=c,F=r[P]||(r[P]={}),p=F[r.uniqueID]||
(F[r.uniqueID]={}),h=p[a]||[],q=h[0]===ba&&h[1],l=q),!1===l)for(;(r=++q&&r&&r[d]||(l=q=0)||n.pop())&&((m?r.nodeName.toLowerCase()!==T:1!==r.nodeType)||!++l||(k&&(F=r[P]||(r[P]={}),p=F[r.uniqueID]||(F[r.uniqueID]={}),p[a]=[ba,l]),r!==c)););return l-=g,l===b||0===l%b&&0<=l/b}}},PSEUDO:function(a,d){var g,e=w.pseudos[a]||w.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+a);return e[P]?e(d):1<e.length?(g=[a,a,"",d],w.setFilters.hasOwnProperty(a.toLowerCase())?b(function(a,c){for(var b,g=e(a,
d),f=g.length;f--;)b=aa(a,g[f]),a[b]=!(c[b]=g[f])}):function(a){return e(a,0,g)}):e}},pseudos:{not:b(function(a){var c=[],d=[],g=C(a.replace(ca,"$1"));return g[P]?b(function(a,c,d,b){var e;d=g(a,null,b,[]);for(b=a.length;b--;)(e=d[b])&&(a[b]=!(c[b]=e))}):function(a,b,e){return c[0]=a,g(c,null,e,d),c[0]=null,!d.pop()}}),has:b(function(a){return function(d){return 0<c(a,d).length}}),contains:b(function(a){return a=a.replace(pa,qa),function(c){return-1<(c.textContent||c.innerText||x(c)).indexOf(a)}}),
lang:b(function(a){return xa.test(a||"")||c.error("unsupported lang: "+a),a=a.replace(pa,qa).toLowerCase(),function(c){var d;do if(d=M?c.lang:c.getAttribute("xml:lang")||c.getAttribute("lang"))return d=d.toLowerCase(),d===a||0===d.indexOf(a+"-");while((c=c.parentNode)&&1===c.nodeType);return!1}}),target:function(c){var d=a.location&&a.location.hash;return d&&d.slice(1)===c.id},root:function(a){return a===L},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||
~a.tabIndex)},enabled:h(!1),disabled:h(!0),checked:function(a){var c=a.nodeName.toLowerCase();return"input"===c&&!!a.checked||"option"===c&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return ra.test(a.nodeName)},input:function(a){return za.test(a.nodeName)},button:function(a){var c=a.nodeName.toLowerCase();
return"input"===c&&"button"===a.type||"button"===c},text:function(a){var c;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(c=a.getAttribute("type"))||"text"===c.toLowerCase())},first:p(function(){return[0]}),last:p(function(a,c){return[c-1]}),eq:p(function(a,c,d){return[0>d?d+c:d]}),even:p(function(a,c){for(var d=0;d<c;d+=2)a.push(d);return a}),odd:p(function(a,c){for(var d=1;d<c;d+=2)a.push(d);return a}),lt:p(function(a,c,d){for(c=0>d?d+c:d;0<=--c;)a.push(c);return a}),gt:p(function(a,
c,d){for(d=0>d?d+c:d;++d<c;)a.push(d);return a})}};w.pseudos.nth=w.pseudos.eq;for(z in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[z]=m(z);for(z in{submit:!0,reset:!0})w.pseudos[z]=k(z);r.prototype=w.filters=w.pseudos;w.setFilters=new r;B=c.tokenize=function(a,d){var b,g,e,f,m,k,h;if(m=Y[a+" "])return d?0:m.slice(0);m=a;k=[];for(h=w.preFilter;m;){b&&!(g=oa.exec(m))||(g&&(m=m.slice(g[0].length)||m),k.push(e=[]));b=!1;(g=ka.exec(m))&&(b=g.shift(),e.push({value:b,type:g[0].replace(ca,
" ")}),m=m.slice(b.length));for(f in w.filter)!(g=ja[f].exec(m))||h[f]&&!(g=h[f](g))||(b=g.shift(),e.push({value:b,type:f,matches:g}),m=m.slice(b.length));if(!b)break}return d?m.length:m?c.error(a):Y(a,k).slice(0)};return C=c.compile=function(a,c){var d,b=[],g=[],e=fa[a+" "];if(!e){c||(c=B(a));for(d=c.length;d--;)e=t(c[d]),e[P]?b.push(e):g.push(e);e=fa(a,y(g,b));e.selector=a}return e},N=c.select=function(a,c,d,b){var g,e,f,m,k,h="function"==typeof a&&a,p=!b&&B(a=h.selector||a);if(d=d||[],1===p.length){if(e=
p[0]=p[0].slice(0),2<e.length&&"ID"===(f=e[0]).type&&v.getById&&9===c.nodeType&&M&&w.relative[e[1].type]){if(c=(w.find.ID(f.matches[0].replace(pa,qa),c)||[])[0],!c)return d;h&&(c=c.parentNode);a=a.slice(e.shift().value.length)}for(g=ja.needsContext.test(a)?0:e.length;g--&&(f=e[g],!w.relative[m=f.type]);)if((k=w.find[m])&&(b=k(f.matches[0].replace(pa,qa),ma.test(e[0].type)&&F(c.parentNode)||c))){if(e.splice(g,1),a=b.length&&q(e),!a)return W.apply(d,b),d;break}}return(h||C(a,p))(b,c,!M,d,!c||ma.test(a)&&
F(c.parentNode)||c),d},v.sortStable=P.split("").sort(da).join("")===P,v.detectDuplicates=!!S,E(),v.sortDetached=g(function(a){return 1&a.compareDocumentPosition(G.createElement("fieldset"))}),g(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||e("type|href|height|width",function(a,c,d){if(!d)return a.getAttribute(c,"type"===c.toLowerCase()?1:2)}),v.attributes&&g(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||
e("value",function(a,c,d){if(!d&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),g(function(a){return null==a.getAttribute("disabled")})||e("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,c,d){var b;if(!d)return!0===a[c]?c.toLowerCase():(b=a.getAttributeNode(c))&&b.specified?b.value:null}),c}(h);l.find=ja;l.expr=ja.selectors;l.expr[":"]=l.expr.pseudos;l.uniqueSort=l.unique=ja.uniqueSort;l.text=ja.getText;
l.isXMLDoc=ja.isXML;l.contains=ja.contains;l.escapeSelector=ja.escape;var sa=function(a,c,d){for(var b=[],g=void 0!==d;(a=a[c])&&9!==a.nodeType;)if(1===a.nodeType){if(g&&l(a).is(d))break;b.push(a)}return b},Ya=function(a,c){for(var d=[];a;a=a.nextSibling)1===a.nodeType&&a!==c&&d.push(a);return d},Za=l.expr.match.needsContext,$a=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,nb=/^.[^:#\[\.,]*$/;l.filter=function(a,c,d){var b=c[0];return d&&(a=":not("+a+")"),1===c.length&&1===b.nodeType?
l.find.matchesSelector(b,a)?[b]:[]:l.find.matches(a,l.grep(c,function(a){return 1===a.nodeType}))};l.fn.extend({find:function(a){var c,d,b=this.length,g=this;if("string"!=typeof a)return this.pushStack(l(a).filter(function(){for(c=0;c<b;c++)if(l.contains(g[c],this))return!0}));d=this.pushStack([]);for(c=0;c<b;c++)l.find(a,g[c],d);return 1<b?l.uniqueSort(d):d},filter:function(a){return this.pushStack(g(this,a||[],!1))},not:function(a){return this.pushStack(g(this,a||[],!0))},is:function(a){return!!g(this,
"string"==typeof a&&Za.test(a)?l(a):a||[],!1).length}});var ab,Db=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(l.fn.init=function(a,c,d){var b,g;if(!a)return this;if(d=d||ab,"string"==typeof a){if(b="<"===a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:Db.exec(a),!b||!b[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(b[1]){if(c=c instanceof l?c[0]:c,l.merge(this,l.parseHTML(b[1],c&&c.nodeType?c.ownerDocument||c:V,!0)),$a.test(b[1])&&l.isPlainObject(c))for(b in c)l.isFunction(this[b])?
this[b](c[b]):this.attr(b,c[b]);return this}return g=V.getElementById(b[2]),g&&(this[0]=g,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):l.isFunction(a)?void 0!==d.ready?d.ready(a):a(l):l.makeArray(a,this)}).prototype=l.fn;ab=l(V);var Eb=/^(?:parents|prev(?:Until|All))/,Fb={children:!0,contents:!0,next:!0,prev:!0};l.fn.extend({has:function(a){var c=l(a,this),d=c.length;return this.filter(function(){for(var a=0;a<d;a++)if(l.contains(this,c[a]))return!0})},closest:function(a,c){var d,
b=0,g=this.length,e=[],f="string"!=typeof a&&l(a);if(!Za.test(a))for(;b<g;b++)for(d=this[b];d&&d!==c;d=d.parentNode)if(11>d.nodeType&&(f?-1<f.index(d):1===d.nodeType&&l.find.matchesSelector(d,a))){e.push(d);break}return this.pushStack(1<e.length?l.uniqueSort(e):e)},index:function(a){return a?"string"==typeof a?wa.call(l(a),this[0]):wa.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,c){return this.pushStack(l.uniqueSort(l.merge(this.get(),l(a,
c))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});l.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return sa(a,"parentNode")},parentsUntil:function(a,c,d){return sa(a,"parentNode",d)},next:function(a){return d(a,"nextSibling")},prev:function(a){return d(a,"previousSibling")},nextAll:function(a){return sa(a,"nextSibling")},prevAll:function(a){return sa(a,"previousSibling")},nextUntil:function(a,c,d){return sa(a,
"nextSibling",d)},prevUntil:function(a,c,d){return sa(a,"previousSibling",d)},siblings:function(a){return Ya((a.parentNode||{}).firstChild,a)},children:function(a){return Ya(a.firstChild)},contents:function(a){return a.contentDocument||l.merge([],a.childNodes)}},function(a,c){l.fn[a]=function(d,b){var g=l.map(this,c,d);return"Until"!==a.slice(-5)&&(b=d),b&&"string"==typeof b&&(g=l.filter(b,g)),1<this.length&&(Fb[a]||l.uniqueSort(g),Eb.test(a)&&g.reverse()),this.pushStack(g)}});var ca=/\S+/g;l.Callbacks=
function(c){c="string"==typeof c?a(c):l.extend({},c);var d,b,g,e,f=[],m=[],k=-1,h=function(){e=c.once;for(g=d=!0;m.length;k=-1)for(b=m.shift();++k<f.length;)!1===f[k].apply(b[0],b[1])&&c.stopOnFalse&&(k=f.length,b=!1);c.memory||(b=!1);d=!1;e&&(f=b?[]:"")},p={add:function(){return f&&(b&&!d&&(k=f.length-1,m.push(b)),function rb(a){l.each(a,function(a,d){l.isFunction(d)?c.unique&&p.has(d)||f.push(d):d&&d.length&&"string"!==l.type(d)&&rb(d)})}(arguments),b&&!d&&h()),this},remove:function(){return l.each(arguments,
function(a,c){for(var d;-1<(d=l.inArray(c,f,d));)f.splice(d,1),d<=k&&k--}),this},has:function(a){return a?-1<l.inArray(a,f):0<f.length},empty:function(){return f&&(f=[]),this},disable:function(){return e=m=[],f=b="",this},disabled:function(){return!f},lock:function(){return e=m=[],b||d||(f=b=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],m.push(c),d||h()),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!g}};
return p};l.extend({Deferred:function(a){var d=[["notify","progress",l.Callbacks("memory"),l.Callbacks("memory"),2],["resolve","done",l.Callbacks("once memory"),l.Callbacks("once memory"),0,"resolved"],["reject","fail",l.Callbacks("once memory"),l.Callbacks("once memory"),1,"rejected"]],b="pending",g={state:function(){return b},always:function(){return e.done(arguments).fail(arguments),this},"catch":function(a){return g.then(null,a)},pipe:function(){var a=arguments;return l.Deferred(function(c){l.each(d,
function(d,b){var g=l.isFunction(a[b[4]])&&a[b[4]];e[b[1]](function(){var a=g&&g.apply(this,arguments);a&&l.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[b[0]+"With"](this,g?[a]:arguments)})});a=null}).promise()},then:function(a,b,g){function e(a,d,b,g){return function(){var k=this,p=arguments,F=function(){var h,F;if(!(a<f)){if(h=b.apply(k,p),h===d.promise())throw new TypeError("Thenable self-resolution");F=h&&("object"==typeof h||"function"==typeof h)&&h.then;
l.isFunction(F)?g?F.call(h,e(f,d,c,g),e(f,d,m,g)):(f++,F.call(h,e(f,d,c,g),e(f,d,m,g),e(f,d,c,d.notifyWith))):(b!==c&&(k=void 0,p=[h]),(g||d.resolveWith)(k,p))}},r=g?F:function(){try{F()}catch(Xa){l.Deferred.exceptionHook&&l.Deferred.exceptionHook(Xa,r.stackTrace),a+1>=f&&(b!==m&&(k=void 0,p=[Xa]),d.rejectWith(k,p))}};a?r():(l.Deferred.getStackHook&&(r.stackTrace=l.Deferred.getStackHook()),h.setTimeout(r))}}var f=0;return l.Deferred(function(f){d[0][3].add(e(0,f,l.isFunction(g)?g:c,f.notifyWith));
d[1][3].add(e(0,f,l.isFunction(a)?a:c));d[2][3].add(e(0,f,l.isFunction(b)?b:m))}).promise()},promise:function(a){return null!=a?l.extend(a,g):g}},e={};return l.each(d,function(a,c){var f=c[2],m=c[5];g[c[1]]=f.add;m&&f.add(function(){b=m},d[3-a][2].disable,d[0][2].lock);f.add(c[3].fire);e[c[0]]=function(){return e[c[0]+"With"](this===e?void 0:this,arguments),this};e[c[0]+"With"]=f.fireWith}),g.promise(e),a&&a.call(e,e),e},when:function(a){var c=arguments.length,d=c,b=Array(d),g=oa.call(arguments),
e=l.Deferred(),f=function(a){return function(d){b[a]=this;g[a]=1<arguments.length?oa.call(arguments):d;--c||e.resolveWith(b,g)}};if(1>=c&&(k(a,e.done(f(d)).resolve,e.reject),"pending"===e.state()||l.isFunction(g[d]&&g[d].then)))return e.then();for(;d--;)k(g[d],f(d),e.reject);return e.promise()}});var Gb=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;l.Deferred.exceptionHook=function(a,c){h.console&&h.console.warn&&a&&Gb.test(a.name)&&h.console.warn("jQuery.Deferred exception: "+a.message,
a.stack,c)};l.readyException=function(a){h.setTimeout(function(){throw a;})};var Ja=l.Deferred();l.fn.ready=function(a){return Ja.then(a)["catch"](function(a){l.readyException(a)}),this};l.extend({isReady:!1,readyWait:1,holdReady:function(a){a?l.readyWait++:l.ready(!0)},ready:function(a){(!0===a?--l.readyWait:l.isReady)||(l.isReady=!0,!0!==a&&0<--l.readyWait||Ja.resolveWith(V,[l]))}});l.ready.then=Ja.then;"complete"===V.readyState||"loading"!==V.readyState&&!V.documentElement.doScroll?h.setTimeout(l.ready):
(V.addEventListener("DOMContentLoaded",p),h.addEventListener("load",p));var ka=function(a,c,d,b,g,e,f){var m=0,k=a.length,h=null==d;if("object"===l.type(d))for(m in g=!0,d)ka(a,c,m,d[m],!0,e,f);else if(void 0!==b&&(g=!0,l.isFunction(b)||(f=!0),h&&(f?(c.call(a,b),c=null):(h=c,c=function(a,c,d){return h.call(l(a),d)})),c))for(;m<k;m++)c(a[m],d,f?b:b.call(a[m],m,c(a[m],d)));return g?a:h?c.call(a):k?c(a[0],d):e},Da=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};q.uid=1;q.prototype={cache:function(a){var c=
a[this.expando];return c||(c={},Da(a)&&(a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,configurable:!0}))),c},set:function(a,c,d){var b;a=this.cache(a);if("string"==typeof c)a[l.camelCase(c)]=d;else for(b in c)a[l.camelCase(b)]=c[b];return a},get:function(a,c){return void 0===c?this.cache(a):a[this.expando]&&a[this.expando][l.camelCase(c)]},access:function(a,c,d){return void 0===c||c&&"string"==typeof c&&void 0===d?this.get(a,c):(this.set(a,c,d),void 0!==d?d:c)},remove:function(a,
c){var d,b=a[this.expando];if(void 0!==b){if(void 0!==c)for(l.isArray(c)?c=c.map(l.camelCase):(c=l.camelCase(c),c=c in b?[c]:c.match(ca)||[]),d=c.length;d--;)delete b[c[d]];(void 0===c||l.isEmptyObject(b))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){a=a[this.expando];return void 0!==a&&!l.isEmptyObject(a)}};var Q=new q,aa=new q,pb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ob=/[A-Z]/g;l.extend({hasData:function(a){return aa.hasData(a)||Q.hasData(a)},data:function(a,c,d){return aa.access(a,
c,d)},removeData:function(a,c){aa.remove(a,c)},_data:function(a,c,d){return Q.access(a,c,d)},_removeData:function(a,c){Q.remove(a,c)}});l.fn.extend({data:function(a,c){var d,b,g,e=this[0],f=e&&e.attributes;if(void 0===a){if(this.length&&(g=aa.get(e),1===e.nodeType&&!Q.get(e,"hasDataAttrs"))){for(d=f.length;d--;)f[d]&&(b=f[d].name,0===b.indexOf("data-")&&(b=l.camelCase(b.slice(5)),n(e,b,g[b])));Q.set(e,"hasDataAttrs",!0)}return g}return"object"==typeof a?this.each(function(){aa.set(this,a)}):ka(this,
function(c){var d;if(e&&void 0===c){if((d=aa.get(e,a),void 0!==d)||(d=n(e,a),void 0!==d))return d}else this.each(function(){aa.set(this,a,c)})},null,c,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){aa.remove(this,a)})}});l.extend({queue:function(a,c,d){var b;if(a)return c=(c||"fx")+"queue",b=Q.get(a,c),d&&(!b||l.isArray(d)?b=Q.access(a,c,l.makeArray(d)):b.push(d)),b||[]},dequeue:function(a,c){c=c||"fx";var d=l.queue(a,c),b=d.length,g=d.shift(),e=l._queueHooks(a,c),
f=function(){l.dequeue(a,c)};"inprogress"===g&&(g=d.shift(),b--);g&&("fx"===c&&d.unshift("inprogress"),delete e.stop,g.call(a,f,e));!b&&e&&e.empty.fire()},_queueHooks:function(a,c){var d=c+"queueHooks";return Q.get(a,d)||Q.access(a,d,{empty:l.Callbacks("once memory").add(function(){Q.remove(a,[c+"queue",d])})})}});l.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?l.queue(this[0],a):void 0===c?this:this.each(function(){var d=l.queue(this,a,c);l._queueHooks(this,
a);"fx"===a&&"inprogress"!==d[0]&&l.dequeue(this,a)})},dequeue:function(a){return this.each(function(){l.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,b=1,g=l.Deferred(),e=this,f=this.length,m=function(){--b||g.resolveWith(e,[e])};"string"!=typeof a&&(c=a,a=void 0);for(a=a||"fx";f--;)(d=Q.get(e[f],a+"queueHooks"))&&d.empty&&(b++,d.empty.add(m));return m(),g.promise(c)}});var bb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ma=new RegExp("^(?:([+-])=|)("+
bb+")([a-z%]*)$","i"),na=["Top","Right","Bottom","Left"],ya=function(a,c){return a=c||a,"none"===a.style.display||""===a.style.display&&l.contains(a.ownerDocument,a)&&"none"===l.css(a,"display")},cb=function(a,c,d,b){var g,e={};for(g in c)e[g]=a.style[g],a.style[g]=c[g];d=d.apply(a,b||[]);for(g in c)a.style[g]=e[g];return d},Pa={};l.fn.extend({show:function(){return r(this,!0)},hide:function(){return r(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ya(this)?
l(this).show():l(this).hide()})}});var db=/^(?:checkbox|radio)$/i,Qa=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ra=/^$|\/(?:java|ecma)script/i,ea={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=ea.td;var sb=/<|&#?\w+;/;!function(){var a=
V.createDocumentFragment().appendChild(V.createElement("div")),c=V.createElement("input");c.setAttribute("type","radio");c.setAttribute("checked","checked");c.setAttribute("name","t");a.appendChild(c);W.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="<textarea>x</textarea>";W.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue}();var Ea=V.documentElement,Hb=/^key/,Ib=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,eb=/^([^.]*)(?:\.(.+)|)/;l.event={global:{},add:function(a,
c,d,b,g){var e,f,m,k,h,p,r,q,n,F;if(h=Q.get(a))for(d.handler&&(e=d,d=e.handler,g=e.selector),g&&l.find.matchesSelector(Ea,g),d.guid||(d.guid=l.guid++),(k=h.events)||(k=h.events={}),(f=h.handle)||(f=h.handle=function(c){return"undefined"!=typeof l&&l.event.triggered!==c.type?l.event.dispatch.apply(a,arguments):void 0}),c=(c||"").match(ca)||[""],h=c.length;h--;)m=eb.exec(c[h])||[],n=F=m[1],m=(m[2]||"").split(".").sort(),n&&(r=l.event.special[n]||{},n=(g?r.delegateType:r.bindType)||n,r=l.event.special[n]||
{},p=l.extend({type:n,origType:F,data:b,handler:d,guid:d.guid,selector:g,needsContext:g&&l.expr.match.needsContext.test(g),namespace:m.join(".")},e),(q=k[n])||(q=k[n]=[],q.delegateCount=0,r.setup&&!1!==r.setup.call(a,b,m,f)||a.addEventListener&&a.addEventListener(n,f)),r.add&&(r.add.call(a,p),p.handler.guid||(p.handler.guid=d.guid)),g?q.splice(q.delegateCount++,0,p):q.push(p),l.event.global[n]=!0)},remove:function(a,c,d,b,g){var e,f,m,k,h,p,r,q,n,F,u,A=Q.hasData(a)&&Q.get(a);if(A&&(k=A.events)){c=
(c||"").match(ca)||[""];for(h=c.length;h--;)if(m=eb.exec(c[h])||[],n=u=m[1],F=(m[2]||"").split(".").sort(),n){r=l.event.special[n]||{};n=(b?r.delegateType:r.bindType)||n;q=k[n]||[];m=m[2]&&new RegExp("(^|\\.)"+F.join("\\.(?:.*\\.|)")+"(\\.|$)");for(f=e=q.length;e--;)p=q[e],!g&&u!==p.origType||d&&d.guid!==p.guid||m&&!m.test(p.namespace)||b&&b!==p.selector&&("**"!==b||!p.selector)||(q.splice(e,1),p.selector&&q.delegateCount--,r.remove&&r.remove.call(a,p));f&&!q.length&&(r.teardown&&!1!==r.teardown.call(a,
F,A.handle)||l.removeEvent(a,n,A.handle),delete k[n])}else for(n in k)l.event.remove(a,n+c[h],d,b,!0);l.isEmptyObject(k)&&Q.remove(a,"handle events")}},dispatch:function(a){var c=l.event.fix(a),d,b,g,e,f,m,k=Array(arguments.length);b=(Q.get(this,"events")||{})[c.type]||[];var h=l.event.special[c.type]||{};k[0]=c;for(d=1;d<arguments.length;d++)k[d]=arguments[d];if(c.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,c)){m=l.event.handlers.call(this,c,b);for(d=0;(e=m[d++])&&!c.isPropagationStopped();)for(c.currentTarget=
e.elem,b=0;(f=e.handlers[b++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!c.rnamespace.test(f.namespace)||(c.handleObj=f,c.data=f.data,g=((l.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,k),void 0!==g&&!1===(c.result=g)&&(c.preventDefault(),c.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,c),c.result}},handlers:function(a,c){var d,b,g,e,f=[],m=c.delegateCount,k=a.target;if(m&&k.nodeType&&("click"!==a.type||isNaN(a.button)||1>a.button))for(;k!==this;k=
k.parentNode||this)if(1===k.nodeType&&(!0!==k.disabled||"click"!==a.type)){b=[];for(d=0;d<m;d++)e=c[d],g=e.selector+" ",void 0===b[g]&&(b[g]=e.needsContext?-1<l(g,this).index(k):l.find(g,this,null,[k]).length),b[g]&&b.push(e);b.length&&f.push({elem:k,handlers:b})}return m<c.length&&f.push({elem:this,handlers:c.slice(m)}),f},addProp:function(a,c){Object.defineProperty(l.Event.prototype,a,{enumerable:!0,configurable:!0,get:l.isFunction(c)?function(){if(this.originalEvent)return c(this.originalEvent)}:
function(){if(this.originalEvent)return this.originalEvent[a]},set:function(c){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:c})}})},fix:function(a){return a[l.expando]?a:new l.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==z()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===z()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&
l.nodeName(this,"input"))return this.click(),!1},_default:function(a){return l.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}};l.removeEvent=function(a,c,d){a.removeEventListener&&a.removeEventListener(c,d)};l.Event=function(a,c){return this instanceof l.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?v:x,
this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,c&&l.extend(this,c),this.timeStamp=a&&a.timeStamp||l.now(),void(this[l.expando]=!0)):new l.Event(a,c)};l.Event.prototype={constructor:l.Event,isDefaultPrevented:x,isPropagationStopped:x,isImmediatePropagationStopped:x,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=v;a&&!this.isSimulated&&a.preventDefault()},
stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=v;a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=v;a&&!this.isSimulated&&a.stopImmediatePropagation();this.stopPropagation()}};l.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,
clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var c=a.button;return null==a.which&&Hb.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==c&&Ib.test(a.type)?1&c?1:2&c?3:4&c?2:0:a.which}},l.event.addProp);l.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,c){l.event.special[a]={delegateType:c,bindType:c,handle:function(a){var d,
b=a.relatedTarget,g=a.handleObj;return b&&(b===this||l.contains(this,b))||(a.type=g.origType,d=g.handler.apply(this,arguments),a.type=c),d}}});l.fn.extend({on:function(a,c,d,b){return w(this,a,c,d,b)},one:function(a,c,d,b){return w(this,a,c,d,b,1)},off:function(a,c,d){var b,g;if(a&&a.preventDefault&&a.handleObj)return b=a.handleObj,l(a.delegateTarget).off(b.namespace?b.origType+"."+b.namespace:b.origType,b.selector,b.handler),this;if("object"==typeof a){for(g in a)this.off(g,c,a[g]);return this}return!1!==
c&&"function"!=typeof c||(d=c,c=void 0),!1===d&&(d=x),this.each(function(){l.event.remove(this,a,d,c)})}});var Jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Kb=/<script|<style|<link/i,ub=/checked\s*(?:[^=]|=\s*.checked.)/i,tb=/^true\/(.*)/,vb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;l.extend({htmlPrefilter:function(a){return a.replace(Jb,"<$1></$2>")},clone:function(a,c,d){var b,g,e,f,m=a.cloneNode(!0),k=l.contains(a.ownerDocument,a);if(!(W.noCloneChecked||
1!==a.nodeType&&11!==a.nodeType||l.isXMLDoc(a)))for(f=u(m),e=u(a),b=0,g=e.length;b<g;b++){var h=e[b],p=f[b],r=p.nodeName.toLowerCase();"input"===r&&db.test(h.type)?p.checked=h.checked:"input"!==r&&"textarea"!==r||(p.defaultValue=h.defaultValue)}if(c)if(d)for(e=e||u(a),f=f||u(m),b=0,g=e.length;b<g;b++)I(e[b],f[b]);else I(a,m);return f=u(m,"script"),0<f.length&&A(f,!k&&u(a,"script")),m},cleanData:function(a){for(var c,d,b,g=l.event.special,e=0;void 0!==(d=a[e]);e++)if(Da(d)){if(c=d[Q.expando]){if(c.events)for(b in c.events)g[b]?
l.event.remove(d,b):l.removeEvent(d,b,c.handle);d[Q.expando]=void 0}d[aa.expando]&&(d[aa.expando]=void 0)}}});l.fn.extend({detach:function(a){return D(this,a,!0)},remove:function(a){return D(this,a)},text:function(a){return ka(this,function(a){return void 0===a?l.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return J(this,arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&
9!==this.nodeType||B(this,a).appendChild(a)})},prepend:function(){return J(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var c=B(this,a);c.insertBefore(a,c.firstChild)}})},before:function(){return J(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return J(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,c=0;null!=(a=this[c]);c++)1===
a.nodeType&&(l.cleanData(u(a,!1)),a.textContent="");return this},clone:function(a,c){return a=null!=a&&a,c=null==c?a:c,this.map(function(){return l.clone(this,a,c)})},html:function(a){return ka(this,function(a){var c=this[0]||{},d=0,b=this.length;if(void 0===a&&1===c.nodeType)return c.innerHTML;if("string"==typeof a&&!Kb.test(a)&&!ea[(Qa.exec(a)||["",""])[1].toLowerCase()]){a=l.htmlPrefilter(a);try{for(;d<b;d++)c=this[d]||{},1===c.nodeType&&(l.cleanData(u(c,!1)),c.innerHTML=a);c=0}catch(ec){}}c&&
this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return J(this,arguments,function(c){var d=this.parentNode;0>l.inArray(this,a)&&(l.cleanData(u(this)),d&&d.replaceChild(c,this))},a)}});l.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,c){l.fn[a]=function(a){for(var d=[],b=l(a),g=b.length-1,e=0;e<=g;e++)a=e===g?this:this.clone(!0),l(b[e])[c](a),xa.apply(d,a.get());return this.pushStack(d)}});
var Sa=/^margin/,Fa=new RegExp("^("+bb+")(?!px)[a-z%]+$","i"),Aa=function(a){var c=a.ownerDocument.defaultView;return c&&c.opener||(c=h),c.getComputedStyle(a)};!function(){function a(){if(f){f.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";f.innerHTML="";Ea.appendChild(e);var a=h.getComputedStyle(f);c="1%"!==a.top;g="2px"===a.marginLeft;d="4px"===a.width;f.style.marginRight="50%";b="4px"===a.marginRight;Ea.removeChild(e);f=
null}}var c,d,b,g,e=V.createElement("div"),f=V.createElement("div");f.style&&(f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",W.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",e.appendChild(f),l.extend(W,{pixelPosition:function(){return a(),c},boxSizingReliable:function(){return a(),d},pixelMarginRight:function(){return a(),b},reliableMarginLeft:function(){return a(),
g}}))}();var Lb=/^(none|table(?!-c[ea]).+)/,Mb={position:"absolute",visibility:"hidden",display:"block"},fb={letterSpacing:"0",fontWeight:"400"},Ua=["Webkit","Moz","ms"],Ta=V.createElement("div").style;l.extend({cssHooks:{opacity:{get:function(a,c){if(c){var d=N(a,"opacity");return""===d?"1":d}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},
style:function(a,c,d,b){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var g,e,f,m=l.camelCase(c),k=a.style;return c=l.cssProps[m]||(l.cssProps[m]=G(m)||m),f=l.cssHooks[c]||l.cssHooks[m],void 0===d?f&&"get"in f&&void 0!==(g=f.get(a,!1,b))?g:k[c]:(e=typeof d,"string"===e&&(g=ma.exec(d))&&g[1]&&(d=t(a,c,g),e="number"),null!=d&&d===d&&("number"===e&&(d+=g&&g[3]||(l.cssNumber[m]?"":"px")),W.clearCloneStyle||""!==d||0!==c.indexOf("background")||(k[c]="inherit"),f&&"set"in f&&void 0===(d=f.set(a,d,b))||
(k[c]=d)),void 0)}},css:function(a,c,d,b){var g,e,f,m=l.camelCase(c);return c=l.cssProps[m]||(l.cssProps[m]=G(m)||m),f=l.cssHooks[c]||l.cssHooks[m],f&&"get"in f&&(g=f.get(a,!0,d)),void 0===g&&(g=N(a,c,b)),"normal"===g&&c in fb&&(g=fb[c]),""===d||d?(e=parseFloat(g),!0===d||isFinite(e)?e||0:g):g}});l.each(["height","width"],function(a,c){l.cssHooks[c]={get:function(a,d,b){if(d)return!Lb.test(l.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?P(a,c,b):cb(a,Mb,function(){return P(a,
c,b)})},set:function(a,d,b){var g,e=b&&Aa(a);b=b&&M(a,c,b,"border-box"===l.css(a,"boxSizing",!1,e),e);return b&&(g=ma.exec(d))&&"px"!==(g[3]||"px")&&(a.style[c]=d,d=l.css(a,c)),L(a,d,b)}}});l.cssHooks.marginLeft=O(W.reliableMarginLeft,function(a,c){if(c)return(parseFloat(N(a,"marginLeft"))||a.getBoundingClientRect().left-cb(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"});l.each({margin:"",padding:"",border:"Width"},function(a,c){l.cssHooks[a+c]={expand:function(d){var b=
0,g={};for(d="string"==typeof d?d.split(" "):[d];4>b;b++)g[a+na[b]+c]=d[b]||d[b-2]||d[0];return g}};Sa.test(a)||(l.cssHooks[a+c].set=L)});l.fn.extend({css:function(a,c){return ka(this,function(a,c,d){var b,g={},e=0;if(l.isArray(c)){d=Aa(a);for(b=c.length;e<b;e++)g[c[e]]=l.css(a,c[e],!1,d);return g}return void 0!==d?l.style(a,c,d):l.css(a,c)},a,c,1<arguments.length)}});l.Tween=R;R.prototype={constructor:R,init:function(a,c,d,b,g,e){this.elem=a;this.prop=d;this.easing=g||l.easing._default;this.options=
c;this.start=this.now=this.cur();this.end=b;this.unit=e||(l.cssNumber[d]?"":"px")},cur:function(){var a=R.propHooks[this.prop];return a&&a.get?a.get(this):R.propHooks._default.get(this)},run:function(a){var c,d=R.propHooks[this.prop];return this.options.duration?this.pos=c=l.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=c=a,this.now=(this.end-this.start)*c+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):R.propHooks._default.set(this),
this}};R.prototype.init.prototype=R.prototype;R.propHooks={_default:{get:function(a){var c;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(c=l.css(a.elem,a.prop,""),c&&"auto"!==c?c:0)},set:function(a){l.fx.step[a.prop]?l.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[l.cssProps[a.prop]]&&!l.cssHooks[a.prop]?a.elem[a.prop]=a.now:l.style(a.elem,a.prop,a.now+a.unit)}}};R.propHooks.scrollTop=R.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&
a.elem.parentNode&&(a.elem[a.prop]=a.now)}};l.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"};l.fx=R.prototype.init;l.fx.step={};var ia,ra,Nb=/^(?:toggle|show|hide)$/,Ob=/queueHooks$/;l.Animation=l.extend(X,{tweeners:{"*":[function(a,c){var d=this.createTween(a,c);return t(d.elem,a,ma.exec(c),d),d}]},tweener:function(a,c){l.isFunction(a)?(c=a,a=["*"]):a=a.match(ca);for(var d,b=0,g=a.length;b<g;b++)d=a[b],X.tweeners[d]=X.tweeners[d]||[],X.tweeners[d].unshift(c)},
prefilters:[function(a,c,d){var b,g,e,f,m,k,h,p,q="width"in c||"height"in c,n=this,u={},A=a.style,t=a.nodeType&&ya(a),y=Q.get(a,"fxshow");d.queue||(f=l._queueHooks(a,"fx"),null==f.unqueued&&(f.unqueued=0,m=f.empty.fire,f.empty.fire=function(){f.unqueued||m()}),f.unqueued++,n.always(function(){n.always(function(){f.unqueued--;l.queue(a,"fx").length||f.empty.fire()})}));for(b in c)if(g=c[b],Nb.test(g)){if(delete c[b],e=e||"toggle"===g,g===(t?"hide":"show")){if("show"!==g||!y||void 0===y[b])continue;
t=!0}u[b]=y&&y[b]||l.style(a,b)}if(k=!l.isEmptyObject(c),k||!l.isEmptyObject(u))for(b in q&&1===a.nodeType&&(d.overflow=[A.overflow,A.overflowX,A.overflowY],h=y&&y.display,null==h&&(h=Q.get(a,"display")),p=l.css(a,"display"),"none"===p&&(h?p=h:(r([a],!0),h=a.style.display||h,p=l.css(a,"display"),r([a]))),("inline"===p||"inline-block"===p&&null!=h)&&"none"===l.css(a,"float")&&(k||(n.done(function(){A.display=h}),null==h&&(p=A.display,h="none"===p?"":p)),A.display="inline-block")),d.overflow&&(A.overflow=
"hidden",n.always(function(){A.overflow=d.overflow[0];A.overflowX=d.overflow[1];A.overflowY=d.overflow[2]})),k=!1,u)k||(y?"hidden"in y&&(t=y.hidden):y=Q.access(a,"fxshow",{display:h}),e&&(y.hidden=!t),t&&r([a],!0),n.done(function(){t||r([a]);Q.remove(a,"fxshow");for(b in u)l.style(a,b,u[b])})),k=ba(t?y[b]:0,b,n),b in y||(y[b]=k.start,t&&(k.end=k.start,k.start=0))}],prefilter:function(a,c){c?X.prefilters.unshift(a):X.prefilters.push(a)}});l.speed=function(a,c,d){var b=a&&"object"==typeof a?l.extend({},
a):{complete:d||!d&&c||l.isFunction(a)&&a,duration:a,easing:d&&c||c&&!l.isFunction(c)&&c};return l.fx.off||V.hidden?b.duration=0:b.duration="number"==typeof b.duration?b.duration:b.duration in l.fx.speeds?l.fx.speeds[b.duration]:l.fx.speeds._default,null!=b.queue&&!0!==b.queue||(b.queue="fx"),b.old=b.complete,b.complete=function(){l.isFunction(b.old)&&b.old.call(this);b.queue&&l.dequeue(this,b.queue)},b};l.fn.extend({fadeTo:function(a,c,d,b){return this.filter(ya).css("opacity",0).show().end().animate({opacity:c},
a,d,b)},animate:function(a,c,d,b){var g=l.isEmptyObject(a),e=l.speed(c,d,b);c=function(){var c=X(this,l.extend({},a),e);(g||Q.get(this,"finish"))&&c.stop(!0)};return c.finish=c,g||!1===e.queue?this.each(c):this.queue(e.queue,c)},stop:function(a,c,d){var b=function(a){var c=a.stop;delete a.stop;c(d)};return"string"!=typeof a&&(d=c,c=a,a=void 0),c&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var c=!0,g=null!=a&&a+"queueHooks",e=l.timers,f=Q.get(this);if(g)f[g]&&f[g].stop&&b(f[g]);else for(g in f)f[g]&&
f[g].stop&&Ob.test(g)&&b(f[g]);for(g=e.length;g--;)e[g].elem!==this||null!=a&&e[g].queue!==a||(e[g].anim.stop(d),c=!1,e.splice(g,1));!c&&d||l.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var c,d=Q.get(this),b=d[a+"queue"];c=d[a+"queueHooks"];var g=l.timers,e=b?b.length:0;d.finish=!0;l.queue(this,a,[]);c&&c.stop&&c.stop.call(this,!0);for(c=g.length;c--;)g[c].elem===this&&g[c].queue===a&&(g[c].anim.stop(!0),g.splice(c,1));for(c=0;c<e;c++)b[c]&&b[c].finish&&b[c].finish.call(this);
delete d.finish})}});l.each(["toggle","show","hide"],function(a,c){var d=l.fn[c];l.fn[c]=function(a,b,g){return null==a||"boolean"==typeof a?d.apply(this,arguments):this.animate(Z(c,!0),a,b,g)}});l.each({slideDown:Z("show"),slideUp:Z("hide"),slideToggle:Z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,c){l.fn[a]=function(a,d,b){return this.animate(c,a,d,b)}});l.timers=[];l.fx.tick=function(){var a,c=0,d=l.timers;for(ia=l.now();c<d.length;c++)a=
d[c],a()||d[c]!==a||d.splice(c--,1);d.length||l.fx.stop();ia=void 0};l.fx.timer=function(a){l.timers.push(a);a()?l.fx.start():l.timers.pop()};l.fx.interval=13;l.fx.start=function(){ra||(ra=h.requestAnimationFrame?h.requestAnimationFrame(S):h.setInterval(l.fx.tick,l.fx.interval))};l.fx.stop=function(){h.cancelAnimationFrame?h.cancelAnimationFrame(ra):h.clearInterval(ra);ra=null};l.fx.speeds={slow:600,fast:200,_default:400};l.fn.delay=function(a,c){return a=l.fx?l.fx.speeds[a]||a:a,c=c||"fx",this.queue(c,
function(c,d){var b=h.setTimeout(c,a);d.stop=function(){h.clearTimeout(b)}})};(function(){var a=V.createElement("input"),c=V.createElement("select").appendChild(V.createElement("option"));a.type="checkbox";W.checkOn=""!==a.value;W.optSelected=c.selected;a=V.createElement("input");a.value="t";a.type="radio";W.radioValue="t"===a.value})();var gb,ta=l.expr.attrHandle;l.fn.extend({attr:function(a,c){return ka(this,l.attr,a,c,1<arguments.length)},removeAttr:function(a){return this.each(function(){l.removeAttr(this,
a)})}});l.extend({attr:function(a,c,d){var b,g,e=a.nodeType;if(3!==e&&8!==e&&2!==e)return"undefined"==typeof a.getAttribute?l.prop(a,c,d):(1===e&&l.isXMLDoc(a)||(g=l.attrHooks[c.toLowerCase()]||(l.expr.match.bool.test(c)?gb:void 0)),void 0!==d?null===d?void l.removeAttr(a,c):g&&"set"in g&&void 0!==(b=g.set(a,d,c))?b:(a.setAttribute(c,d+""),d):g&&"get"in g&&null!==(b=g.get(a,c))?b:(b=l.find.attr(a,c),null==b?void 0:b))},attrHooks:{type:{set:function(a,c){if(!W.radioValue&&"radio"===c&&l.nodeName(a,
"input")){var d=a.value;return a.setAttribute("type",c),d&&(a.value=d),c}}}},removeAttr:function(a,c){var d,b=0,g=c&&c.match(ca);if(g&&1===a.nodeType)for(;d=g[b++];)a.removeAttribute(d)}});gb={set:function(a,c,d){return!1===c?l.removeAttr(a,d):a.setAttribute(d,d),d}};l.each(l.expr.match.bool.source.match(/\w+/g),function(a,c){var d=ta[c]||l.find.attr;ta[c]=function(a,c,b){var g,e,f=c.toLowerCase();return b||(e=ta[f],ta[f]=g,g=null!=d(a,c,b)?f:null,ta[f]=e),g}});var Pb=/^(?:input|select|textarea|button)$/i,
Qb=/^(?:a|area)$/i;l.fn.extend({prop:function(a,c){return ka(this,l.prop,a,c,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[l.propFix[a]||a]})}});l.extend({prop:function(a,c,d){var b,g,e=a.nodeType;if(3!==e&&8!==e&&2!==e)return 1===e&&l.isXMLDoc(a)||(c=l.propFix[c]||c,g=l.propHooks[c]),void 0!==d?g&&"set"in g&&void 0!==(b=g.set(a,d,c))?b:a[c]=d:g&&"get"in g&&null!==(b=g.get(a,c))?b:a[c]},propHooks:{tabIndex:{get:function(a){var c=l.find.attr(a,"tabindex");return c?
parseInt(c,10):Pb.test(a.nodeName)||Qb.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});W.optSelected||(l.propHooks.selected={get:function(a){a=a.parentNode;return a&&a.parentNode&&a.parentNode.selectedIndex,null},set:function(a){a=a.parentNode;a&&(a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex)}});l.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){l.propFix[this.toLowerCase()]=
this});var Ka=/[\t\r\n\f]/g;l.fn.extend({addClass:function(a){var c,d,b,g,e,f,m=0;if(l.isFunction(a))return this.each(function(c){l(this).addClass(a.call(this,c,Y(this)))});if("string"==typeof a&&a)for(c=a.match(ca)||[];d=this[m++];)if(g=Y(d),b=1===d.nodeType&&(" "+g+" ").replace(Ka," ")){for(f=0;e=c[f++];)0>b.indexOf(" "+e+" ")&&(b+=e+" ");b=l.trim(b);g!==b&&d.setAttribute("class",b)}return this},removeClass:function(a){var c,d,b,g,e,f,m=0;if(l.isFunction(a))return this.each(function(c){l(this).removeClass(a.call(this,
c,Y(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(c=a.match(ca)||[];d=this[m++];)if(g=Y(d),b=1===d.nodeType&&(" "+g+" ").replace(Ka," ")){for(f=0;e=c[f++];)for(;-1<b.indexOf(" "+e+" ");)b=b.replace(" "+e+" "," ");b=l.trim(b);g!==b&&d.setAttribute("class",b)}return this},toggleClass:function(a,c){var d=typeof a;return"boolean"==typeof c&&"string"===d?c?this.addClass(a):this.removeClass(a):l.isFunction(a)?this.each(function(d){l(this).toggleClass(a.call(this,
d,Y(this),c),c)}):this.each(function(){var c,b,g,e;if("string"===d)for(b=0,g=l(this),e=a.match(ca)||[];c=e[b++];)g.hasClass(c)?g.removeClass(c):g.addClass(c);else void 0!==a&&"boolean"!==d||(c=Y(this),c&&Q.set(this,"__className__",c),this.setAttribute&&this.setAttribute("class",c||!1===a?"":Q.get(this,"__className__")||""))})},hasClass:function(a){var c,d=0;for(a=" "+a+" ";c=this[d++];)if(1===c.nodeType&&-1<(" "+Y(c)+" ").replace(Ka," ").indexOf(a))return!0;return!1}});var Rb=/\r/g,Sb=/[\x20\t\r\n\f]+/g;
l.fn.extend({val:function(a){var c,d,b,g=this[0];if(arguments.length)return b=l.isFunction(a),this.each(function(d){var g;1===this.nodeType&&(g=b?a.call(this,d,l(this).val()):a,null==g?g="":"number"==typeof g?g+="":l.isArray(g)&&(g=l.map(g,function(a){return null==a?"":a+""})),c=l.valHooks[this.type]||l.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&void 0!==c.set(this,g,"value")||(this.value=g))});if(g)return c=l.valHooks[g.type]||l.valHooks[g.nodeName.toLowerCase()],c&&"get"in c&&void 0!==
(d=c.get(g,"value"))?d:(d=g.value,"string"==typeof d?d.replace(Rb,""):null==d?"":d)}});l.extend({valHooks:{option:{get:function(a){var c=l.find.attr(a,"value");return null!=c?c:l.trim(l.text(a)).replace(Sb," ")}},select:{get:function(a){for(var c,d=a.options,b=a.selectedIndex,g="select-one"===a.type,e=g?null:[],f=g?b+1:d.length,m=0>b?f:g?b:0;m<f;m++)if(c=d[m],!(!c.selected&&m!==b||c.disabled||c.parentNode.disabled&&l.nodeName(c.parentNode,"optgroup"))){if(a=l(c).val(),g)return a;e.push(a)}return e},
set:function(a,c){for(var d,b,g=a.options,e=l.makeArray(c),f=g.length;f--;)b=g[f],(b.selected=-1<l.inArray(l.valHooks.option.get(b),e))&&(d=!0);return d||(a.selectedIndex=-1),e}}}});l.each(["radio","checkbox"],function(){l.valHooks[this]={set:function(a,c){if(l.isArray(c))return a.checked=-1<l.inArray(l(a).val(),c)}};W.checkOn||(l.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var hb=/^(?:focusinfocus|focusoutblur)$/;l.extend(l.event,{trigger:function(a,c,d,
b){var g,e,f,m,k,p,r,n=[d||V],q=Ca.call(a,"type")?a.type:a;g=Ca.call(a,"namespace")?a.namespace.split("."):[];if(e=f=d=d||V,3!==d.nodeType&&8!==d.nodeType&&!hb.test(q+l.event.triggered)&&(-1<q.indexOf(".")&&(g=q.split("."),q=g.shift(),g.sort()),k=0>q.indexOf(":")&&"on"+q,a=a[l.expando]?a:new l.Event(q,"object"==typeof a&&a),a.isTrigger=b?2:3,a.namespace=g.join("."),a.rnamespace=a.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,a.target||(a.target=d),c=null==
c?[a]:l.makeArray(c,[a]),r=l.event.special[q]||{},b||!r.trigger||!1!==r.trigger.apply(d,c))){if(!b&&!r.noBubble&&!l.isWindow(d)){m=r.delegateType||q;for(hb.test(m+q)||(e=e.parentNode);e;e=e.parentNode)n.push(e),f=e;f===(d.ownerDocument||V)&&n.push(f.defaultView||f.parentWindow||h)}for(g=0;(e=n[g++])&&!a.isPropagationStopped();)a.type=1<g?m:r.bindType||q,(p=(Q.get(e,"events")||{})[a.type]&&Q.get(e,"handle"))&&p.apply(e,c),(p=k&&e[k])&&p.apply&&Da(e)&&(a.result=p.apply(e,c),!1===a.result&&a.preventDefault());
return a.type=q,b||a.isDefaultPrevented()||r._default&&!1!==r._default.apply(n.pop(),c)||!Da(d)||k&&l.isFunction(d[q])&&!l.isWindow(d)&&(f=d[k],f&&(d[k]=null),l.event.triggered=q,d[q](),l.event.triggered=void 0,f&&(d[k]=f)),a.result}},simulate:function(a,c,d){a=l.extend(new l.Event,d,{type:a,isSimulated:!0});l.event.trigger(a,null,c)}});l.fn.extend({trigger:function(a,c){return this.each(function(){l.event.trigger(a,c,this)})},triggerHandler:function(a,c){var d=this[0];if(d)return l.event.trigger(a,
c,d,!0)}});l.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,c){l.fn[c]=function(a,d){return 0<arguments.length?this.on(c,null,a,d):this.trigger(c)}});l.fn.extend({hover:function(a,c){return this.mouseenter(a).mouseleave(c||a)}});W.focusin="onfocusin"in h;W.focusin||l.each({focus:"focusin",blur:"focusout"},function(a,c){var d=function(a){l.event.simulate(c,
a.target,l.event.fix(a))};l.event.special[c]={setup:function(){var b=this.ownerDocument||this,g=Q.access(b,c);g||b.addEventListener(a,d,!0);Q.access(b,c,(g||0)+1)},teardown:function(){var b=this.ownerDocument||this,g=Q.access(b,c)-1;g?Q.access(b,c,g):(b.removeEventListener(a,d,!0),Q.remove(b,c))}}});var ua=h.location,ib=l.now(),La=/\?/;l.parseXML=function(a){var c;if(!a||"string"!=typeof a)return null;try{c=(new h.DOMParser).parseFromString(a,"text/xml")}catch(dc){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||
l.error("Invalid XML: "+a),c};var wb=/\[\]$/,jb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;l.param=function(a,c){var d,b=[],g=function(a,c){var d=l.isFunction(c)?c():c;b[b.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==d?"":d)};if(l.isArray(a)||a.jquery&&!l.isPlainObject(a))l.each(a,function(){g(this.name,this.value)});else for(d in a)U(d,a[d],c,g);return b.join("&")};l.fn.extend({serialize:function(){return l.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var a=l.prop(this,"elements");return a?l.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!l(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!db.test(a))}).map(function(a,c){var d=l(this).val();return null==d?null:l.isArray(d)?l.map(d,function(a){return{name:c.name,value:a.replace(jb,"\r\n")}}):{name:c.name,value:d.replace(jb,"\r\n")}}).get()}});var Vb=/%20/g,Wb=/#.*$/,Xb=/([?&])_=[^&]*/,Yb=/^(.*?):[ \t]*([^\r\n]*)$/gm,
Zb=/^(?:GET|HEAD)$/,$b=/^\/\//,kb={},Ga={},lb="*/".concat("*"),Ma=V.createElement("a");Ma.href=ua.href;l.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ua.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ua.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":lb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,
html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":l.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,c){return c?ga(ga(a,l.ajaxSettings),c):ga(l.ajaxSettings,a)},ajaxPrefilter:K(kb),ajaxTransport:K(Ga),ajax:function(a,c){function d(a,c,d,f){var k,q,n,w,x=c;if(!p){p=!0;m&&h.clearTimeout(m);b=void 0;e=f||"";B.readyState=0<a?4:0;f=200<=a&&300>a||304===a;
if(d){n=u;for(var R=B,C,N,O,H,S=n.contents,F=n.dataTypes;"*"===F[0];)F.shift(),void 0===C&&(C=n.mimeType||R.getResponseHeader("Content-Type"));if(C)for(N in S)if(S[N]&&S[N].test(C)){F.unshift(N);break}if(F[0]in d)O=F[0];else{for(N in d){if(!F[0]||n.converters[N+" "+F[0]]){O=N;break}H||(H=N)}O=O||H}d=O?(O!==F[0]&&F.unshift(O),d[O]):void 0;n=d}var G;a:{d=u;C=n;N=B;O=f;var E,L,M;n={};R=d.dataTypes.slice();if(R[1])for(E in d.converters)n[E.toLowerCase()]=d.converters[E];for(H=R.shift();H;)if(d.responseFields[H]&&
(N[d.responseFields[H]]=C),!M&&O&&d.dataFilter&&(C=d.dataFilter(C,d.dataType)),M=H,H=R.shift())if("*"===H)H=M;else if("*"!==M&&M!==H){if(E=n[M+" "+H]||n["* "+H],!E)for(G in n)if(L=G.split(" "),L[1]===H&&(E=n[M+" "+L[0]]||n["* "+L[0]])){!0===E?E=n[G]:!0!==n[G]&&(H=L[0],R.unshift(L[1]));break}if(!0!==E)if(E&&d["throws"])C=E(C);else try{C=E(C)}catch(Cb){G={state:"parsererror",error:E?Cb:"No conversion from "+M+" to "+H};break a}}G={state:"success",data:C}}n=G;f?(u.ifModified&&(w=B.getResponseHeader("Last-Modified"),
w&&(l.lastModified[g]=w),w=B.getResponseHeader("etag"),w&&(l.etag[g]=w)),204===a||"HEAD"===u.type?x="nocontent":304===a?x="notmodified":(x=n.state,k=n.data,q=n.error,f=!q)):(q=x,!a&&x||(x="error",0>a&&(a=0)));B.status=a;B.statusText=(c||x)+"";f?y.resolveWith(A,[k,x,B]):y.rejectWith(A,[B,x,q]);B.statusCode(z);z=void 0;r&&t.trigger(f?"ajaxSuccess":"ajaxError",[B,u,f?k:q]);v.fireWith(A,[B,x]);r&&(t.trigger("ajaxComplete",[B,u]),--l.active||l.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=void 0);
c=c||{};var b,g,e,f,m,k,p,r,q,n,u=l.ajaxSetup({},c),A=u.context||u,t=u.context&&(A.nodeType||A.jquery)?l(A):l.event,y=l.Deferred(),v=l.Callbacks("once memory"),z=u.statusCode||{},w={},x={},R="canceled",B={readyState:0,getResponseHeader:function(a){var c;if(p){if(!f)for(f={};c=Yb.exec(e);)f[c[1].toLowerCase()]=c[2];c=f[a.toLowerCase()]}return null==c?null:c},getAllResponseHeaders:function(){return p?e:null},setRequestHeader:function(a,c){return null==p&&(a=x[a.toLowerCase()]=x[a.toLowerCase()]||a,
w[a]=c),this},overrideMimeType:function(a){return null==p&&(u.mimeType=a),this},statusCode:function(a){var c;if(a)if(p)B.always(a[B.status]);else for(c in a)z[c]=[z[c],a[c]];return this},abort:function(a){a=a||R;return b&&b.abort(a),d(0,a),this}};if(y.promise(B),u.url=((a||u.url||ua.href)+"").replace($b,ua.protocol+"//"),u.type=c.method||c.type||u.method||u.type,u.dataTypes=(u.dataType||"*").toLowerCase().match(ca)||[""],null==u.crossDomain){k=V.createElement("a");try{k.href=u.url,k.href=k.href,u.crossDomain=
Ma.protocol+"//"+Ma.host!=k.protocol+"//"+k.host}catch(Ia){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=l.param(u.data,u.traditional)),da(kb,u,c,B),p)return B;(r=l.event&&u.global)&&0===l.active++&&l.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!Zb.test(u.type);g=u.url.replace(Wb,"");u.hasContent?u.data&&u.processData&&0===(u.contentType||"").indexOf("application/x-www-form-urlencoded")&&(u.data=u.data.replace(Vb,"+")):(n=u.url.slice(g.length),
u.data&&(g+=(La.test(g)?"&":"?")+u.data,delete u.data),!1===u.cache&&(g=g.replace(Xb,""),n=(La.test(g)?"&":"?")+"_="+ib++ +n),u.url=g+n);u.ifModified&&(l.lastModified[g]&&B.setRequestHeader("If-Modified-Since",l.lastModified[g]),l.etag[g]&&B.setRequestHeader("If-None-Match",l.etag[g]));(u.data&&u.hasContent&&!1!==u.contentType||c.contentType)&&B.setRequestHeader("Content-Type",u.contentType);B.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?
", "+lb+"; q=0.01":""):u.accepts["*"]);for(q in u.headers)B.setRequestHeader(q,u.headers[q]);if(u.beforeSend&&(!1===u.beforeSend.call(A,B,u)||p))return B.abort();if(R="abort",v.add(u.complete),B.done(u.success),B.fail(u.error),b=da(Ga,u,c,B)){if(B.readyState=1,r&&t.trigger("ajaxSend",[B,u]),p)return B;u.async&&0<u.timeout&&(m=h.setTimeout(function(){B.abort("timeout")},u.timeout));try{p=!1,b.send(w,d)}catch(Ia){if(p)throw Ia;d(-1,Ia)}}else d(-1,"No Transport");return B},getJSON:function(a,c,d){return l.get(a,
c,d,"json")},getScript:function(a,c){return l.get(a,void 0,c,"script")}});l.each(["get","post"],function(a,c){l[c]=function(a,d,b,g){return l.isFunction(d)&&(g=g||b,b=d,d=void 0),l.ajax(l.extend({url:a,type:c,dataType:g,data:d,success:b},l.isPlainObject(a)&&a))}});l._evalUrl=function(a){return l.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})};l.fn.extend({wrapAll:function(a){var c;return this[0]&&(l.isFunction(a)&&(a=a.call(this[0])),c=l(a,this[0].ownerDocument).eq(0).clone(!0),
this[0].parentNode&&c.insertBefore(this[0]),c.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return l.isFunction(a)?this.each(function(c){l(this).wrapInner(a.call(this,c))}):this.each(function(){var c=l(this),d=c.contents();d.length?d.wrapAll(a):c.append(a)})},wrap:function(a){var c=l.isFunction(a);return this.each(function(d){l(this).wrapAll(c?a.call(this,d):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){l(this).replaceWith(this.childNodes)}),
this}});l.expr.pseudos.hidden=function(a){return!l.expr.pseudos.visible(a)};l.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)};l.ajaxSettings.xhr=function(){try{return new h.XMLHttpRequest}catch(F){}};var ac={0:200,1223:204},va=l.ajaxSettings.xhr();W.cors=!!va&&"withCredentials"in va;W.ajax=va=!!va;l.ajaxTransport(function(a){var c,d;if(W.cors||va&&!a.crossDomain)return{send:function(b,g){var e,f=a.xhr();if(f.open(a.type,a.url,a.async,a.username,
a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType);a.crossDomain||b["X-Requested-With"]||(b["X-Requested-With"]="XMLHttpRequest");for(e in b)f.setRequestHeader(e,b[e]);c=function(a){return function(){c&&(c=d=f.onload=f.onerror=f.onabort=f.onreadystatechange=null,"abort"===a?f.abort():"error"===a?"number"!=typeof f.status?g(0,"error"):g(f.status,f.statusText):g(ac[f.status]||f.status,f.statusText,"text"!==(f.responseType||
"text")||"string"!=typeof f.responseText?{binary:f.response}:{text:f.responseText},f.getAllResponseHeaders()))}};f.onload=c();d=f.onerror=c("error");void 0!==f.onabort?f.onabort=d:f.onreadystatechange=function(){4===f.readyState&&h.setTimeout(function(){c&&d()})};c=c("abort");try{f.send(a.hasContent&&a.data||null)}catch(qb){if(c)throw qb;}},abort:function(){c&&c()}}});l.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)});l.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return l.globalEval(a),a}}});l.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});l.ajaxTransport("script",function(a){if(a.crossDomain){var c,d;return{send:function(b,g){c=l("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",d=function(a){c.remove();d=null;a&&g("error"===a.type?404:200,a.type)});V.head.appendChild(c[0])},abort:function(){d&&d()}}}});
var mb=[],Na=/(=)\?(?=&|$)|\?\?/;l.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=mb.pop()||l.expando+"_"+ib++;return this[a]=!0,a}});l.ajaxPrefilter("json jsonp",function(a,c,d){var b,g,e,f=!1!==a.jsonp&&(Na.test(a.url)?"url":"string"==typeof a.data&&0===(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&Na.test(a.data)&&"data");if(f||"jsonp"===a.dataTypes[0])return b=a.jsonpCallback=l.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,f?a[f]=a[f].replace(Na,
"$1"+b):!1!==a.jsonp&&(a.url+=(La.test(a.url)?"&":"?")+a.jsonp+"="+b),a.converters["script json"]=function(){return e||l.error(b+" was not called"),e[0]},a.dataTypes[0]="json",g=h[b],h[b]=function(){e=arguments},d.always(function(){void 0===g?l(h).removeProp(b):h[b]=g;a[b]&&(a.jsonpCallback=c.jsonpCallback,mb.push(b));e&&l.isFunction(g)&&g(e[0]);e=g=void 0}),"script"});W.createHTMLDocument=function(){var a=V.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",
2===a.childNodes.length}();l.parseHTML=function(a,c,d){if("string"!=typeof a)return[];"boolean"==typeof c&&(d=c,c=!1);var b,g,e;return c||(W.createHTMLDocument?(c=V.implementation.createHTMLDocument(""),b=c.createElement("base"),b.href=V.location.href,c.head.appendChild(b)):c=V),g=$a.exec(a),e=!d&&[],g?[c.createElement(g[1])]:(g=y([a],c,e),e&&e.length&&l(e).remove(),l.merge([],g.childNodes))};l.fn.load=function(a,c,d){var b,g,e,f=this,m=a.indexOf(" ");return-1<m&&(b=l.trim(a.slice(m)),a=a.slice(0,
m)),l.isFunction(c)?(d=c,c=void 0):c&&"object"==typeof c&&(g="POST"),0<f.length&&l.ajax({url:a,type:g||"GET",dataType:"html",data:c}).done(function(a){e=arguments;f.html(b?l("<div>").append(l.parseHTML(a)).find(b):a)}).always(d&&function(a,c){f.each(function(){d.apply(this,e||[a.responseText,c,a])})}),this};l.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,c){l.fn[c]=function(a){return this.on(c,a)}});l.expr.pseudos.animated=function(a){return l.grep(l.timers,
function(c){return a===c.elem}).length};l.offset={setOffset:function(a,c,d){var b,g,e,f,m,k,h=l.css(a,"position"),p=l(a),r={};"static"===h&&(a.style.position="relative");m=p.offset();e=l.css(a,"top");k=l.css(a,"left");("absolute"===h||"fixed"===h)&&-1<(e+k).indexOf("auto")?(b=p.position(),f=b.top,g=b.left):(f=parseFloat(e)||0,g=parseFloat(k)||0);l.isFunction(c)&&(c=c.call(a,d,l.extend({},m)));null!=c.top&&(r.top=c.top-m.top+f);null!=c.left&&(r.left=c.left-m.left+g);"using"in c?c.using.call(a,r):p.css(r)}};
l.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(c){l.offset.setOffset(this,a,c)});var c,d,b,g,e=this[0];if(e)return e.getClientRects().length?(b=e.getBoundingClientRect(),b.width||b.height?(g=e.ownerDocument,d=ha(g),c=g.documentElement,{top:b.top+d.pageYOffset-c.clientTop,left:b.left+d.pageXOffset-c.clientLeft}):b):{top:0,left:0}},position:function(){if(this[0]){var a,c,d=this[0],b={top:0,left:0};return"fixed"===l.css(d,"position")?c=d.getBoundingClientRect():
(a=this.offsetParent(),c=this.offset(),l.nodeName(a[0],"html")||(b=a.offset()),b={top:b.top+l.css(a[0],"borderTopWidth",!0),left:b.left+l.css(a[0],"borderLeftWidth",!0)}),{top:c.top-b.top-l.css(d,"marginTop",!0),left:c.left-b.left-l.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===l.css(a,"position");)a=a.offsetParent;return a||Ea})}});l.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d="pageYOffset"===
c;l.fn[a]=function(b){return ka(this,function(a,b,g){var e=ha(a);return void 0===g?e?e[c]:a[b]:void(e?e.scrollTo(d?e.pageXOffset:g,d?g:e.pageYOffset):a[b]=g)},a,b,arguments.length)}});l.each(["top","left"],function(a,c){l.cssHooks[c]=O(W.pixelPosition,function(a,d){if(d)return d=N(a,c),Fa.test(d)?l(a).position()[c]+"px":d})});l.each({Height:"height",Width:"width"},function(a,c){l.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,b){l.fn[b]=function(g,e){var f=arguments.length&&(d||"boolean"!=
typeof g),m=d||(!0===g||!0===e?"margin":"border");return ka(this,function(c,d,g){var e;return l.isWindow(c)?0===b.indexOf("outer")?c["inner"+a]:c.document.documentElement["client"+a]:9===c.nodeType?(e=c.documentElement,Math.max(c.body["scroll"+a],e["scroll"+a],c.body["offset"+a],e["offset"+a],e["client"+a])):void 0===g?l.css(c,d,m):l.style(c,d,g,m)},c,f?g:void 0,f)}})});l.fn.extend({bind:function(a,c,d){return this.on(a,null,c,d)},unbind:function(a,c){return this.off(a,null,c)},delegate:function(a,
c,d,b){return this.on(c,a,d,b)},undelegate:function(a,c,d){return 1===arguments.length?this.off(a,"**"):this.off(c,a||"**",d)}});l.parseJSON=JSON.parse;"function"==typeof define&&define.amd&&define("jquery",[],function(){return l});var bc=h.jQuery,cc=h.$;return l.noConflict=function(a){return h.$===l&&(h.$=cc),a&&h.jQuery===l&&(h.jQuery=bc),l},f||(h.jQuery=h.$=l),l});
(function(h,f,e){function b(a,c,d){a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent("on"+c,d)}function g(a){if("keypress"==a.type){var c=String.fromCharCode(a.which);a.shiftKey||(c=c.toLowerCase());return c}return p[a.which]?p[a.which]:q[a.which]?q[a.which]:String.fromCharCode(a.which).toLowerCase()}function d(a){var c=[];a.shiftKey&&c.push("shift");a.altKey&&c.push("alt");a.ctrlKey&&c.push("ctrl");a.metaKey&&c.push("meta");return c}function a(a){return"shift"==a||"ctrl"==a||"alt"==a||
"meta"==a}function c(c,d){var b,g,e,f=[];b=c;"+"===b?b=["+"]:(b=b.replace(/\+{2}/g,"+plus"),b=b.split("+"));for(e=0;e<b.length;++e)g=b[e],t[g]&&(g=t[g]),d&&"keypress"!=d&&n[g]&&(g=n[g],f.push("shift")),a(g)&&f.push(g);b=g;e=d;if(!e){if(!r){r={};for(var m in p)95<m&&112>m||p.hasOwnProperty(m)&&(r[p[m]]=m)}e=r[b]?"keydown":"keypress"}"keypress"==e&&f.length&&(e="keydown");return{key:g,modifiers:f,action:e}}function m(a,c){return null===a||a===f?!1:a===c?!0:m(a.parentNode,c)}function k(e){function m(a){a=
a||{};var c=!1,d;for(d in t)a[d]?c=!0:t[d]=0;c||(D=!1)}function h(c,d,b,g,e,f){var m,k,h=[],p=b.type;if(!u._callbacks[c])return[];"keyup"==p&&a(c)&&(d=[c]);for(m=0;m<u._callbacks[c].length;++m)if(k=u._callbacks[c][m],(g||!k.seq||t[k.seq]==k.level)&&p==k.action){var r;(r="keypress"==p&&!b.metaKey&&!b.ctrlKey)||(r=k.modifiers,r=d.sort().join(",")===r.sort().join(","));r&&(r=g&&k.seq==g&&k.level==f,(!g&&k.combo==e||r)&&u._callbacks[c].splice(m,1),h.push(k))}return h}function p(a,c,d,b){u.stopCallback(c,
c.target||c.srcElement,d,b)||!1!==a(c,d)||(c.preventDefault?c.preventDefault():c.returnValue=!1,c.stopPropagation?c.stopPropagation():c.cancelBubble=!0)}function r(a){"number"!==typeof a.which&&(a.which=a.keyCode);var c=g(a);c&&("keyup"==a.type&&I===c?I=!1:u.handleKey(c,d(a),a))}function n(a,d,b,e){function f(c){return function(){D=c;++t[a];clearTimeout(E);E=setTimeout(m,1E3)}}function k(c){p(b,c,a);"keyup"!==e&&(I=g(c));setTimeout(m,10)}for(var h=t[a]=0;h<d.length;++h){var r=h+1===d.length?k:f(e||
c(d[h+1]).action);q(d[h],r,e,a,h)}}function q(a,d,b,g,e){u._directMap[a+":"+b]=d;a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?n(a,f,d,b):(b=c(a,b),u._callbacks[b.key]=u._callbacks[b.key]||[],h(b.key,b.modifiers,{type:b.action},g,a,e),u._callbacks[b.key][g?"unshift":"push"]({callback:d,modifiers:b.modifiers,action:b.action,seq:g,level:e,combo:a}))}var u=this;e=e||f;if(!(u instanceof k))return new k(e);u.target=e;u._callbacks={};u._directMap={};var t={},E,I=!1,J=!1,D=!1;u._handleKey=function(c,
d,b){var g=h(c,d,b),e;d={};var f=0,k=!1;for(e=0;e<g.length;++e)g[e].seq&&(f=Math.max(f,g[e].level));for(e=0;e<g.length;++e)g[e].seq?g[e].level==f&&(k=!0,d[g[e].seq]=1,p(g[e].callback,b,g[e].combo,g[e].seq)):k||p(g[e].callback,b,g[e].combo);g="keypress"==b.type&&J;b.type!=D||a(c)||g||m(d);J=k&&"keydown"==b.type};u._bindMultiple=function(a,c,d){for(var b=0;b<a.length;++b)q(a[b],c,d)};b(e,"keypress",r);b(e,"keydown",r);b(e,"keyup",r)}if(h){var p={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",
18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},q={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},t={option:"alt",command:"meta","return":"enter",
escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r;for(e=1;20>e;++e)p[111+e]="f"+e;for(e=0;9>=e;++e)p[e+96]=e;k.prototype.bind=function(a,c,d){a=a instanceof Array?a:[a];this._bindMultiple.call(this,a,c,d);return this};k.prototype.unbind=function(a,c){return this.bind.call(this,a,function(){},c)};k.prototype.trigger=function(a,c){if(this._directMap[a+":"+c])this._directMap[a+":"+c]({},a);return this};k.prototype.reset=function(){this._callbacks={};this._directMap=
{};return this};k.prototype.stopCallback=function(a,c){return-1<(" "+c.className+" ").indexOf(" mousetrap ")||m(c,this.target)?!1:"INPUT"==c.tagName||"SELECT"==c.tagName||"TEXTAREA"==c.tagName||c.isContentEditable};k.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)};k.addKeycodes=function(a){for(var c in a)a.hasOwnProperty(c)&&(p[c]=a[c]);r=null};k.init=function(){var a=k(f),c;for(c in a)"_"!==c.charAt(0)&&(k[c]=function(c){return function(){return a[c].apply(a,arguments)}}(c))};
k.init();h.Mousetrap=k;"undefined"!==typeof module&&module.exports&&(module.exports=k);"function"===typeof define&&define.amd&&define(function(){return k})}})("undefined"!==typeof window?window:null,"undefined"!==typeof window?document:null);
!function(h){var f=function(b,g,d){var a,c,e=document.createElement("img");if(e.onerror=g,e.onload=function(){!c||d&&d.noRevoke||f.revokeObjectURL(c);g&&g(f.scale(e,d))},f.isInstanceOf("Blob",b)||f.isInstanceOf("File",b))a=c=f.createObjectURL(b),e._type=b.type;else{if("string"!=typeof b)return!1;a=b;d&&d.crossOrigin&&(e.crossOrigin=d.crossOrigin)}return a?(e.src=a,e):f.readFile(b,function(a){var c=a.target;c&&c.result?e.src=c.result:g&&g(a)})},e=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&
URL||window.webkitURL&&webkitURL;f.isInstanceOf=function(b,g){return Object.prototype.toString.call(g)==="[object "+b+"]"};f.transformCoordinates=function(){};f.getTransformedOptions=function(b,g){var d,a,c,e,f=g.aspectRatio;if(!f)return g;d={};for(a in g)g.hasOwnProperty(a)&&(d[a]=g[a]);return d.crop=!0,c=b.naturalWidth||b.width,e=b.naturalHeight||b.height,c/e>f?(d.maxWidth=e*f,d.maxHeight=e):(d.maxWidth=c,d.maxHeight=c/f),d};f.renderImageToCanvas=function(b,g,d,a,c,e,f,h,q,n){return b.getContext("2d").drawImage(g,
d,a,c,e,f,h,q,n),b};f.hasCanvasOption=function(b){return b.canvas||b.crop||!!b.aspectRatio};f.scale=function(b,g){function d(){var a=Math.max((k||B)/B,(h||C)/C);1<a&&(B*=a,C*=a)}function a(){var a=Math.min((c||B)/B,(e||C)/C);1>a&&(B*=a,C*=a)}g=g||{};var c,e,k,h,q,n,t,r,u,A,y,v=document.createElement("canvas"),x=b.getContext||f.hasCanvasOption(g)&&v.getContext,z=b.naturalWidth||b.width,w=b.naturalHeight||b.height,B=z,C=w;if(x&&(g=f.getTransformedOptions(b,g),t=g.left||0,r=g.top||0,g.sourceWidth?(q=
g.sourceWidth,void 0!==g.right&&void 0===g.left&&(t=z-q-g.right)):q=z-t-(g.right||0),g.sourceHeight?(n=g.sourceHeight,void 0!==g.bottom&&void 0===g.top&&(r=w-n-g.bottom)):n=w-r-(g.bottom||0),B=q,C=n),c=g.maxWidth,e=g.maxHeight,k=g.minWidth,h=g.minHeight,x&&c&&e&&g.crop?(B=c,C=e,y=q/n-c/e,0>y?(n=e*q/c,void 0===g.top&&void 0===g.bottom&&(r=(w-n)/2)):0<y&&(q=c*n/e,void 0===g.left&&void 0===g.right&&(t=(z-q)/2))):((g.contain||g.cover)&&(k=c=c||k,h=e=e||h),g.cover?(a(),d()):(d(),a())),x){if(u=g.pixelRatio,
1<u&&(v.style.width=B+"px",v.style.height=C+"px",B*=u,C*=u,v.getContext("2d").scale(u,u)),A=g.downsamplingRatio,0<A&&1>A&&q>B&&n>C)for(;q*A>B;)v.width=q*A,v.height=n*A,f.renderImageToCanvas(v,b,t,r,q,n,0,0,v.width,v.height),q=v.width,n=v.height,b=document.createElement("canvas"),b.width=q,b.height=n,f.renderImageToCanvas(b,v,0,0,q,n,0,0,q,n);return v.width=B,v.height=C,f.transformCoordinates(v,g),f.renderImageToCanvas(v,b,t,r,q,n,0,0,B,C)}return b.width=B,b.height=C,b};f.createObjectURL=function(b){return e?
e.createObjectURL(b):!1};f.revokeObjectURL=function(b){return e?e.revokeObjectURL(b):!1};f.readFile=function(b,g,d){if(window.FileReader){var a=new FileReader;if(a.onload=a.onerror=g,d=d||"readAsDataURL",a[d])return a[d](b),a}return!1};"function"==typeof define&&define.amd?define(function(){return f}):"object"==typeof module&&module.exports?module.exports=f:h.loadImage=f}(window);
(function(h){"function"==typeof define&&define.amd?define(["./load-image"],h):h("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)})(function(h){var f=h.hasCanvasOption,e=h.transformCoordinates,b=h.getTransformedOptions;h.hasCanvasOption=function(b){return!!b.orientation||f.call(h,b)};h.transformCoordinates=function(b,d){e.call(h,b,d);var a=b.getContext("2d"),c=b.width,g=b.height,f=b.style.width,p=b.style.height,q=d.orientation;if(q&&!(8<q))switch(4<q&&(b.width=g,b.height=
c,b.style.width=p,b.style.height=f),q){case 2:a.translate(c,0);a.scale(-1,1);break;case 3:a.translate(c,g);a.rotate(Math.PI);break;case 4:a.translate(0,g);a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI);a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI);a.translate(0,-g);break;case 7:a.rotate(.5*Math.PI);a.translate(c,-g);a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI),a.translate(-c,0)}};h.getTransformedOptions=function(g,d){var a,c,e=b.call(h,g,d);a=e.orientation;if(!a||8<a||1===a)return e;a={};for(c in e)e.hasOwnProperty(c)&&
(a[c]=e[c]);switch(e.orientation){case 2:a.left=e.right;a.right=e.left;break;case 3:a.left=e.right;a.top=e.bottom;a.right=e.left;a.bottom=e.top;break;case 4:a.top=e.bottom;a.bottom=e.top;break;case 5:a.left=e.top;a.top=e.left;a.right=e.bottom;a.bottom=e.right;break;case 6:a.left=e.top;a.top=e.right;a.right=e.bottom;a.bottom=e.left;break;case 7:a.left=e.bottom;a.top=e.right;a.right=e.top;a.bottom=e.left;break;case 8:a.left=e.bottom,a.top=e.left,a.right=e.top,a.bottom=e.right}return 4<e.orientation&&
(a.maxWidth=e.maxHeight,a.maxHeight=e.maxWidth,a.minWidth=e.minHeight,a.minHeight=e.minWidth,a.sourceWidth=e.sourceHeight,a.sourceHeight=e.sourceWidth),a}});
(function(h){"function"==typeof define&&define.amd?define(["./load-image"],h):h("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)})(function(h){h.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice)&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)};h.metaDataParsers={jpeg:{65505:[]}};h.parseMetaData=function(f,e,b){b=b||{};var g=this,d=b.maxMetaDataSize||262144,a={};window.DataView&&
f&&12<=f.size&&"image/jpeg"===f.type&&h.blobSlice&&h.readFile(h.blobSlice.call(f,0,d),function(c){if(c.target.error)return console.log(c.target.error),void e(a);var d,f,p,q;c=c.target.result;var n=new DataView(c),t=2,r=n.byteLength-4;p=t;if(65496===n.getUint16(0)){for(;r>t&&(d=n.getUint16(t),65504<=d&&65519>=d||65534===d);){if(f=n.getUint16(t+2)+2,t+f>n.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(p=h.metaDataParsers.jpeg[d])for(q=0;q<p.length;q+=1)p[q].call(g,n,t,
f,a,b);p=t+=f}!b.disableImageHead&&6<p&&(c.slice?a.imageHead=c.slice(0,p):a.imageHead=(new Uint8Array(c)).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(a)},"readAsArrayBuffer")||e(a)}});
(function(h){"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],h):"object"==typeof module&&module.exports?h(require("./load-image"),require("./load-image-meta")):h(window.loadImage)})(function(h){h.ExifMap=function(){return this};h.ExifMap.prototype.map={Orientation:274};h.ExifMap.prototype.get=function(f){return this[f]||this[this.map[f]]};h.getExifThumbnail=function(f,e,b){var g,d,a;if(!b||e+b>f.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");
g=[];for(d=0;b>d;d+=1)a=f.getUint8(e+d),g.push((16>a?"0":"")+a.toString(16));return"data:image/jpeg,%"+g.join("%")};h.exifTagTypes={1:{getValue:function(f,e){return f.getUint8(e)},size:1},2:{getValue:function(f,e){return String.fromCharCode(f.getUint8(e))},size:1,ascii:!0},3:{getValue:function(f,e,b){return f.getUint16(e,b)},size:2},4:{getValue:function(f,e,b){return f.getUint32(e,b)},size:4},5:{getValue:function(f,e,b){return f.getUint32(e,b)/f.getUint32(e+4,b)},size:8},9:{getValue:function(f,e,
b){return f.getInt32(e,b)},size:4},10:{getValue:function(f,e,b){return f.getInt32(e,b)/f.getInt32(e+4,b)},size:8}};h.exifTagTypes[7]=h.exifTagTypes[1];h.getExifValue=function(f,e,b,g,d,a){var c,m,k;g=h.exifTagTypes[g];if(!g)return void console.log("Invalid Exif data: Invalid tag type.");if(c=g.size*d,m=4<c?e+f.getUint32(b+8,a):b+8,m+c>f.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===d)return g.getValue(f,m,a);e=[];for(b=0;d>b;b+=1)e[b]=g.getValue(f,m+b*g.size,
a);if(g.ascii){f="";for(b=0;b<e.length&&(k=e[b],"\x00"!==k);b+=1)f+=k;return f}return e};h.parseExifTag=function(f,e,b,g,d){var a=f.getUint16(b,g);d.exif[a]=h.getExifValue(f,e,b,f.getUint16(b+2,g),f.getUint32(b+4,g),g)};h.parseExifTags=function(f,e,b,g,d){var a,c,m;if(b+6>f.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(a=f.getUint16(b,g),c=b+2+12*a,c+4>f.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(m=0;a>m;m+=1)this.parseExifTag(f,
e,b+2+12*m,g,d);return f.getUint32(c,g)};h.parseExifData=function(f,e,b,g,d){if(!d.disableExif){var a,c;b=e+10;if(1165519206===f.getUint32(e+4)){if(b+8>f.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==f.getUint16(e+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(f.getUint16(b)){case 18761:e=!0;break;case 19789:e=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==f.getUint16(b+
2,e))return void console.log("Invalid Exif data: Missing TIFF marker.");a=f.getUint32(b+4,e);g.exif=new h.ExifMap;(a=h.parseExifTags(f,b,b+a,e,g))&&!d.disableExifThumbnail&&(c={exif:{}},h.parseExifTags(f,b,b+a,e,c),c.exif[513]&&(g.exif.Thumbnail=h.getExifThumbnail(f,b+c.exif[513],c.exif[514])));g.exif[34665]&&!d.disableExifSub&&h.parseExifTags(f,b,b+g.exif[34665],e,g);g.exif[34853]&&!d.disableExifGps&&h.parseExifTags(f,b,b+g.exif[34853],e,g)}}};h.metaDataParsers.jpeg[65505].push(h.parseExifData)});
(function(h){"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],h):"object"==typeof module&&module.exports?h(require("./load-image"),require("./load-image-exif")):h(window.loadImage)})(function(h){h.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",
530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",
40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",
34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",
41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",
42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",
26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};h.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",
1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",
7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",
71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},
SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",
4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};h.ExifMap.prototype.getText=function(f){var e=
this.get(f);switch(f){case "LightSource":case "Flash":case "MeteringMode":case "ExposureProgram":case "SensingMethod":case "SceneCaptureType":case "SceneType":case "CustomRendered":case "WhiteBalance":case "GainControl":case "Contrast":case "Saturation":case "Sharpness":case "SubjectDistanceRange":case "FileSource":case "Orientation":return this.stringValues[f][e];case "ExifVersion":case "FlashpixVersion":return e?String.fromCharCode(e[0],e[1],e[2],e[3]):void 0;case "ComponentsConfiguration":return e?
this.stringValues[f][e[0]]+this.stringValues[f][e[1]]+this.stringValues[f][e[2]]+this.stringValues[f][e[3]]:void 0;case "GPSVersionID":return e?e[0]+"."+e[1]+"."+e[2]+"."+e[3]:void 0}return String(e)};(function(f){var e,b=f.tags;f=f.map;for(e in b)b.hasOwnProperty(e)&&(f[b[e]]=e)})(h.ExifMap.prototype);h.ExifMap.prototype.getAll=function(){var f,e,b={};for(f in this)this.hasOwnProperty(f)&&(e=this.tags[f],e&&(b[e]=this.getText(e)));return b}});
!function(h,f){if("object"==typeof exports&&"object"==typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var e=f(),b;for(b in e)("object"==typeof exports?exports:h)[b]=e[b]}}(this,function(){return function(h){function f(b){if(e[b])return e[b].exports;var g=e[b]={exports:{},id:b,loaded:!1};return h[b].call(g.exports,g,g.exports,f),g.loaded=!0,g.exports}var e={};return f.m=h,f.c=e,f.p="",f(0)}([function(h,f,e){function b(a){return a&&a.__esModule?a:{"default":a}}
Object.defineProperty(f,"__esModule",{value:!0});var g=function(){function a(a,c){for(var d=0;d<c.length;d++){var b=c[d];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(c,d,b){return d&&a(c.prototype,d),b&&a(c,b),c}}();h=e(1);var d=b(h);h=e(2);var a=b(h);h=e(3);h=b(h);var c=e(5),c=b(c),m=e(6),m=b(m),k=e(7),k=b(k),p=e(8),p=b(p),q=e(9),q=b(q),n=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(c[d]=a[d]);return c["default"]=a,c}(e(4)),t=/^data:/,r=/^data:image\/jpeg.*;base64,/,u=void 0;e=function(){function c(a,b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.element=a;this.options=n.extend({},d["default"],n.isPlainObject(b)&&b);this.isImg=this.wheeling=this.limited=this.replaced=this.disabled=this.cropped=this.rotated=this.complete=this.ready=this.loaded=!1;this.originalUrl="";this.previews=this.cropBoxData=this.canvasData=null;this.init()}
return g(c,[{key:"init",value:function(){var a=this.element,c=a.tagName.toLowerCase(),d=void 0;if(!n.getData(a,"cropper")){if(n.setData(a,"cropper",this),"img"===c){if(this.isImg=!0,this.originalUrl=d=a.getAttribute("src"),!d)return;d=a.src}else"canvas"===c&&window.HTMLCanvasElement&&(d=a.toDataURL());this.load(d)}}},{key:"load",value:function(a){var c=this,d=c.options,b=c.element;if(a){if(c.url=a,c.imageData={},!d.checkOrientation||!window.ArrayBuffer)return void c.clone();if(t.test(a))return void(r?
c.read(n.dataURLToArrayBuffer(a)):c.clone());var g=new XMLHttpRequest;g.onerror=g.onabort=function(){c.clone()};g.onload=function(){c.read(g.response)};d.checkCrossOrigin&&n.isCrossOriginURL(a)&&b.crossOrigin&&(a=n.addTimestamp(a));g.open("get",a);g.responseType="arraybuffer";g.send()}}},{key:"read",value:function(a){var c=this.options,d=n.getOrientation(a),b=this.imageData,g=0,e=1,f=1;if(1<d)switch(this.url=n.arrayBufferToDataURL(a),d){case 2:e=-1;break;case 3:g=-180;break;case 4:f=-1;break;case 5:g=
90;f=-1;break;case 6:g=90;break;case 7:g=90;e=-1;break;case 8:g=-90}c.rotatable&&(b.rotate=g);c.scalable&&(b.scaleX=e,b.scaleY=f);this.clone()}},{key:"clone",value:function(){var a=this.element,c=this.url,d=void 0,b=void 0;this.options.checkCrossOrigin&&n.isCrossOriginURL(c)&&(d=a.crossOrigin,d?b=c:(d="anonymous",b=n.addTimestamp(c)));this.crossOrigin=d;this.crossOriginUrl=b;var g=n.createElement("img");d&&(g.crossOrigin=d);g.src=b||c;this.image=g;this.onStart=c=n.proxy(this.start,this);this.onStop=
d=n.proxy(this.stop,this);this.isImg?a.complete?this.start():n.addListener(a,"load",c):(n.addListener(g,"load",c),n.addListener(g,"error",d),n.addClass(g,"cropper-hide"),a.parentNode.insertBefore(g,a.nextSibling))}},{key:"start",value:function(a){var c=this,d=c.isImg?c.element:c.image;a&&(n.removeListener(d,"load",c.onStart),n.removeListener(d,"error",c.onStop));n.getImageSize(d,function(a,d){n.extend(c.imageData,{naturalWidth:a,naturalHeight:d,aspectRatio:a/d});c.loaded=!0;c.build()})}},{key:"stop",
value:function(){var a=this.image;n.removeListener(a,"load",this.onStart);n.removeListener(a,"error",this.onStop);n.removeChild(a);this.image=null}},{key:"build",value:function(){var c=this,d=c.options,b=c.element,g=c.image,e=void 0,f=void 0,m=void 0,k=void 0,h=void 0,p=void 0;c.loaded&&(c.ready&&c.unbuild(),f=n.createElement("div"),f.innerHTML=a["default"],c.container=e=b.parentNode,c.cropper=f=n.getByClass(f,"cropper-container")[0],c.canvas=m=n.getByClass(f,"cropper-canvas")[0],c.dragBox=k=n.getByClass(f,
"cropper-drag-box")[0],c.cropBox=h=n.getByClass(f,"cropper-crop-box")[0],c.viewBox=n.getByClass(f,"cropper-view-box")[0],c.face=p=n.getByClass(h,"cropper-face")[0],n.appendChild(m,g),n.addClass(b,"cropper-hidden"),e.insertBefore(f,b.nextSibling),c.isImg||n.removeClass(g,"cropper-hide"),c.initPreview(),c.bind(),d.aspectRatio=Math.max(0,d.aspectRatio)||NaN,d.viewMode=Math.max(0,Math.min(3,Math.round(d.viewMode)))||0,d.autoCrop?(c.cropped=!0,d.modal&&n.addClass(k,"cropper-modal")):n.addClass(h,"cropper-hidden"),
d.guides||n.addClass(n.getByClass(h,"cropper-dashed"),"cropper-hidden"),d.center||n.addClass(n.getByClass(h,"cropper-center"),"cropper-hidden"),d.background&&n.addClass(f,"cropper-bg"),d.highlight||n.addClass(p,"cropper-invisible"),d.cropBoxMovable&&(n.addClass(p,"cropper-move"),n.setData(p,"action","all")),d.cropBoxResizable||(n.addClass(n.getByClass(h,"cropper-line"),"cropper-hidden"),n.addClass(n.getByClass(h,"cropper-point"),"cropper-hidden")),c.setDragMode(d.dragMode),c.render(),c.ready=!0,c.setData(d.data),
c.completing=setTimeout(function(){n.isFunction(d.ready)&&n.addListener(b,"ready",d.ready,!0);n.dispatchEvent(b,"ready");n.dispatchEvent(b,"crop",c.getData());c.complete=!0},0))}},{key:"unbuild",value:function(){this.ready&&(this.complete||clearTimeout(this.completing),this.ready=!1,this.complete=!1,this.initialImageData=null,this.initialCanvasData=null,this.initialCropBoxData=null,this.containerData=null,this.canvasData=null,this.cropBoxData=null,this.unbind(),this.resetPreview(),this.previews=null,
this.viewBox=null,this.cropBox=null,this.dragBox=null,this.canvas=null,this.container=null,n.removeChild(this.cropper),this.cropper=null)}}],[{key:"noConflict",value:function(){return window.Cropper=u,c}},{key:"setDefaults",value:function(a){n.extend(d["default"],n.isPlainObject(a)&&a)}}]),c}();n.extend(e.prototype,h["default"]);n.extend(e.prototype,c["default"]);n.extend(e.prototype,m["default"]);n.extend(e.prototype,k["default"]);n.extend(e.prototype,p["default"]);n.extend(e.prototype,q["default"]);
"undefined"!=typeof window&&(u=window.Cropper,window.Cropper=e);f["default"]=e},function(h,f){Object.defineProperty(f,"__esModule",{value:!0});f["default"]={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,
toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null}},function(h,f){Object.defineProperty(f,"__esModule",{value:!0});f["default"]='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>'},
function(h,f,e){Object.defineProperty(f,"__esModule",{value:!0});var b=function(b){if(b&&b.__esModule)return b;var d={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return d["default"]=b,d}(e(4));f["default"]={render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var g=this.options,d=this.element,a=this.container,c=this.cropper;b.addClass(c,"cropper-hidden");b.removeClass(d,
"cropper-hidden");this.containerData=g={width:Math.max(a.offsetWidth,Number(g.minContainerWidth)||200),height:Math.max(a.offsetHeight,Number(g.minContainerHeight)||100)};b.setStyle(c,{width:g.width,height:g.height});b.addClass(d,"cropper-hidden");b.removeClass(c,"cropper-hidden")},initCanvas:function(){var g=this.options.viewMode,d=this.containerData,a=this.imageData,c=90===Math.abs(a.rotate),e=c?a.naturalHeight:a.naturalWidth,f=c?a.naturalWidth:a.naturalHeight,h=e/f,c=d.width,q=d.height;d.height*
h>d.width?3===g?c=d.height*h:q=d.width/h:3===g?q=d.width/h:c=d.height*h;e={naturalWidth:e,naturalHeight:f,aspectRatio:h,width:c,height:q};e.oldLeft=e.left=(d.width-c)/2;e.oldTop=e.top=(d.height-q)/2;this.canvasData=e;this.limited=1===g||2===g;this.limitCanvas(!0,!0);this.initialImageData=b.extend({},a);this.initialCanvasData=b.extend({},e)},limitCanvas:function(b,d){var a=this.options,c=a.viewMode,g=this.containerData,e=this.canvasData,f=e.aspectRatio,h=this.cropBoxData,n=this.cropped&&h,t=void 0,
r=void 0,u=void 0,A=void 0;b&&(t=Number(a.minCanvasWidth)||0,r=Number(a.minCanvasHeight)||0,1<c?(t=Math.max(t,g.width),r=Math.max(r,g.height),3===c&&(r*f>t?t=r*f:r=t/f)):0<c&&(t?t=Math.max(t,n?h.width:0):r?r=Math.max(r,n?h.height:0):n&&(t=h.width,r=h.height,r*f>t?t=r*f:r=t/f)),t&&r?r*f>t?r=t/f:t=r*f:t?r=t/f:r&&(t=r*f),e.minWidth=t,e.minHeight=r,e.maxWidth=1/0,e.maxHeight=1/0);d&&(c?(u=g.width-e.width,A=g.height-e.height,e.minLeft=Math.min(0,u),e.minTop=Math.min(0,A),e.maxLeft=Math.max(0,u),e.maxTop=
Math.max(0,A),n&&this.limited&&(e.minLeft=Math.min(h.left,h.left+(h.width-e.width)),e.minTop=Math.min(h.top,h.top+(h.height-e.height)),e.maxLeft=h.left,e.maxTop=h.top,2===c&&(e.width>=g.width&&(e.minLeft=Math.min(0,u),e.maxLeft=Math.max(0,u)),e.height>=g.height&&(e.minTop=Math.min(0,A),e.maxTop=Math.max(0,A))))):(e.minLeft=-e.width,e.minTop=-e.height,e.maxLeft=g.width,e.maxTop=g.height))},renderCanvas:function(g){var d=this.canvasData,a=this.imageData,c=a.rotate,e=void 0,f=void 0;this.rotated&&(this.rotated=
!1,f=b.getRotatedSizes({width:a.width,height:a.height,degree:c}),e=f.width/f.height,e!==d.aspectRatio&&(d.left-=(f.width-d.width)/2,d.top-=(f.height-d.height)/2,d.width=f.width,d.height=f.height,d.aspectRatio=e,d.naturalWidth=a.naturalWidth,d.naturalHeight=a.naturalHeight,c%180&&(f=b.getRotatedSizes({width:a.naturalWidth,height:a.naturalHeight,degree:c}),d.naturalWidth=f.width,d.naturalHeight=f.height),this.limitCanvas(!0,!1)));(d.width>d.maxWidth||d.width<d.minWidth)&&(d.left=d.oldLeft);(d.height>
d.maxHeight||d.height<d.minHeight)&&(d.top=d.oldTop);d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth);d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight);this.limitCanvas(!1,!0);d.oldLeft=d.left=Math.min(Math.max(d.left,d.minLeft),d.maxLeft);d.oldTop=d.top=Math.min(Math.max(d.top,d.minTop),d.maxTop);b.setStyle(this.canvas,{width:d.width,height:d.height,left:d.left,top:d.top});this.renderImage();this.cropped&&this.limited&&this.limitCropBox(!0,!0);g&&this.output()},renderImage:function(g){var d=
this.canvasData,a=this.imageData,c=void 0,e=void 0,f=void 0,h=void 0;a.rotate&&(e=b.getRotatedSizes({width:d.width,height:d.height,degree:a.rotate,aspectRatio:a.aspectRatio},!0),f=e.width,h=e.height,c={width:f,height:h,left:(d.width-f)/2,top:(d.height-h)/2});b.extend(a,c||{width:d.width,height:d.height,left:0,top:0});d=b.getTransform(a);b.setStyle(this.image,{width:a.width,height:a.height,marginLeft:a.left,marginTop:a.top,WebkitTransform:d,msTransform:d,transform:d});g&&this.output()},initCropBox:function(){var g=
this.options,d=g.aspectRatio,g=Number(g.autoCropArea)||.8,a=this.canvasData,c={width:a.width,height:a.height};d&&(a.height*d>a.width?c.height=c.width/d:c.width=c.height*d);this.cropBoxData=c;this.limitCropBox(!0,!0);c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth);c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight);c.width=Math.max(c.minWidth,c.width*g);c.height=Math.max(c.minHeight,c.height*g);c.oldLeft=c.left=a.left+(a.width-c.width)/2;c.oldTop=c.top=a.top+(a.height-c.height)/
2;this.initialCropBoxData=b.extend({},c)},limitCropBox:function(b,d){var a=this.options,c=a.aspectRatio,g=this.containerData,e=this.canvasData,f=this.cropBoxData,h=this.limited,n=void 0,t=void 0,r=void 0,u=void 0;b&&(n=Number(a.minCropBoxWidth)||0,t=Number(a.minCropBoxHeight)||0,n=Math.min(n,g.width),t=Math.min(t,g.height),r=Math.min(g.width,h?e.width:g.width),u=Math.min(g.height,h?e.height:g.height),c&&(n&&t?t*c>n?t=n/c:n=t*c:n?t=n/c:t&&(n=t*c),u*c>r?u=r/c:r=u*c),f.minWidth=Math.min(n,r),f.minHeight=
Math.min(t,u),f.maxWidth=r,f.maxHeight=u);d&&(h?(f.minLeft=Math.max(0,e.left),f.minTop=Math.max(0,e.top),f.maxLeft=Math.min(g.width,e.left+e.width)-f.width,f.maxTop=Math.min(g.height,e.top+e.height)-f.height):(f.minLeft=0,f.minTop=0,f.maxLeft=g.width-f.width,f.maxTop=g.height-f.height))},renderCropBox:function(){var g=this.options,d=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft);(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop);a.width=
Math.min(Math.max(a.width,a.minWidth),a.maxWidth);a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight);this.limitCropBox(!1,!0);a.oldLeft=a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft);a.oldTop=a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop);g.movable&&g.cropBoxMovable&&b.setData(this.face,"action",a.width===d.width&&a.height===d.height?"move":"all");b.setStyle(this.cropBox,{width:a.width,height:a.height,left:a.left,top:a.top});this.cropped&&this.limited&&this.limitCanvas(!0,!0);
this.disabled||this.output()},output:function(){this.preview();this.complete&&b.dispatchEvent(this.element,"crop",this.getData())}}},function(h,f){function e(a){return G.call(a).slice(8,-1).toLowerCase()}function b(a){return"number"==typeof a&&!isNaN(a)}function g(a){return"undefined"==typeof a}function d(a){return"object"===("undefined"==typeof a?"undefined":z(a))&&null!==a}function a(a){return"function"===e(a)}function c(a){return Array.isArray?Array.isArray(a):"array"===e(a)}function m(a){return"string"==
typeof a&&(a=a.trim?a.trim():a.replace(J,"$1")),a}function k(g,e){if(g&&a(e)){var f=void 0;if(c(g)||b(g.length))for(var m=g.length,f=0;f<m&&!1!==e.call(g,g[f],f,g);f++);else d(g)&&Object.keys(g).forEach(function(a){e.call(g,g[a],a,g)})}return g}function p(){for(var a=arguments.length,c=Array(a),b=0;b<a;b++)c[b]=arguments[b];var g=!0===c[0],e=g?c[1]:c[0];return 1<c.length&&(c.shift(),c.forEach(function(a){d(a)&&Object.keys(a).forEach(function(c){g&&d(e[c])?p(!0,e[c],a[c]):e[c]=a[c]})})),e}function q(a,
c){if(b(a.length))return void k(a,function(a){q(a,c)});if(a.classList)return void a.classList.add(c);var d=m(a.className);d?0>d.indexOf(c)&&(a.className=d+" "+c):a.className=c}function n(a,c){return b(a.length)?void k(a,function(a){n(a,c)}):a.classList?void a.classList.remove(c):void(0<=a.className.indexOf(c)&&(a.className=a.className.replace(c,"")))}function t(a,c,d){return b(a.length)?void k(a,function(a){t(a,c,d)}):void(d?q(a,c):n(a,c))}function r(a){return a.replace(B,"$1-$2").toLowerCase()}function u(a,
c,d){var b=m(c).split(E);return 1<b.length?void k(b,function(c){u(a,c,d)}):void(a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent&&a.detachEvent("on"+c,d))}function A(a,c,d,b){var g=m(c).split(E),e=d;return 1<g.length?void k(g,function(c){A(a,c,d)}):(b&&(d=function(){for(var b=arguments.length,g=Array(b),f=0;f<b;f++)g[f]=arguments[f];return u(a,c,d),e.apply(a,g)}),void(a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent&&a.attachEvent("on${type}",d)))}function y(a){return document.createElement(a)}
function v(a,c){var d=Math.abs(a.degree)%180,b=(90<d?180-d:d)*Math.PI/180,d=Math.sin(b),b=Math.cos(b),g=a.width,e=a.height,f=a.aspectRatio,m=void 0,k=void 0;return c?(m=g/(b+d/f),k=m/f):(m=g*b+e*d,k=g*d+e*b),{width:m,height:k}}function x(a,c,d){var b="",g=c;for(d+=c;g<d;g++)b+=P(a.getUint8(g));return b}Object.defineProperty(f,"__esModule",{value:!0});var z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===
Symbol?"symbol":typeof a};f.typeOf=e;f.isNumber=b;f.isUndefined=g;f.isObject=d;f.isPlainObject=function(a){if(!d(a))return!1;try{var c=a.constructor,b=c.prototype;return c&&b&&L.call(b,"isPrototypeOf")}catch(Z){return!1}};f.isFunction=a;f.isArray=c;f.toArray=function(a,c){return c=0<=c?c:0,Array.from?Array.from(a).slice(c):M.call(a,c)};f.trim=m;f.each=k;f.extend=p;f.proxy=function(a,c){for(var d=arguments.length,b=Array(2<d?d-2:0),g=2;g<d;g++)b[g-2]=arguments[g];return function(){for(var d=arguments.length,
g=Array(d),e=0;e<d;e++)g[e]=arguments[e];return a.apply(c,b.concat(g))}};f.setStyle=function(a,c){var d=a.style;k(c,function(a,c){I.test(c)&&b(a)&&(a+="px");d[c]=a})};f.hasClass=function(a,c){return a.classList?a.classList.contains(c):-1<a.className.indexOf(c)};f.addClass=q;f.removeClass=n;f.toggleClass=t;f.hyphenate=r;f.getData=function(a,c){return d(a[c])?a[c]:a.dataset?a.dataset[c]:a.getAttribute("data-"+r(c))};f.setData=function(a,c,b){d(b)?a[c]=b:a.dataset?a.dataset[c]=b:a.setAttribute("data-"+
r(c),b)};f.removeData=function(a,c){d(a[c])?delete a[c]:a.dataset?delete a.dataset[c]:a.removeAttribute("data-"+r(c))};f.removeListener=u;f.dispatchEvent=function(c,d,b){if(c.dispatchEvent){var e=void 0;return a(Event)&&a(CustomEvent)?e=g(b)?new Event(d,{bubbles:!0,cancelable:!0}):new CustomEvent(d,{detail:b,bubbles:!0,cancelable:!0}):g(b)?(e=document.createEvent("Event"),e.initEvent(d,!0,!0)):(e=document.createEvent("CustomEvent"),e.initCustomEvent(d,!0,!0,b)),c.dispatchEvent(e)}return!c.fireEvent||
c.fireEvent("on"+d)};f.getEvent=function(a){var c=a||window.event;if(c.target||(c.target=c.srcElement||document),!b(c.pageX)&&b(c.clientX)){var d=a.target.ownerDocument||document;a=d.documentElement;d=d.body;c.pageX=c.clientX+((a&&a.scrollLeft||d&&d.scrollLeft||0)-(a&&a.clientLeft||d&&d.clientLeft||0));c.pageY=c.clientY+((a&&a.scrollTop||d&&d.scrollTop||0)-(a&&a.clientTop||d&&d.clientTop||0))}return c};f.getOffset=function(a){var c=document.documentElement;a=a.getBoundingClientRect();return{left:a.left+
((window.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0)),top:a.top+((window.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0))}};f.getTouchesCenter=function(a){var c=a.length,d=0,b=0;return c&&(k(a,function(a){d+=a.pageX;b+=a.pageY}),d/=c,b/=c),{pageX:d,pageY:b}};f.getByTag=function(a,c){return a.getElementsByTagName(c)};f.getByClass=function(a,c){return a.getElementsByClassName?a.getElementsByClassName(c):a.querySelectorAll("."+c)};f.createElement=y;f.appendChild=function(a,c){a.appendChild(c)};
f.removeChild=function(a){a.parentNode&&a.parentNode.removeChild(a)};f.empty=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};f.isCrossOriginURL=function(a){return(a=a.match(C))&&(a[1]!==location.protocol||a[2]!==location.hostname||a[3]!==location.port)};f.addTimestamp=function(a){var c="timestamp="+(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+c};f.getImageSize=function(a,c){if(a.naturalWidth&&!O)return void c(a.naturalWidth,a.naturalHeight);var d=y("img");d.onload=function(){c(this.width,
this.height)};d.src=a.src};f.getTransform=function(a){var c=[],d=a.rotate,g=a.scaleX;a=a.scaleY;return b(d)&&0!==d&&c.push("rotate("+d+"deg)"),b(g)&&1!==g&&c.push("scaleX("+g+")"),b(a)&&1!==a&&c.push("scaleY("+a+")"),c.length?c.join(" "):"none"};f.getRotatedSizes=v;f.getSourceCanvas=function(a,c){var d=y("canvas"),g=d.getContext("2d"),e=0,f=0,m=c.naturalWidth,k=c.naturalHeight,h=c.rotate,p=c.scaleX,r=c.scaleY,n=b(p)&&b(r)&&(1!==p||1!==r),q=b(h)&&0!==h,u=q||n,t=m*Math.abs(p||1),A=k*Math.abs(r||1),
z=void 0,w=void 0,x=void 0;return n&&(z=t/2,w=A/2),q&&(x=v({width:t,height:A,degree:h}),t=x.width,A=x.height,z=t/2,w=A/2),d.width=t,d.height=A,u&&(e=-m/2,f=-k/2,g.save(),g.translate(z,w)),q&&g.rotate(h*Math.PI/180),n&&g.scale(p,r),g.drawImage(a,Math.floor(e),Math.floor(f),Math.floor(m),Math.floor(k)),u&&g.restore(),d};f.getStringFromCharCode=x;f.getOrientation=function(a){a=new DataView(a);var c=a.byteLength,d=void 0,b=void 0,g=void 0,e=void 0,f=void 0,m=void 0,k=void 0,h=void 0,p=void 0;if(255===
a.getUint8(0)&&216===a.getUint8(1))for(p=2;p<c;){if(255===a.getUint8(p)&&225===a.getUint8(p+1)){k=p;break}p++}if(k&&(b=k+4,g=k+10,"Exif"===x(a,b,4)&&(m=a.getUint16(g),f=18761===m,(f||19789===m)&&42===a.getUint16(g+2,f)&&(e=a.getUint32(g+4,f),8<=e&&(h=g+e)))),h)for(c=a.getUint16(h,f),b=0;b<c;b++)if(p=h+12*b+2,274===a.getUint16(p,f)){p+=8;d=a.getUint16(p,f);O&&a.setUint16(p,1,f);break}return d};f.dataURLToArrayBuffer=function(a){a=a.replace(w,"");a=atob(a);var c=a.length,d=new ArrayBuffer(c),b=new Uint8Array(d),
g;for(g=0;g<c;g++)b[g]=a.charCodeAt(g);return d};f.arrayBufferToDataURL=function(a){a=new Uint8Array(a);var c=a.length,d="",b;for(b=0;b<c;b++)d+=P(a[b]);return"data:image/jpeg;base64,"+btoa(d)};var w=/^data:([^;]+);base64,/,B=/([a-z\d])([A-Z])/g,C=/^(https?:)\/\/([^:\/\?#]+):?(\d*)/i,E=/\s+/,I=/^(width|height|left|top|marginLeft|marginTop)$/,J=/^\s+(.*)\s+$/,D=/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i,N=window.navigator,O=N&&D.test(N.userAgent),D=Object.prototype,G=D.toString,L=D.hasOwnProperty,
M=Array.prototype.slice,P=String.fromCharCode;f.addListener=A},function(h,f,e){Object.defineProperty(f,"__esModule",{value:!0});var b=function(b){if(b&&b.__esModule)return b;var d={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return d["default"]=b,d}(e(4));f["default"]={initPreview:function(){var g=this.options.preview,d=b.createElement("img"),a=this.crossOrigin,c=a?this.crossOriginUrl:this.url;if(a&&(d.crossOrigin=a),d.src=c,b.appendChild(this.viewBox,d),this.image2=
d,g)this.previews=g=document.querySelectorAll(g),b.each(g,function(d){var g=b.createElement("img");b.setData(d,"preview",{width:d.offsetWidth,height:d.offsetHeight,html:d.innerHTML});a&&(g.crossOrigin=a);g.src=c;g.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';b.empty(d);b.appendChild(d,g)})},resetPreview:function(){b.each(this.previews,function(g){var d=b.getData(g,
"preview");b.setStyle(g,{width:d.width,height:d.height});g.innerHTML=d.html;b.removeData(g,"preview")})},preview:function(){var g=this.imageData,d=this.canvasData,a=this.cropBoxData,c=a.width,e=a.height,f=g.width,h=g.height,q=a.left-d.left-g.left,n=a.top-d.top-g.top,g=b.getTransform(g),t={WebkitTransform:g,msTransform:g,transform:g};this.cropped&&!this.disabled&&(b.setStyle(this.image2,b.extend({width:f,height:h,marginLeft:-q,marginTop:-n},t)),b.each(this.previews,function(a){var d=b.getData(a,"preview"),
g=d.width,d=d.height,m=g,k=d,p=1;c&&(p=g/c,k=e*p);e&&k>d&&(p=d/e,m=c*p,k=d);b.setStyle(a,{width:m,height:k});b.setStyle(b.getByTag(a,"img")[0],b.extend({width:f*p,height:h*p,marginLeft:-q*p,marginTop:-n*p},t))}))}}},function(h,f,e){Object.defineProperty(f,"__esModule",{value:!0});var b=function(b){if(b&&b.__esModule)return b;var d={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return d["default"]=b,d}(e(4));f["default"]={bind:function(){var g=this.options,d=this.element,
a=this.cropper;b.isFunction(g.cropstart)&&b.addListener(d,"cropstart",g.cropstart);b.isFunction(g.cropmove)&&b.addListener(d,"cropmove",g.cropmove);b.isFunction(g.cropend)&&b.addListener(d,"cropend",g.cropend);b.isFunction(g.crop)&&b.addListener(d,"crop",g.crop);b.isFunction(g.zoom)&&b.addListener(d,"zoom",g.zoom);b.addListener(a,"mousedown touchstart pointerdown MSPointerDown",this.onCropStart=b.proxy(this.cropStart,this));g.zoomable&&g.zoomOnWheel&&b.addListener(a,"wheel mousewheel DOMMouseScroll",
this.onWheel=b.proxy(this.wheel,this));g.toggleDragModeOnDblclick&&b.addListener(a,"dblclick",this.onDblclick=b.proxy(this.dblclick,this));b.addListener(document,"mousemove touchmove pointermove MSPointerMove",this.onCropMove=b.proxy(this.cropMove,this));b.addListener(document,"mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",this.onCropEnd=b.proxy(this.cropEnd,this));g.responsive&&b.addListener(window,"resize",this.onResize=b.proxy(this.resize,this))},unbind:function(){var g=
this.options,d=this.element,a=this.cropper;b.isFunction(g.cropstart)&&b.removeListener(d,"cropstart",g.cropstart);b.isFunction(g.cropmove)&&b.removeListener(d,"cropmove",g.cropmove);b.isFunction(g.cropend)&&b.removeListener(d,"cropend",g.cropend);b.isFunction(g.crop)&&b.removeListener(d,"crop",g.crop);b.isFunction(g.zoom)&&b.removeListener(d,"zoom",g.zoom);b.removeListener(a,"mousedown touchstart pointerdown MSPointerDown",this.onCropStart);g.zoomable&&g.zoomOnWheel&&b.removeListener(a,"wheel mousewheel DOMMouseScroll",
this.onWheel);g.toggleDragModeOnDblclick&&b.removeListener(a,"dblclick",this.onDblclick);b.removeListener(document,"mousemove touchmove pointermove MSPointerMove",this.onCropMove);b.removeListener(document,"mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",this.onCropEnd);g.responsive&&b.removeListener(window,"resize",this.onResize)}}},function(h,f,e){Object.defineProperty(f,"__esModule",{value:!0});f.REGEXP_ACTIONS=void 0;var b=function(d){if(d&&d.__esModule)return d;
var a={};if(null!=d)for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c]);return a["default"]=d,a}(e(4)),g=f.REGEXP_ACTIONS=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;f["default"]={resize:function(){var d=this.options.restore,a=this.container,c=this.containerData;if(!this.disabled&&c){var g=a.offsetWidth/c.width,e=void 0,f=void 0;1===g&&a.offsetHeight===c.height||(d&&(e=this.getCanvasData(),f=this.getCropBoxData()),this.render(),d&&(this.setCanvasData(b.each(e,function(a,c){e[c]=
a*g})),this.setCropBoxData(b.each(f,function(a,c){f[c]=a*g}))))}},dblclick:function(){this.disabled||this.setDragMode(b.hasClass(this.dragBox,"cropper-crop")?"move":"crop")},wheel:function(d){var a=this;d=b.getEvent(d);var c=Number(a.options.wheelZoomRatio)||.1,g=1;a.disabled||(d.preventDefault(),a.wheeling||(a.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),d.deltaY?g=0<d.deltaY?1:-1:d.wheelDelta?g=-d.wheelDelta/120:d.detail&&(g=0<d.detail?1:-1),a.zoom(-g*c,d)))},cropStart:function(d){var a=
this.options;d=b.getEvent(d);var c=d.touches,e=void 0,f=void 0,h=void 0;if(!this.disabled){if(c){if(e=c.length,1<e){if(!a.zoomable||!a.zoomOnTouch||2!==e)return;f=c[1];this.startX2=f.pageX;this.startY2=f.pageY;h="zoom"}f=c[0]}(h=h||b.getData(d.target,"action"),g.test(h))&&!1!==b.dispatchEvent(this.element,"cropstart",{originalEvent:d,action:h})&&(d.preventDefault(),this.action=h,this.cropping=!1,this.startX=f?f.pageX:d.pageX,this.startY=f?f.pageY:d.pageY,"crop"===h&&(this.cropping=!0,b.addClass(this.dragBox,
"cropper-modal")))}},cropMove:function(d){var a=this.options;d=b.getEvent(d);var c=d.touches,g=this.action,e=void 0,f=void 0;if(!this.disabled){if(c){if(e=c.length,1<e){if(!a.zoomable||!a.zoomOnTouch||2!==e)return;f=c[1];this.endX2=f.pageX;this.endY2=f.pageY}f=c[0]}g&&!1!==b.dispatchEvent(this.element,"cropmove",{originalEvent:d,action:g})&&(d.preventDefault(),this.endX=f?f.pageX:d.pageX,this.endY=f?f.pageY:d.pageY,this.change(d.shiftKey,"zoom"===g?d:null))}},cropEnd:function(d){var a=this.options;
d=b.getEvent(d);var c=this.action;this.disabled||c&&(d.preventDefault(),this.cropping&&(this.cropping=!1,b.toggleClass(this.dragBox,"cropper-modal",this.cropped&&a.modal)),this.action="",b.dispatchEvent(this.element,"cropend",{originalEvent:d,action:c}))}}},function(h,f,e){Object.defineProperty(f,"__esModule",{value:!0});var b=function(b){if(b&&b.__esModule)return b;var d={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return d["default"]=b,d}(e(4));f["default"]=
{change:function(g,d){var a=this.containerData,c=this.canvasData,e=this.cropBoxData,f=this.options.aspectRatio,h=this.action,q=e.width,n=e.height,t=e.left,r=e.top,u=t+q,A=r+n,y=0,v=0,x=a.width,z=a.height,w=!0,B=void 0;!f&&g&&(f=q&&n?q/n:1);this.limited&&(y=e.minLeft,v=e.minTop,x=y+Math.min(a.width,c.width,c.left+c.width),z=v+Math.min(a.height,c.height,c.top+c.height));var a=this.endX-this.startX,c=this.endY-this.startY,C,E;switch(f&&(C=c*f,E=a/f),h){case "all":t+=a;r+=c;break;case "e":if(0<=a&&(u>=
x||f&&(r<=v||A>=z))){w=!1;break}q+=a;f&&(n=q/f,r-=E/2);0>q&&(h="w",q=0);break;case "n":if(0>=c&&(r<=v||f&&(t<=y||u>=x))){w=!1;break}n-=c;r+=c;f&&(q=n*f,t+=C/2);0>n&&(h="s",n=0);break;case "w":if(0>=a&&(t<=y||f&&(r<=v||A>=z))){w=!1;break}q-=a;t+=a;f&&(n=q/f,r+=E/2);0>q&&(h="e",q=0);break;case "s":if(0<=c&&(A>=z||f&&(t<=y||u>=x))){w=!1;break}n+=c;f&&(q=n*f,t-=C/2);0>n&&(h="n",n=0);break;case "ne":if(f){if(0>=c&&(r<=v||u>=x)){w=!1;break}n-=c;r+=c;q=n*f}else 0<=a?u<x?q+=a:0>=c&&r<=v&&(w=!1):q+=a,0>=c?
r>v&&(n-=c,r+=c):(n-=c,r+=c);0>q&&0>n?(h="sw",n=0,q=0):0>q?(h="nw",q=0):0>n&&(h="se",n=0);break;case "nw":if(f){if(0>=c&&(r<=v||t<=y)){w=!1;break}n-=c;r+=c;q=n*f;t+=C}else 0>=a?t>y?(q-=a,t+=a):0>=c&&r<=v&&(w=!1):(q-=a,t+=a),0>=c?r>v&&(n-=c,r+=c):(n-=c,r+=c);0>q&&0>n?(h="se",n=0,q=0):0>q?(h="ne",q=0):0>n&&(h="sw",n=0);break;case "sw":if(f){if(0>=a&&(t<=y||A>=z)){w=!1;break}q-=a;t+=a;n=q/f}else 0>=a?t>y?(q-=a,t+=a):0<=c&&A>=z&&(w=!1):(q-=a,t+=a),0<=c?A<z&&(n+=c):n+=c;0>q&&0>n?(h="ne",n=0,q=0):0>q?(h=
"se",q=0):0>n&&(h="nw",n=0);break;case "se":if(f){if(0<=a&&(u>=x||A>=z)){w=!1;break}q+=a;n=q/f}else 0<=a?u<x?q+=a:0<=c&&A>=z&&(w=!1):q+=a,0<=c?A<z&&(n+=c):n+=c;0>q&&0>n?(h="nw",n=0,q=0):0>q?(h="sw",q=0):0>n&&(h="ne",n=0);break;case "move":this.move(a,c);w=!1;break;case "zoom":this.zoom(function(a,c,d,b){a=Math.sqrt(a*a+c*c);return(Math.sqrt(d*d+b*b)-a)/a}(Math.abs(this.startX-this.startX2),Math.abs(this.startY-this.startY2),Math.abs(this.endX-this.endX2),Math.abs(this.endY-this.endY2)),d);this.startX2=
this.endX2;this.startY2=this.endY2;w=!1;break;case "crop":a&&c?(B=b.getOffset(this.cropper),t=this.startX-B.left,r=this.startY-B.top,q=e.minWidth,n=e.minHeight,0<a?h=0<c?"se":"ne":0>a&&(t-=q,h=0<c?"sw":"nw"),0>c&&(r-=n),this.cropped||(b.removeClass(this.cropBox,"cropper-hidden"),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))):w=!1}w&&(e.width=q,e.height=n,e.left=t,e.top=r,this.action=h,this.renderCropBox());this.startX=this.endX;this.startY=this.endY}}},function(h,f,e){function b(d){if(Array.isArray(d)){for(var a=
0,c=Array(d.length);a<d.length;a++)c[a]=d[a];return c}return Array.from(d)}Object.defineProperty(f,"__esModule",{value:!0});var g=function(d){if(d&&d.__esModule)return d;var a={};if(null!=d)for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c]);return a["default"]=d,a}(e(4));f["default"]={crop:function(){return this.ready&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&g.addClass(this.dragBox,"cropper-modal"),g.removeClass(this.cropBox,
"cropper-hidden")),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=g.extend({},this.initialImageData),this.canvasData=g.extend({},this.initialCanvasData),this.cropBoxData=g.extend({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(g.extend(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),
this.renderCanvas(),g.removeClass(this.dragBox,"cropper-modal"),g.addClass(this.cropBox,"cropper-hidden")),this},replace:function(d,a){return!this.disabled&&d&&(this.isImg&&(this.element.src=d),a?(this.url=d,this.image.src=d,this.ready&&(this.image2.src=d,g.each(this.previews,function(a){g.getByTag(a,"img")[0].src=d}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.load(d))),this},enable:function(){return this.ready&&(this.disabled=!1,g.removeClass(this.cropper,"cropper-disabled")),
this},disable:function(){return this.ready&&(this.disabled=!0,g.addClass(this.cropper,"cropper-disabled")),this},destroy:function(){var d=this.element,a=this.image;return this.loaded?(this.isImg&&this.replaced&&(d.src=this.originalUrl),this.unbuild(),g.removeClass(d,"cropper-hidden")):this.isImg?g.removeListener(d,"load",this.start):a&&g.removeChild(a),g.removeData(d,"cropper"),this},move:function(d,a){var c=this.canvasData;return this.moveTo(g.isUndefined(d)?d:c.left+Number(d),g.isUndefined(a)?a:
c.top+Number(a))},moveTo:function(d,a){var c=this.canvasData,b=!1;return g.isUndefined(a)&&(a=d),d=Number(d),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(g.isNumber(d)&&(c.left=d,b=!0),g.isNumber(a)&&(c.top=a,b=!0),b&&this.renderCanvas(!0)),this},zoom:function(d,a){var c=this.canvasData;return d=Number(d),d=0>d?1/(1-d):1+d,this.zoomTo(c.width*d/c.naturalWidth,a)},zoomTo:function(d,a){var c=this.options,b=this.canvasData,e=b.width,f=b.height,h=b.naturalWidth,n=b.naturalHeight,t=void 0,
r=void 0,u=void 0;if(d=Number(d),0<=d&&this.ready&&!this.disabled&&c.zoomable){if(t=h*d,c=n*d,!1===g.dispatchEvent(this.element,"zoom",{originalEvent:a,oldRatio:e/h,ratio:t/h}))return this;a?(r=g.getOffset(this.cropper),u=a.touches?g.getTouchesCenter(a.touches):{pageX:a.pageX,pageY:a.pageY},b.left-=(u.pageX-r.left-b.left)/e*(t-e),b.top-=(u.pageY-r.top-b.top)/f*(c-f)):(b.left-=(t-e)/2,b.top-=(c-f)/2);b.width=t;b.height=c;this.renderCanvas(!0)}return this},rotate:function(d){return this.rotateTo((this.imageData.rotate||
0)+Number(d))},rotateTo:function(d){return d=Number(d),g.isNumber(d)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=d%360,this.rotated=!0,this.renderCanvas(!0)),this},scale:function(d,a){var c=this.imageData,b=!1;return g.isUndefined(a)&&(a=d),d=Number(d),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(g.isNumber(d)&&(c.scaleX=d,b=!0),g.isNumber(a)&&(c.scaleY=a,b=!0),b&&this.renderImage(!0)),this},scaleX:function(d){var a=this.imageData.scaleY;return this.scale(d,
g.isNumber(a)?a:1)},scaleY:function(d){var a=this.imageData.scaleX;return this.scale(g.isNumber(a)?a:1,d)},getData:function(d){var a=this.options,c=this.imageData,b=this.canvasData,e=this.cropBoxData,f=void 0,h=void 0;return this.ready&&this.cropped?(h={x:e.left-b.left,y:e.top-b.top,width:e.width,height:e.height},f=c.width/c.naturalWidth,g.each(h,function(a,c){a/=f;h[c]=d?Math.round(a):a})):h={x:0,y:0,width:0,height:0},a.rotatable&&(h.rotate=c.rotate||0),a.scalable&&(h.scaleX=c.scaleX||1,h.scaleY=
c.scaleY||1),h},setData:function(d){var a=this.options,c=this.imageData,b=this.canvasData,e={},f=void 0,h=void 0,n=void 0;return g.isFunction(d)&&(d=d.call(this.element)),this.ready&&!this.disabled&&g.isPlainObject(d)&&(a.rotatable&&g.isNumber(d.rotate)&&d.rotate!==c.rotate&&(c.rotate=d.rotate,this.rotated=f=!0),a.scalable&&(g.isNumber(d.scaleX)&&d.scaleX!==c.scaleX&&(c.scaleX=d.scaleX,h=!0),g.isNumber(d.scaleY)&&d.scaleY!==c.scaleY&&(c.scaleY=d.scaleY,h=!0)),f?this.renderCanvas():h&&this.renderImage(),
n=c.width/c.naturalWidth,g.isNumber(d.x)&&(e.left=d.x*n+b.left),g.isNumber(d.y)&&(e.top=d.y*n+b.top),g.isNumber(d.width)&&(e.width=d.width*n),g.isNumber(d.height)&&(e.height=d.height*n),this.setCropBoxData(e)),this},getContainerData:function(){return this.ready?this.containerData:{}},getImageData:function(){return this.loaded?this.imageData:{}},getCanvasData:function(){var d=this.canvasData,a={};return this.ready&&g.each("left top width height naturalWidth naturalHeight".split(" "),function(c){a[c]=
d[c]}),a},setCanvasData:function(d){var a=this.canvasData,c=a.aspectRatio;return g.isFunction(d)&&(d=d.call(this.element)),this.ready&&!this.disabled&&g.isPlainObject(d)&&(g.isNumber(d.left)&&(a.left=d.left),g.isNumber(d.top)&&(a.top=d.top),g.isNumber(d.width)?(a.width=d.width,a.height=d.width/c):g.isNumber(d.height)&&(a.height=d.height,a.width=d.height*c),this.renderCanvas(!0)),this},getCropBoxData:function(){var d=this.cropBoxData,a=void 0;return this.ready&&this.cropped&&(a={left:d.left,top:d.top,
width:d.width,height:d.height}),a||{}},setCropBoxData:function(d){var a=this.cropBoxData,c=this.options.aspectRatio,b=void 0,e=void 0;return g.isFunction(d)&&(d=d.call(this.element)),this.ready&&this.cropped&&!this.disabled&&g.isPlainObject(d)&&(g.isNumber(d.left)&&(a.left=d.left),g.isNumber(d.top)&&(a.top=d.top),g.isNumber(d.width)&&(b=!0,a.width=d.width),g.isNumber(d.height)&&(e=!0,a.height=d.height),c&&(b?a.height=a.width/c:e&&(a.width=a.height*c)),this.renderCropBox()),this},getCroppedCanvas:function(d){if(!this.ready||
!window.HTMLCanvasElement)return null;if(!this.cropped)return g.getSourceCanvas(this.image,this.imageData);g.isPlainObject(d)||(d={});var a=this.getData(),c=a.width,e=a.height,f=c/e,h=void 0,q=void 0,n=void 0;g.isPlainObject(d)&&(h=d.width,q=d.height,h?(q=h/f,n=h/c):q&&(h=q*f,n=q/e));var h=Math.floor(h||c),t=Math.floor(q||e),q=g.createElement("canvas"),f=q.getContext("2d");q.width=h;q.height=t;d.fillColor&&(f.fillStyle=d.fillColor,f.fillRect(0,0,h,t));t=g.getSourceCanvas(this.image,this.imageData);
d=t.width;var h=t.height,r=this.canvasData,u=[t],t=a.x+r.naturalWidth*(Math.abs(a.scaleX||1)-1)/2,a=a.y+r.naturalHeight*(Math.abs(a.scaleY||1)-1)/2,A=r=void 0,y=void 0,v=void 0,x=void 0,z=void 0,c=(t<=-c||t>d?t=r=y=x=0:0>=t?(y=-t,t=0,r=x=Math.min(d,c+t)):t<=d&&(y=0,r=x=Math.min(c,d-t)),0>=r||a<=-e||a>h?a=A=v=z=0:0>=a?(v=-a,a=0,A=z=Math.min(h,e+a)):a<=h&&(v=0,A=z=Math.min(e,h-a)),u.push(Math.floor(t),Math.floor(a),Math.floor(r),Math.floor(A)),n&&(y*=n,v*=n,x*=n,z*=n),0<x&&0<z&&u.push(Math.floor(y),
Math.floor(v),Math.floor(x),Math.floor(z)),u);return f.drawImage.apply(f,b(c)),q},setAspectRatio:function(d){var a=this.options;return this.disabled||g.isUndefined(d)||(a.aspectRatio=Math.max(0,d)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(d){var a=this.options,c=this.dragBox,b=this.face,e=void 0,f=void 0;return this.loaded&&!this.disabled&&(e="crop"===d,f=a.movable&&"move"===d,d=e||f?d:"none",g.setData(c,"action",d),g.toggleClass(c,"cropper-crop",
e),g.toggleClass(c,"cropper-move",f),a.cropBoxMovable||(g.setData(b,"action",d),g.toggleClass(b,"cropper-crop",e),g.toggleClass(b,"cropper-move",f))),this}}}])});
eval(function(h,f,e,b,g,d){g=function(a){return(a<f?"":g(parseInt(a/f)))+(35<(a%=f)?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){for(;e--;)d[g(e)]=b[e]||g(e);b=[function(a){return d[a]}];g=function(){return"\\w+"};e=1}for(;e--;)b[e]&&(h=h.replace(new RegExp("\\b"+g(e)+"\\b","g"),b[e]));return h}('(A(){M $,4K,2k,2b,D,54,3S,1X,2Q,6B,R,2N,4V,39,1Y,3L,28,2w,1P,7V,32,1v,fs,6y,7Z,5f,9y,6s=[].fb||A(bS){W(M i=0,l=o.P;i<l;i++){B(i 5h o&&o[i]===bS)u i}u-1},5W=[].5f,74={}.f2,9x=A(fn,cH){u A(){u fn.4r(cH,1l)}},cM=A(6e,6h){W(M 2t 5h 6h){B(74.1w(6h,2t))6e[2t]=6h[2t]}A 9b(){o.eU=6e}9b.N=6h.N;6e.N=1y 9b();6e.eT=6h.N;u 6e};7Z=[\'aN\',\'97\'];3L=(A(){A 3L(){}3L["dc"]=A(2C){M 2t,4q,K;W(2t 5h 2C){4q=2C[2t];B(6s.1w(7Z,2t)<0){o[2t]=4q}}B((K=2C.aN)!=L){K.4r(o)}u o};3L.eP=A(2C){M 2t,4q,K;W(2t 5h 2C){4q=2C[2t];B(6s.1w(7Z,2t)<0){o.N[2t]=4q}}B((K=2C.97)!=L){K.4r(o)}u o};3L.eO=A(){M 1k,7q,38,H,1n,1o;1k=1<=1l.P?5W.1w(1l,0):[];38=1k.6o();1o=[];W(H=0,1n=1k.P;H<1n;H++){7q=1k[H];1o.2j(o.N[7q]=38.N[7q])}u 1o};3L.eJ=A(3N,4M){M 1D=o;u o.N[3N]=A(){M 1k;1k=1<=1l.P?5W.1w(1l,0):[];u 1D.N[4M].4r(1D,1k)}};3L.eH=A(3N,4M){u bc.eF(o.N,3N,{4i:A(){u o[4M]},eE:A(2f){u o[4M]=2f}})};3L.97=A(5j){u 5j.1w(o,o.N)};u 3L})();5f=5T.N.5f;$=A(7A,7C){B(7C==L){7C=2p}B(1r 7A==="44"||(1r 2g!=="42"&&2g!==L)){u 7A}u 7C.ei(7A)};1v=(A(){A 1v(){}1v.8Z=(A(){M 2X;2X=0;u{4i:A(){u 2X++}}})();1v.7N=A(){M 6C,7T,2C,6E,1G,H,1n;2C=1l[0],1G=2<=1l.P?5W.1w(1l,1):[];7T=2C;W(H=0,1n=1G.P;H<1n;H++){6C=1G[H];W(6E 5h 6C){B(!74.1w(6C,6E))5I;7T[6E]=6C[6E]}}u 7T};1v.3H=A(2f){B(2f<0){u 0}B(2f>E){u E}u 2f};1v.5H=A(4M,3N,G){M 6l,H,1n,K,3T,1o;B(G==L){G={}}K=4M.e6;1o=[];W(H=0,1n=K.P;H<1n;H++){6l=K[H];B((G.8W!=L)&&(3T=6l.9U,6s.1w(G.8W,3T)>=0)){5I}1o.2j(3N.cR(6l.9U,6l.dd))}u 1o};1v.6F=A(P){B(P==L){P=0}B(D.2O||(4N.cC!=L)){u 1y cC(P)}u 1y 5T(P)};u 1v})();B(1r 2g!=="42"&&2g!==L){7V=2g;3S=6x(\'I\');4V=3S.4V;6B=6x(\'eQ\');fs=6x(\'fs\');6y=6x(\'6y\')}S{7V=4N}D=(A(cv){cM(D,cv);D.9w={ct:"4.1.2",cs:"7/27/de"};D.co=2r;D.6r=31;D.9t="cm";D.8t="";D.ck="df";D.2O=1r 2g!=="42"&&2g!==L;D.ci=!D.2O;D.65=A(){u"dg "+D.9w.ct+", dh "+D.9w.cs};D.9m=A(I){B(D.2O){u 31}B(1r I==="3j"){I=$(I)}B(!((I!=L)&&(I.6c!=L))){u L}u I.6c(\'29-3E-2X\')};A D(){o.6d=9x(o.6d,o);M 1k,1N,2X,1D=o;B(1l.P===0){2V"6i 1l";}B(o bY D){o.6k=o.6k.98(o);o.6H=o.6H.98(o);1k=1l[0];B(!D.2O){2X=49(D.9m(1k[0]),10);1N=1r 1k[1]==="A"?1k[1]:1r 1k[2]==="A"?1k[2]:A(){};B(!bQ(2X)&&32.bP(2X)){u 32.3O(2X,1N)}}o.2X=1v.8Z.4i();o.7D=o.5g=L;o.6z={x:0,y:0};o.bH=2r;o.7R=2r;o.6D=[];o.8S=[];o.8P=[];o.6N=L;o.bl=2r;o.du=1y 4K(o);o.4S=1y 1P(o);o.bi(A(){1D.bh(1k);u 1D.bg()});u o}S{u 1y D(1l)}}D.N.bi=A(cb){M 8H,1D=o;B(D.2O){u 8q(A(){u cb.1w(1D)},0)}S{B(2p.9q==="8D"){1Y.2x("aU aT");u 8q(A(){u cb.1w(1D)},0)}S{8H=A(){B(2p.9q==="8D"){1Y.2x("aU aT");u cb.1w(1D)}};u 2p.aS("dE",8H,2r)}}};D.N.bh=A(1k){M 2t,2f,K,1o;B(1k.P===0){2V"6i 1l aQ";}o.3b=L;o.8A=L;o.8z=L;o.1N=A(){};o.aM(1k[0]);B(1k.P===1){u}61(1r 1k[1]){2i"3j":o.8z=1k[1];4Z;2i"A":o.1N=1k[1]}B(1k.P===2){u}o.1N=1k[2];B(1k.P===4){K=1k[4];1o=[];W(2t 5h K){B(!74.1w(K,2t))5I;2f=K[2t];1o.2j(o.1F[2t]=2f)}u 1o}};D.N.aM=A(2C){B(D.2O){o.3b=2C;o.8A=\'ay\';u}B(1r 2C==="44"){o.3b=2C}S{o.3b=$(2C)}B(o.3b==L){2V"dN dO dV 1f d3 I W dX.";}u o.8A=o.3b.9U.6P()};D.N.bg=A(){61(o.8A){2i"ay":u o.cN();2i"1K":u o.cE();2i"I":u o.cx()}};D.N.cN=A(){1Y.2x("e8 W 2O");B(1r o.3b==="3j"&&o.3b.7W(/^ch?:\\/\\//)){u o.cf(o.3b,o.6d)}S B(1r o.3b==="3j"){u fs.eb(o.3b,o.6d)}S{u o.6d(L,o.3b)}};D.N.cf=A(6u,1N){M 9z;1Y.2x("fj 1f 4M "+6u);9z=6y.4i(6u,A(4p){M 7O;7O=\'\';4p.fk(\'aP\');4p.9B(\'29\',A(at){u 7O+=at});u 4p.9B(\'1Q\',A(){u 1N(L,1y fp(7O,\'aP\'))})});u 9z.9B(\'9C\',1N)};D.N.6d=A(6G,29){B(6G){2V 6G;}o.1f=1y 4V();o.1f.1G=29;1Y.2x("4V cS. cD = "+(o.5b())+", cy = "+(o.4W()));o.I=1y 3S(o.5b(),o.4W());u o.6k()};D.N.cE=A(){o.1f=o.3b;o.I=2p.3K(\'I\');o.1i=o.I.3h(\'2d\');1v.5H(o.1f,o.I,{8W:[\'1G\']});B(o.1f.7c!=L){o.1f.7c.9D(o.I,o.1f)}o.9J();u o.9L()};D.N.cx=A(){o.I=o.3b;o.1i=o.I.3h(\'2d\');B(o.8z!=L){o.1f=2p.3K(\'1K\');o.1f.1G=o.8z;o.9J();u o.9L()}S{u o.6k()}};D.N.9J=A(){B(o.9M()){1Y.2x(o.1f.1G,"->",o.8m());o.bd=31;o.1f.1G=o.8m()}B(2N.bb(o.1f)){o.1f.1G=2N.57(o.1f.1G);u 1Y.2x("fu 1f fx, fD cQ = "+o.1f.1G)}};D.N.9L=A(){B(o.cB()){u o.6H()}S{u o.1f.cr=o.6H}};D.N.cB=A(){B(!o.1f.8D){u 2r}B((o.1f.9P!=L)&&o.1f.9P===0){u 2r}u 31};D.N.5b=A(){u o.1f.F||o.1f.9P};D.N.4W=A(){u o.1f.J||o.1f.fN};D.N.6H=A(){1Y.2x("4V cS. cD = "+(o.5b())+", cy = "+(o.4W()));B(o.bd){o.I.F=o.5b()/o.7G();o.I.J=o.4W()/o.7G()}S{o.I.F=o.5b();o.I.J=o.4W()}u o.6k()};D.N.6k=A(){M i,1u,H,1n,K;B(o.1i==L){o.1i=o.I.3h(\'2d\')}o.51=o.6W=o.F=o.I.F;o.5D=o.6Y=o.J=o.I.J;o.d9();B(!o.c7()){o.c6()}B(o.1f!=L){o.1i.5U(o.1f,0,0,o.5b(),o.4W(),0,0,o.6W,o.6Y)}o.2y=o.1i.48(0,0,o.I.F,o.I.J);o.T=o.2y.29;B(D.6r){o.7D=1v.6F(o.T.P);o.5g=1v.6F(o.T.P);K=o.T;W(i=H=0,1n=K.P;H<1n;i=++H){1u=K[i];o.7D[i]=1u;o.5g[i]=1u}}o.1d={F:o.I.F,J:o.I.J};B(!D.2O){32.c4(o.2X,o)}o.1N.1w(o,o);u o.1N=A(){}};D.N.c1=A(){o.2y=o.1i.48(0,0,o.I.F,o.I.J);u o.T=o.2y.29};D.N.g3=A(){M i,1u,H,1n,K,1o;B(!D.6r){2V"a0 7F";}o.5g=1v.6F(o.T.P);K=o.T;1o=[];W(i=H=0,1n=K.P;H<1n;i=++H){1u=K[i];1o.2j(o.5g[i]=1u)}u 1o};D.N.c7=A(){u D.9m(o.I)!=L};D.N.c6=A(){B(D.2O||o.I.6c(\'29-3E-2X\')){u}u o.I.cR(\'29-3E-2X\',o.2X)};D.N.aE=A(){u o.I.6c(\'29-3E-cO-7F\')!==L};D.N.d9=A(){M 4d;B(D.2O||!o.9M()){u}4d=o.7G();B(4d!==1){1Y.2x("g4 4d = "+4d);o.bl=31;o.6W=o.I.F;o.6Y=o.I.J;o.I.F=o.6W*4d;o.I.J=o.6Y*4d;o.I.c8.F=""+o.6W+"c5";o.I.c8.J=""+o.6Y+"c5";o.1i.g6(4d,4d);o.F=o.51=o.I.F;u o.J=o.5D=o.I.J}};D.N.7G=A(){M a3,4j;4j=4N.4j||1;a3=o.1i.g7||o.1i.gi||o.1i.gk||o.1i.gm||o.1i.go||1;u 4j/a3};D.N.aZ=A(){u(4N.4j!=L)&&4N.4j!==1};D.N.9M=A(){B(o.aE()||!o.aZ()){u 2r}u o.8m()!==L};D.N.8m=A(){B(o.1f==L){u L}u o.1f.6c(\'29-3E-cO\')};D.N.73=A(aD){M 7z;7z=o.I;o.I=aD;o.1i=o.I.3h(\'2d\');B(!D.2O){7z.7c.9D(o.I,7z)}o.F=o.I.F;o.J=o.I.J;o.c1();u o.1d={F:o.I.F,J:o.I.J}};D.N.a8=A(1N){M 1D=o;B(1N==L){1N=A(){}}2Q.4Y(o,"aX");u o.4S.3O(A(){1D.1i.7x(1D.2y,0,0);u 1N.1w(1D)})};D.N.gu=A(8e){M i,1u,H,1n,K;B(8e==L){8e=31}B(!D.6r){2V"a0 7F";}K=o.d2();W(i=H=0,1n=K.P;H<1n;i=++H){1u=K[i];o.T[i]=1u}B(8e){u o.1i.7x(o.2y,0,0)}};D.N.gt=A(){M I,1W,i,2y,1u,T,H,1n,K;I=2p.3K(\'I\');1v.5H(o.I,I);I.F=o.51;I.J=o.5D;1W=I.3h(\'2d\');2y=1W.48(0,0,I.F,I.J);T=2y.29;K=o.7D;W(i=H=0,1n=K.P;H<1n;i=++H){1u=K[i];T[i]=1u}1W.7x(2y,0,0);o.6z={x:0,y:0};o.7R=2r;u o.73(I)};D.N.d2=A(){M I,7E,1W,26,a6,i,2y,1u,T,Y,72,8k,8w,F,H,1e,1n,K,3T,4o,a5;B(!D.6r){2V"a0 7F";}Y=[];8k=o.6z.x;26=8k+o.F;8w=o.6z.y;a6=8w+o.J;B(o.7R){I=2p.3K(\'I\');I.F=o.51;I.J=o.5D;1W=I.3h(\'2d\');2y=1W.48(0,0,I.F,I.J);T=2y.29;K=o.5g;W(i=H=0,1n=K.P;H<1n;i=++H){1u=K[i];T[i]=1u}1W.7x(2y,0,0);72=2p.3K(\'I\');72.F=o.F;72.J=o.J;1W=72.3h(\'2d\');1W.5U(I,0,0,o.51,o.5D,0,0,o.F,o.J);T=1W.48(0,0,o.F,o.J).29;F=o.F}S{T=o.5g;F=o.51}W(i=1e=0,3T=T.P;1e<3T;i=1e+=4){7E=28.cl(i,F);B(((8k<=(4o=7E.x)&&4o<26))&&((8w<=(a5=7E.y)&&a5<a6))){Y.2j(T[i],T[i+1],T[i+2],T[i+3])}}u Y};D.N.2m=A(1q,7n){o.4S.4k({1t:R.3g.a2,1q:1q,7n:7n});u o};D.N.3I=A(1q,Q,2K,3e){M i,H,K;B(2K==L){2K=L}B(3e==L){3e=0}B(2K==L){2K=0;W(i=H=0,K=Q.P;0<=K?H<K:H>K;i=0<=K?++H:--H){2K+=Q[i]}}o.4S.4k({1t:R.3g.a1,1q:1q,Q:Q,2K:2K,3e:3e});u o};D.N.5a=A(4b,1k){o.4S.4k({1t:R.3g.2w,4b:4b,1k:1k});u o};D.N.2Z=A(1N){M 2a;2a=1y 39(o);o.8P.2j(2a);o.4S.4k({1t:R.3g.9Z});1N.1w(2a);o.4S.4k({1t:R.3g.9Y});u o};D.N.bm=A(2a){u o.bn(2a)};D.N.bn=A(2a){o.8S.2j(o.6N);o.6D.2j(o.T);o.6N=2a;u o.T=2a.T};D.N.bx=A(){o.T=o.6D.6o();u o.6N=o.8S.6o()};D.N.bO=A(){u o.6N.bU()};u D})(3L);7V.D=D;D.4K=(A(){A 4K(c){o.c=c}4K.N.fX=A(){M i,3B,71,H,1e,1I,K;3B={r:{},g:{},b:{}};W(i=H=0;H<=E;i=++H){3B.r[i]=0;3B.g[i]=0;3B.b[i]=0}W(i=1e=0,K=o.c.T.P;1e<K;i=1e+=4){3B.r[o.c.T[i]]++;3B.g[o.c.T[i+1]]++;3B.b[o.c.T[i+2]]++}71=o.c.T.P/4;W(i=1I=0;1I<=E;i=++1I){3B.r[i]/=71;3B.g[i]/=71;3B.b[i]/=71}u 3B};u 4K})();4K=D.4K;D.9X=A(){M 1K,6Z,cA,H,1n,1o;6Z=2p.fU("1K[29-3E]");B(!(6Z.P>0)){u}1o=[];W(H=0,1n=6Z.P;H<1n;H++){1K=6Z[H];1o.2j(cA=1y 54(1K,A(){o.cI();u o.3O()}))}u 1o};B(D.ci){(A(){B(2p.9q==="8D"){u D.9X()}S{u 2p.aS("fT",D.9X,2r)}})()}54=(A(){M 8g;8g="(\\\\w+)\\\\((.*?)\\\\)";A 54(46,db){o.ab=46.6c(\'29-3E\');o.3E=D(46,db.98(o))}54.N.cI=A(){M 1k,e,1C,5j,9W,9V,m,r,6X,H,1n,K,1o;o.46=o.3E.I;r=1y bf(8g,\'g\');6X=o.ab.7W(r);B(!(6X.P>0)){u}r=1y bf(8g);1o=[];W(H=0,1n=6X.P;H<1n;H++){9W=6X[H];K=9W.7W(r),m=K[0],1C=K[1],1k=K[2];9V=1y fO("u A() {        o."+1C+"("+1k+");      };");9S{5j=9V();1o.2j(5j.1w(o.3E))}9R(5C){e=5C;1o.2j(1Y.2x(e))}}u 1o};54.N.3O=A(){M 46;46=o.46;u o.3E.a8(A(){u 46.7c.9D(o.bJ(),46)})};u 54})();D.2k=(A(){A 2k(){}2k.9Q={};2k.V=A(1q,5j){u o.9Q[1q]=5j};2k.3O=A(1q,Z,X){u o.9Q[1q](Z,X)};u 2k})();2k=D.2k;D.2b=(A(){A 2b(){}2b.52=A(6U,6S,6R,6Q){u O.7L(O.1T(6R-6U,2)+O.1T(6Q-6S,2))};2b.ce=A(1M,1c,6M){M 4s;B(6M==L){6M=2r}4s=1M+(O.fL()*(1c-1M));B(6M){u 4s.fH(6M)}S{u O.62(4s)}};2b.6L=A(C){u(0.9O*C.r)+(0.fF*C.g)+(0.fE*C.b)};2b.2h=A(1J,4H,4G,1Q,58,59){M 2h,5r,2F,26,i,j,5s,1S,3G,t,H,1e,K;B(58==L){58=0}B(59==L){59=E}B(1J[0]bY 5T){2F=1J;58=4H;59=4G}S{2F=[1J,4H,4G,1Q]}B(2F.P<2){2V"6i 8s 9K 1l 3N 2h";}2h={};5s=A(a,b,t){u a*(1-t)+b*t};5r=A(a,1M,1c){u O.1M(O.1c(a,1M),1c)};W(i=H=0;H<bI;i=++H){t=i/bI;3G=2F;9I(3G.P>1){1S=[];W(j=1e=0,K=3G.P-2;0<=K?1e<=K:1e>=K;j=0<=K?++1e:--1e){1S.2j([5s(3G[j][0],3G[j+1][0],t),5s(3G[j][1],3G[j+1][1],t)])}3G=1S}2h[O.62(3G[0][0])]=O.62(5r(3G[0][1],58,59))}26=2F[2F.P-1][0];2h=D.2b.9H(2h,26);B(2h[26]==L){2h[26]=2h[26-1]}u 2h};2b.bR=A(2F,58,59){M 4k,5r,9G,26,8C,76,77,78,i,j,5s,9F,9E,4A,p,5A,5B,4u,7g,7i,3p,7k,t,H,1e,K,1D=o;B(2F.P<2){2V"6i 8s 9K 1l 3N bR";}3p={};5s=A(a,b,t){u a*(1-t)+b*t};4k=A(a,b,c,d){u[a[0]+b[0]+c[0]+d[0],a[1]+b[1]+c[1]+d[1]]};4A=A(a,b){u[a[0]*b[0],a[1]*b[1]]};7k=A(a,b){u[a[0]-b[0],a[1]-b[1]]};5r=A(a,1M,1c){u O.1M(O.1c(a,1M),1c)};9G=0;W(i=H=0,K=2F.P-2;0<=K?H<=K:H>=K;i=0<=K?++H:--H){5A=2F[i];5B=2F[i+1];4u=5B[0]-5A[0];7g=1/4u;B(i===2F.P-2){7g=1/(4u-1)}p=i>0?2F[i-1]:5A;9F=4A(7k(5B,p),[0.5,0.5]);p=i<2F.P-2?2F[i+2]:5B;9E=4A(7k(p,5A),[0.5,0.5]);W(j=1e=0;0<=4u?1e<=4u:1e>=4u;j=0<=4u?++1e:--1e){t=j*7g;8C=2.0*t*t*t-3.0*t*t+1.0;76=t*t*t-2.0*t*t+t;77=-2.0*t*t*t+3.0*t*t;78=t*t*t-t*t;7i=4k(4A(5A,[8C,8C]),4A(9F,[76,76]),4A(5B,[77,77]),4A(9E,[78,78]));3p[O.62(7i[0])]=O.62(5r(7i[1],58,59));9G+=1}}26=2F[2F.P-1][0];3p=D.2b.9H(3p,26);u 3p};2b.9H=A(5c,26){M i,j,5F,3p,7s,H,1e;B(bc.ft(5c).P<26+1){3p={};W(i=H=0;0<=26?H<=26:H>=26;i=0<=26?++H:--H){B(5c[i]!=L){3p[i]=5c[i]}S{5F=[i-1,3p[i-1]];W(j=1e=i;i<=26?1e<=26:1e>=26;j=i<=26?++1e:--1e){B(5c[j]!=L){7s=[j,5c[j]];4Z}}3p[i]=5F[1]+((7s[1]-5F[1])/(7s[0]-5F[0]))*(i-5F[0])}}u 3p}u 5c};u 2b})();2b=D.2b;D.1X=(A(){A 1X(){}1X.7u=A(3F){M b,g,r;B(3F.fr(0)==="#"){3F=3F.5d(1)}r=49(3F.5d(0,2),16);g=49(3F.5d(2,2),16);b=49(3F.5d(4,2),16);u{r:r,g:g,b:b}};1X.fq=A(r,g,b){M d,h,l,1c,1M,s;B(1r r==="44"){g=r.g;b=r.b;r=r.r}r/=E;g/=E;b/=E;1c=O.1c(r,g,b);1M=O.1M(r,g,b);l=(1c+1M)/2;B(1c===1M){h=s=0}S{d=1c-1M;s=l>0.5?d/(2-1c-1M):d/(1c+1M);h=(A(){61(1c){2i r:u(g-b)/d+(g<b?6:0);2i g:u(b-r)/d+2;2i b:u(r-g)/d+4}})();h/=6}u{h:h,s:s,l:l}};1X.fm=A(h,s,l){M b,g,p,q,r;B(1r h==="44"){s=h.s;l=h.l;h=h.h}B(s===0){r=g=b=l}S{q=l<0.5?l*(1+s):l+s-l*s;p=2*l-q;r=o.7I(p,q,h+1/3);g=o.7I(p,q,h);b=o.7I(p,q,h-1/3)}u{r:r*E,g:g*E,b:b*E}};1X.7I=A(p,q,t){B(t<0){t+=1}B(t>1){t-=1}B(t<1/6){u p+(q-p)*6*t}B(t<1/2){u q}B(t<2/3){u p+(q-p)*(2/3-t)*6}u p};1X.aL=A(r,g,b){M d,h,1c,1M,s,v;r/=E;g/=E;b/=E;1c=O.1c(r,g,b);1M=O.1M(r,g,b);v=1c;d=1c-1M;s=1c===0?0:d/1c;B(1c===1M){h=0}S{h=(A(){61(1c){2i r:u(g-b)/d+(g<b?6:0);2i g:u(b-r)/d+2;2i b:u(r-g)/d+4}})();h/=6}u{h:h,s:s,v:v}};1X.aW=A(h,s,v){M b,f,g,i,p,q,r,t;i=O.2P(h*6);f=h*6-i;p=v*(1-s);q=v*(1-f*s);t=v*(1-(1-f)*s);61(i%6){2i 0:r=v;g=t;b=p;4Z;2i 1:r=q;g=v;b=p;4Z;2i 2:r=p;g=v;b=t;4Z;2i 3:r=p;g=q;b=v;4Z;2i 4:r=t;g=p;b=v;4Z;2i 5:r=v;g=p;b=q}u{r:O.2P(r*E),g:O.2P(g*E),b:O.2P(b*E)}};1X.b1=A(r,g,b){M x,y,z;r/=E;g/=E;b/=E;B(r>0.9A){r=O.1T((r+0.3n)/1.3n,2.4)}S{r/=12.92}B(g>0.9A){g=O.1T((g+0.3n)/1.3n,2.4)}S{g/=12.92}B(b>0.9A){b=O.1T((b+0.3n)/1.3n,2.4)}S{b/=12.92}x=r*0.fi+g*0.fh+b*0.fg;y=r*0.bp+g*0.bs+b*0.bv;z=r*0.ff+g*0.fe+b*0.fd;u{x:x*1j,y:y*1j,z:z*1j}};1X.fc=A(x,y,z){M b,g,r;x/=1j;y/=1j;z/=1j;r=(3.fa*x)+(-1.f9*y)+(-0.f8*z);g=(-0.f7*x)+(1.f6*y)+(0.f5*z);b=(0.f4*x)+(-0.f3*y)+(1.f1*z);B(r>0.9v){r=(1.3n*O.1T(r,0.9u))-0.3n}S{r*=12.92}B(g>0.9v){g=(1.3n*O.1T(g,0.9u))-0.3n}S{g*=12.92}B(b>0.9v){b=(1.3n*O.1T(b,0.9u))-0.3n}S{b*=12.92}u{r:r*E,g:g*E,b:b*E}};1X.c9=A(x,y,z){M a,b,l,9s,9r,8E;B(1r x==="44"){y=x.y;z=x.z;x=x.x}9s=95.cn;9r=1j.0;8E=9n.cu;x/=9s;y/=9r;z/=8E;B(x>0.9l){x=O.1T(x,0.9k)}S{x=(7.9j*x)+0.69}B(y>0.9l){y=O.1T(y,0.9k)}S{y=(7.9j*y)+0.69}B(z>0.9l){z=O.1T(z,0.9k)}S{z=(7.9j*z)+0.69}l=cF*y-16;a=cG*(x-y);b=6a*(y-z);u{l:l,a:a,b:b}};1X.f0=A(l,a,b){M x,y,z;B(1r l==="44"){a=l.a;b=l.b;l=l.l}y=(l+16)/cF;x=y+(a/cG);z=y-(b/6a);B(x>0.9i){x=x*x*x}S{x=0.9h*(x-0.69)}B(y>0.9i){y=y*y*y}S{y=0.9h*(y-0.69)}B(z>0.9i){z=z*z*z}S{z=0.9h*(z-0.69)}u{x:x*95.cn,y:y*1j.0,z:z*9n.cu}};1X.eZ=A(r,g,b){M 9f;B(1r r==="44"){g=r.g;b=r.b;r=r.r}9f=o.b1(r,g,b);u o.c9(9f)};1X.eY=A(l,a,b){};u 1X})();1X=D.1X;D.2Q=(A(){A 2Q(){}2Q.5n={};2Q.cU=["cV","cW","aX","d0","d1","6g"];2Q.4Y=A(38,1t,29){M 6m,H,1n,K,1o;B(29==L){29=L}B(o.5n[1t]&&o.5n[1t].P){K=o.5n[1t];1o=[];W(H=0,1n=K.P;H<1n;H++){6m=K[H];B(6m.38===L||38.2X===6m.38.2X){1o.2j(6m.fn.1w(38,29))}S{1o.2j(da 0)}}u 1o}};2Q.eX=A(38,1t,fn){M 9e,9d;B(1r 38==="3j"){9d=38;9e=1t;38=L;1t=9d;fn=9e}B(6s.1w(o.cU,1t)<0){u 2r}B(!o.5n[1t]){o.5n[1t]=[]}o.5n[1t].2j({38:38,fn:fn});u 31};u 2Q})();2Q=D.2Q;D.R=(A(){A R(){}R.3g={a2:1,a1:2,9Z:3,9Y:4,9c:5,2w:6};R.V=A(1q,ah){u D.N[1q]=ah};u R})();R=D.R;D.2N=(A(){A 2N(){}2N.aq=/(?:(?:6y|ch):\\/\\/)((?:\\w+)\\.(?:(?:\\w|\\.)+))/;2N.bb=A(1K){B(1K==L){u 2r}B(o.as(1K)){u 2r}u o.7j(1K.1G)};2N.as=A(1K){M K;u(1K.9t!=L)&&((K=1K.9t.6P())===\'cm\'||K===\'ax-eW\')};2N.7j=A(6u){M 7l;7l=6u.7W(o.aq);B(7l){u 7l[1]!==2p.eV}S{u 2r}};2N.aK=A(1G){B(o.7j(1G)){B(!D.8t.P){1Y.99("eS 3N eR a aV 1f eN a eM aY. cQ: "+1G)}S{B(D.7j(D.8t)){1Y.99("eL ax a aV aY W eK eI.");u}u o.57(1G)}}};2N.57=A(1G){u""+D.8t+"?"+D.ck+"="+(eG(1G))};2N.eD=A(5k){M 7w;7w={eC:\'eB\',eA:\'ez\',ey:\'ex\',ew:\'ev\'};5k=5k.6P();B(7w[5k]!=L){5k=7w[5k]}u"eu/es."+5k};u 2N})();D.N.bB=A(){B(1r 2g!=="42"&&2g!==L){u o.bC.4r(o,1l)}S{u o.bD.4r(o,1l)}};D.N.bD=A(1t){M 1f;B(1t==L){1t="bG"}1t=1t.6P();1f=o.94(1t).er("1f/"+1t,"1f/eq-ep");u 2p.eo.en=1f};D.N.bC=A(5R,7J,1N){M e,91;B(7J==L){7J=31}B(1N==L){1N=L}9S{91=fs.em(5R);B(91.ek()&&!7J){u 2r}}9R(5C){e=5C;1Y.2x("ej eh 5R "+5R)}u fs.eg(5R,o.I.ef(),A(6G){1Y.2x("ee ed 3N "+5R);B(1N){u 1N.1w(o,6G)}})};D.N.bJ=A(1t){M 1K;1K=1y 4V();1K.1G=o.94(1t);1K.F=o.1d.F;1K.J=o.1d.J;B(4N.4j){1K.F/=4N.4j;1K.J/=4N.4j}u 1K};D.N.94=A(1t){B(1t==L){1t="bG"}1t=1t.6P();u o.I.ec("1f/"+1t)};2N=D.2N;D.39=(A(){A 39(c){o.c=c;o.1C=o.c;o.1F={8Y:\'8X\',2q:1.0};o.ea=1v.8Z.4i();o.I=1r 2g!=="42"&&2g!==L?1y 3S():2p.3K(\'I\');o.I.F=o.c.1d.F;o.I.J=o.c.1d.J;o.1i=o.I.3h(\'2d\');o.1i.e9(o.I.F,o.I.J);o.2y=o.1i.48(0,0,o.I.F,o.I.J);o.T=o.2y.29}39.N.2Z=A(cb){u o.c.2Z.1w(o.c,cb)};39.N.3q=A(cg){o.1F.8Y=cg;u o};39.N.2q=A(2q){o.1F.2q=2q/1j;u o};39.N.4n=A(){M i,2Y,H,K;2Y=o.c.T;W(i=H=0,K=o.c.T.P;H<K;i=H+=4){o.T[i]=2Y[i];o.T[i+1]=2Y[i+1];o.T[i+2]=2Y[i+2];o.T[i+3]=2Y[i+3]}u o};39.N.4B=A(){u o.c.4B.4r(o.c,1l)};39.N.e7=A(1f){B(1r 1f==="44"){1f=1f.1G}S B(1r 1f==="3j"&&1f[0]==="#"){1f=$(1f).1G}B(!1f){u o}o.c.4S.6I.2j({1t:R.3g.9c,1G:1f,2a:o});u o};39.N.bU=A(){M i,56,2Y,1E,Z,X,H,K,1o;2Y=o.c.6D[o.c.6D.P-1];56=o.c.T;1o=[];W(i=H=0,K=56.P;H<K;i=H+=4){X={r:2Y[i],g:2Y[i+1],b:2Y[i+2],a:2Y[i+3]};Z={r:56[i],g:56[i+1],b:56[i+2],a:56[i+3]};1E=2k.3O(o.1F.8Y,Z,X);1E.r=1v.3H(1E.r);1E.g=1v.3H(1E.g);1E.b=1v.3H(1E.b);B(1E.a==L){1E.a=Z.a}2Y[i]=X.r-((X.r-1E.r)*(o.1F.2q*(1E.a/E)));2Y[i+1]=X.g-((X.g-1E.g)*(o.1F.2q*(1E.a/E)));1o.2j(2Y[i+2]=X.b-((X.b-1E.b)*(o.1F.2q*(1E.a/E))))}u 1o};u 39})();39=D.39;D.82=(A(){A 82(){M 1q,H,1n,K;K=[\'cz\',\'99\',\'e5\',\'9C\'];W(H=0,1n=K.P;H<1n;H++){1q=K[H];o[1q]=(A(1q){u A(){M 1k,e;1k=1<=1l.P?5W.1w(1l,0):[];B(!D.co){u}9S{u 8V[1q].4r(8V,1k)}9R(5C){e=5C;u 8V[1q](1k)}}})(1q)}o.2x=o.cz}u 82})();1Y=1y D.82();D.28=(A(){28.8U=A(x,y,F){u(y*F+x)*4};28.cl=A(U,F){M x,y;y=O.2P(U/(F*4));x=(U%(F*4))/4;u{x:x,y:y}};A 28(r,g,b,a,c){o.r=r!=L?r:0;o.g=g!=L?g:0;o.b=b!=L?b:0;o.a=a!=L?a:E;o.c=c!=L?c:L;o.U=0}28.N.8T=A(c){u o.c=c};28.N.8R=A(){M x,y;B(o.c==L){2V"6b a 67 1i";}y=o.c.1d.J-O.2P(o.U/(o.c.1d.F*4));x=(o.U%(o.c.1d.F*4))/4;u{x:x,y:y}};28.N.8O=A(U){B(o.c==L){2V"6b a 67 1i";}u 1y 28(o.c.T[U],o.c.T[U+1],o.c.T[U+2],o.c.T[U+3],o.c)};28.N.cJ=A(8c,8d){M 3M;B(o.c==L){2V"6b a 67 1i";}3M=o.U+(o.c.1d.F*4*(8d*-1))+(4*8c);B(3M>o.c.T.P||3M<0){u 1y 28(0,0,0,E,o.c)}u o.8O(3M)};28.N.e4=A(8c,8d,C){M cP;B(o.c==L){2V"6b a 67 1i";}cP=o.U+(o.c.1d.F*4*(8d*-1))+(4*8c);B(3M>o.c.T.P||3M<0){u}o.c.T[3M]=C.r;o.c.T[3M+1]=C.g;o.c.T[3M+2]=C.b;o.c.T[3M+3]=C.a;u 31};28.N.e3=A(x,y){M U;B(o.c==L){2V"6b a 67 1i";}U=o.8U(x,y,o.F);u o.8O(U)};28.N.e2=A(x,y,C){M U;B(o.c==L){2V"6b a 67 1i";}U=o.8U(x,y,o.F);o.c.T[U]=C.r;o.c.T[U+1]=C.g;o.c.T[U+2]=C.b;u o.c.T[U+3]=C.a};28.N.65=A(){u o.e1()};28.N.e0=A(8f){M 3F;B(8f==L){8f=2r}3F=\'#\'+o.r.65(16)+o.g.65(16)+o.b.65(16);B(8f){u 3F+o.a.65(16)}S{u 3F}};u 28})();28=D.28;D.2w=(A(){A 2w(){}2w.8N={};2w.V=A(1q,4b){u o.8N[1q]=4b};2w.3O=A(1i,1q,1k){u o.8N[1q].4r(1i,1k)};u 2w})();2w=D.2w;D.1P=(A(){1P.4t=D.2O?6x(\'dZ\').dY().P:4;A 1P(c){o.c=c;o.4l=9x(o.4l,o);o.6I=[];o.53=L}1P.N.4k=A(8M){B(8M==L){u}u o.6I.2j(8M)};1P.N.4l=A(){M 2a;B(o.6I.P===0){2Q.4Y(o,"d0");B(o.8L!=L){o.8L.1w(o.c)}u o}o.2c=o.6I.d4();61(o.2c.1t){2i R.3g.9Z:2a=o.c.8P.d4();o.c.bm(2a);u o.4l();2i R.3g.9Y:o.c.bO();o.c.bx();u o.4l();2i R.3g.9c:u o.d5(o.2c.2a,o.2c.1G);2i R.3g.2w:u o.d6();dW:u o.d8()}};1P.N.3O=A(1N){o.8L=1N;o.53=1v.6F(o.c.T.P);u o.4l()};1P.N.8K=A(fn){M 6T,8J,2T,1Q,f,i,8I,n,1J,H,K,1o,1D=o;o.8p=0;n=o.c.T.P;8J=O.2P((n/4)/1P.4t);6T=8J*4;8I=6T+((n/4)%1P.4t)*4;1o=[];W(i=H=0,K=1P.4t;0<=K?H<K:H>K;i=0<=K?++H:--H){1J=i*6T;1Q=1J+(i===1P.4t-1?8I:6T);B(D.2O){f=6B(A(){u fn.1w(1D,i,1J,1Q)});2T=f.dU();1o.2j(o.6g(2T))}S{1o.2j(8q((A(i,1J,1Q){u A(){u fn.1w(1D,i,1J,1Q)}})(i,1J,1Q),0))}}u 1o};1P.N.d8=A(){2Q.4Y(o.c,"cV",o.2c);B(o.2c.1t===R.3g.a2){u o.8K(o.ae)}S{u o.8K(o.af)}};1P.N.d6=A(){1Y.2x("dT 4b "+o.2c.4b);2w.3O(o.c,o.2c.4b,o.2c.1k);1Y.2x("2w "+o.2c.4b+" 8G!");u o.4l()};1P.N.ae=A(2T,1J,1Q){M i,1u,H;1Y.2x("ai #"+2T+" - R: "+o.2c.1q+", dS: "+1J+", dR: "+1Q);2Q.4Y(o.c,"d1",{al:2T,am:1P.4t,dQ:1J,dP:1Q});1u=1y 28();1u.8T(o.c);W(i=H=1J;H<1Q;i=H+=4){1u.U=i;1u.r=o.c.T[i];1u.g=o.c.T[i+1];1u.b=o.c.T[i+2];1u.a=o.c.T[i+3];o.2c.7n(1u);o.c.T[i]=1v.3H(1u.r);o.c.T[i+1]=1v.3H(1u.g);o.c.T[i+2]=1v.3H(1u.b);o.c.T[i+3]=1v.3H(1u.a)}B(D.2O){u 6B["ap"](2T)}S{u o.6g(2T)}};1P.N.af=A(2T,1J,1Q){M Q,6V,3e,2U,5E,2K,i,j,k,2I,n,1q,p,1u,4p,H,1e,1I;1q=o.2c.1q;3e=o.2c.3e;2K=o.2c.2K;n=o.c.T.P;Q=o.2c.Q;6V=O.7L(Q.P);2I=[];1Y.2x("dM 2I - R: "+o.2c.1q);1J=O.1c(1J,o.c.1d.F*4*((6V-1)/2));1Q=O.1M(1Q,n-(o.c.1d.F*4*((6V-1)/2)));2U=(6V-1)/2;1u=1y 28();1u.8T(o.c);W(i=H=1J;H<1Q;i=H+=4){1u.U=i;5E=0;W(j=1e=-2U;-2U<=2U?1e<=2U:1e>=2U;j=-2U<=2U?++1e:--1e){W(k=1I=2U;2U<=-2U?1I<=-2U:1I>=-2U;k=2U<=-2U?++1I:--1I){p=1u.cJ(j,k);2I[5E*3]=p.r;2I[5E*3+1]=p.g;2I[5E*3+2]=p.b;5E++}}4p=o.3I(Q,2I,2K,3e);o.53[i]=1v.3H(4p.r);o.53[i+1]=1v.3H(4p.g);o.53[i+2]=1v.3H(4p.b);o.53[i+3]=o.c.T[i+3]}B(D.2O){u 6B["ap"](2T)}S{u o.6g(2T)}};1P.N.6g=A(2T){M i,H,K;B(2T>=0){1Y.2x("ai #"+2T+" 8G! R: "+o.2c.1q)}o.8p++;2Q.4Y(o.c,"6g",{al:2T,dL:o.8p,am:1P.4t});B(o.8p===1P.4t){B(o.2c.1t===R.3g.a1){W(i=H=0,K=o.c.T.P;0<=K?H<K:H>K;i=0<=K?++H:--H){o.c.T[i]=o.53[i]}}B(2T>=0){1Y.2x("R "+o.2c.1q+" 8G!")}2Q.4Y(o.c,"cW",o.2c);u o.4l()}};1P.N.3I=A(Q,2I,2K,3e){M i,2f,H,K;2f={r:0,g:0,b:0};W(i=H=0,K=Q.P;0<=K?H<K:H>K;i=0<=K?++H:--H){2f.r+=Q[i]*2I[i*3];2f.g+=Q[i]*2I[i*3+1];2f.b+=Q[i]*2I[i*3+2]}2f.r=(2f.r/2K)+3e;2f.g=(2f.g/2K)+3e;2f.b=(2f.b/2K)+3e;u 2f};1P.N.d5=A(2a,1G){M 1K,57,1D=o;1K=1y 4V();1K.cr=A(){2a.1i.5U(1K,0,0,1D.c.1d.F,1D.c.1d.J);2a.2y=2a.1i.48(0,0,1D.c.1d.F,1D.c.1d.J);2a.T=2a.2y.29;1D.c.T=2a.T;u 1D.4l()};57=2N.aK(1G);u 1K.1G=57!=L?57:1G};u 1P})();1P=D.1P;D.32=(A(){A 32(){}32.5p={};32.bP=A(4Q){u o.5p[4Q]!=L};32.4i=A(4Q){u o.5p[4Q]};32.c4=A(1q,2C){u o.5p[1q]=2C};32.3O=A(4Q,1N){M 1D=o;8q(A(){u 1N.1w(1D.4i(4Q),1D.4i(4Q))},0);u o.4i(4Q)};32.dK=A(1q){B(1q==L){1q=2r}B(1q){u aA o.5p[1q]}S{u o.5p={}}};u 32})();32=D.32;2k.V("8X",A(Z,X){u{r:Z.r,g:Z.g,b:Z.b}});2k.V("5o",A(Z,X){u{r:(Z.r*X.r)/E,g:(Z.g*X.g)/E,b:(Z.b*X.b)/E}});2k.V("dJ",A(Z,X){u{r:E-(((E-Z.r)*(E-X.r))/E),g:E-(((E-Z.g)*(E-X.g))/E),b:E-(((E-Z.b)*(E-X.b))/E)}});2k.V("8v",A(Z,X){M 1E;1E={};1E.r=X.r>1g?E-2*(E-Z.r)*(E-X.r)/E:(X.r*Z.r*2)/E;1E.g=X.g>1g?E-2*(E-Z.g)*(E-X.g)/E:(X.g*Z.g*2)/E;1E.b=X.b>1g?E-2*(E-Z.b)*(E-X.b)/E:(X.b*Z.b*2)/E;u 1E});2k.V("dI",A(Z,X){u{r:Z.r-X.r,g:Z.g-X.g,b:Z.b-X.b}});2k.V("aG",A(Z,X){u{r:X.r+Z.r,g:X.g+Z.g,b:X.b+Z.b}});2k.V("dH",A(Z,X){u{r:1g-2*(X.r-1g)*(Z.r-1g)/E,g:1g-2*(X.g-1g)*(Z.g-1g)/E,b:1g-2*(X.b-1g)*(Z.b-1g)/E}});2k.V("aI",A(Z,X){M 1E;1E={};1E.r=X.r>1g?E-((E-X.r)*(E-(Z.r-1g)))/E:(X.r*(Z.r+1g))/E;1E.g=X.g>1g?E-((E-X.g)*(E-(Z.g-1g)))/E:(X.g*(Z.g+1g))/E;1E.b=X.b>1g?E-((E-X.b)*(E-(Z.b-1g)))/E:(X.b*(Z.b+1g))/E;u 1E});2k.V("dG",A(Z,X){u{r:X.r>Z.r?X.r:Z.r,g:X.g>Z.g?X.g:Z.g,b:X.b>Z.b?X.b:Z.b}});2k.V("gx",A(Z,X){u{r:X.r>Z.r?Z.r:X.r,g:X.g>Z.g?Z.g:X.g,b:X.b>Z.b?Z.b:X.b}});R.V("4B",A(){M 3c;B(1l.P===1){3c=1X.7u(1l[0])}S{3c={r:1l[0],g:1l[1],b:1l[2]}}u o.2m("4B",A(C){C.r=3c.r;C.g=3c.g;C.b=3c.b;C.a=E;u C})});R.V("3A",A(Q){Q=O.2P(E*(Q/1j));u o.2m("3A",A(C){C.r+=Q;C.g+=Q;C.b+=Q;u C})});R.V("3D",A(Q){Q*=-0.dF;u o.2m("3D",A(C){M 1c;1c=O.1c(C.r,C.g,C.b);B(C.r!==1c){C.r+=(1c-C.r)*Q}B(C.g!==1c){C.g+=(1c-C.g)*Q}B(C.b!==1c){C.b+=(1c-C.b)*Q}u C})});R.V("3Y",A(Q){Q*=-1;u o.2m("3Y",A(C){M 1p,4E,1c;1c=O.1c(C.r,C.g,C.b);4E=(C.r+C.g+C.b)/3;1p=((O.4D(1c-4E)*2/E)*Q)/1j;B(C.r!==1c){C.r+=(1c-C.r)*1p}B(C.g!==1c){C.g+=(1c-C.g)*1p}B(C.b!==1c){C.b+=(1c-C.b)*1p}u C})});R.V("4C",A(Q){u o.2m("4C",A(C){M 4E;4E=2b.6L(C);C.r=4E;C.g=4E;C.b=4E;u C})});R.V("2u",A(Q){Q=O.1T((Q+1j)/1j,2);u o.2m("2u",A(C){C.r/=E;C.r-=0.5;C.r*=Q;C.r+=0.5;C.r*=E;C.g/=E;C.g-=0.5;C.g*=Q;C.g+=0.5;C.g*=E;C.b/=E;C.b-=0.5;C.b*=Q;C.b+=0.5;C.b*=E;u C})});R.V("8F",A(Q){u o.2m("8F",A(C){M b,g,h,4X,r,K;4X=1X.aL(C.r,C.g,C.b);h=4X.h*1j;h+=O.4D(Q);h=h%1j;h/=1j;4X.h=h;K=1X.aW(4X.h,4X.s,4X.v),r=K.r,g=K.g,b=K.b;C.r=r;C.g=g;C.b=b;u C})});R.V("4e",A(){M 5Q,3f;B(1l.P===2){3f=1X.7u(1l[0]);5Q=1l[1]}S B(1l.P===4){3f={r:1l[0],g:1l[1],b:1l[2]};5Q=1l[3]}u o.2m("4e",A(C){C.r-=(C.r-3f.r)*(5Q/1j);C.g-=(C.g-3f.g)*(5Q/1j);C.b-=(C.b-3f.b)*(5Q/1j);u C})});R.V("b0",A(){u o.2m("b0",A(C){C.r=E-C.r;C.g=E-C.g;C.b=E-C.b;u C})});R.V("4a",A(Q){B(Q==L){Q=1j}Q/=1j;u o.2m("4a",A(C){C.r=O.1M(E,(C.r*(1-(0.dD*Q)))+(C.g*(0.dC*Q))+(C.b*(0.dB*Q)));C.g=O.1M(E,(C.r*(0.dA*Q))+(C.g*(1-(0.dz*Q)))+(C.b*(0.dy*Q)));C.b=O.1M(E,(C.r*(0.dx*Q))+(C.g*(0.dw*Q))+(C.b*(1-(0.dv*Q))));u C})});R.V("2v",A(Q){u o.2m("2v",A(C){C.r=O.1T(C.r/E,Q)*E;C.g=O.1T(C.g/E,Q)*E;C.b=O.1T(C.b/E,Q)*E;u C})});R.V("8n",A(Q){Q=O.4D(Q)*2.55;u o.2m("8n",A(C){M 4s;4s=2b.ce(Q*-1,Q);C.r+=4s;C.g+=4s;C.b+=4s;u C})});R.V("8l",A(Q){Q=O.4D(Q)*2.55;u o.2m("8l",A(C){B(C.r>E-Q){C.r=E}S B(C.r<Q){C.r=0}B(C.g>E-Q){C.g=E}S B(C.g<Q){C.g=0}B(C.b>E-Q){C.b=E}S B(C.b<Q){C.b=0}u C})});R.V("3x",A(1F){M 5S,4q;B(1r 1F!=="44"){u o}W(5S 5h 1F){B(!74.1w(1F,5S))5I;4q=1F[5S];B(4q===0){aA 1F[5S];5I}1F[5S]/=1j}B(1F.P===0){u o}u o.2m("3x",A(C){B(1F.3d!=L){B(1F.3d>0){C.r+=(E-C.r)*1F.3d}S{C.r-=C.r*O.4D(1F.3d)}}B(1F.4U!=L){B(1F.4U>0){C.g+=(E-C.g)*1F.4U}S{C.g-=C.g*O.4D(1F.4U)}}B(1F.41!=L){B(1F.41>0){C.b+=(E-C.b)*1F.41}S{C.b-=C.b*O.4D(1F.41)}}u C})});R.V("2e",A(){M 6O,2h,43,3J,1Q,i,5X,1J,H,1e,K,3T;43=1l[0],3J=2<=1l.P?5W.1w(1l,1):[];5X=3J[3J.P-1];B(1r 5X==="A"){6O=5X;3J.6o()}S B(1r 5X==="3j"){6O=2b[5X];3J.6o()}S{6O=2b.2h}B(1r 43==="3j"){43=43.dt("")}B(43[0]==="v"){43=[\'r\',\'g\',\'b\']}B(3J.P<2){2V"6i 8s 9K 1l 3N 2e 1C";}2h=6O(3J,0,E);1J=3J[0];B(1J[0]>0){W(i=H=0,K=1J[0];0<=K?H<K:H>K;i=0<=K?++H:--H){2h[i]=1J[1]}}1Q=3J[3J.P-1];B(1Q[0]<E){W(i=1e=3T=1Q[0];3T<=E?1e<=E:1e>=E;i=3T<=E?++1e:--1e){2h[i]=1Q[1]}}u o.2m("2e",A(C){M 1I,4o;W(i=1I=0,4o=43.P;0<=4o?1I<4o:1I>4o;i=0<=4o?++1I:--1I){C[43[i]]=2h[C[43[i]]]}u C})});R.V("33",A(Q){M 4H,4G,p;p=O.4D(Q)/1j;4H=[0,E*p];4G=[E-(E*p),E];B(Q<0){4H=4H.bq();4G=4G.bq()}u o.2e(\'3f\',[0,0],4H,4G,[E,E])});D.2w.V("8Q",A(F,J,x,y){M I,1W;B(x==L){x=0}B(y==L){y=0}B(1r 2g!=="42"&&2g!==L){I=1y 3S(F,J)}S{I=2p.3K(\'I\');1v.5H(o.I,I);I.F=F;I.J=J}1W=I.3h(\'2d\');1W.5U(o.I,x,y,F,J,0,0,F,J);o.6z={x:x,y:y};o.bH=31;u o.73(I)});D.2w.V("88",A(2B){M I,1W;B(2B==L){2B=L}B(2B===L||((2B.F==L)&&(2B.J==L))){1Y.9C("6i d3 ds 1d aQ W 88");u}B(2B.F==L){2B.F=o.I.F*2B.J/o.I.J}S B(2B.J==L){2B.J=o.I.J*2B.F/o.I.F}B(1r 2g!=="42"&&2g!==L){I=1y 3S(2B.F,2B.J)}S{I=2p.3K(\'I\');1v.5H(o.I,I);I.F=2B.F;I.J=2B.J}1W=I.3h(\'2d\');1W.5U(o.I,0,0,o.I.F,o.I.J,0,0,2B.F,2B.J);o.7R=31;u o.73(I)});D.R.V("8Q",A(){u o.5a("8Q",5T.N.5f.1w(1l,0))});D.R.V("88",A(){u o.5a("88",5T.N.5f.1w(1l,0))});D.R.V("dr",A(){u o.3I("dq 85",[1,1,1,1,1,1,1,1,1])});D.R.V("dp",A(){u o.3I("do dn 85",[0,0,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,1,0,0])});D.R.V("dm",A(){u o.3I("dl 85",[1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1])});D.R.V("dk",A(3C){M 2I;B(3C===0||3C===47){2I=[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0]}S B((3C>0&&3C<90)||(3C>47&&3C<7K)){2I=[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0]}S B(3C===90||3C===7K){2I=[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0]}S{2I=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}u o.3I("dj 85",2I)});D.R.V("6w",A(1p){B(1p==L){1p=1j}1p/=1j;u o.3I("di",[0,-1p,0,-1p,4*1p+1,-1p,0,-1p,0])});9y={3A:A(C,1p,G){C.r=C.r-(C.r*1p*G.3i);C.g=C.g-(C.g*1p*G.3i);C.b=C.b-(C.b*1p*G.3i);u C},2v:A(C,1p,G){C.r=O.1T(C.r/E,O.1c(10*1p*G.3i,1))*E;C.g=O.1T(C.g/E,O.1c(10*1p*G.3i,1))*E;C.b=O.1T(C.b/E,O.1c(10*1p*G.3i,1))*E;u C},4e:A(C,1p,G){C.r-=(C.r-G.3c.r)*1p;C.g-=(C.g-G.3c.g)*1p;C.b-=(C.b-G.3c.b)*1p;u C}};R.V("1V",A(1s,3i){M 2h,3t,1Q,1J;B(3i==L){3i=60}B(1r 1s==="3j"&&1s.5d(-1)==="%"){B(o.1d.J>o.1d.F){1s=o.1d.F*(49(1s.5d(0,1s.P-1),10)/1j)}S{1s=o.1d.J*(49(1s.5d(0,1s.P-1),10)/1j)}}3i/=1j;3t=[o.1d.F/2,o.1d.J/2];1J=O.7L(O.1T(3t[0],2)+O.1T(3t[1],2));1Q=1J-1s;2h=2b.2h([0,1],[30,30],[70,60],[1j,80]);u o.2m("1V",A(C){M 7m,2J,U;U=C.8R();7m=2b.52(U.x,U.y,3t[0],3t[1]);B(7m>1Q){2J=O.1c(1,(2h[O.62(((7m-1Q)/1s)*1j)]/10)*3i);C.r=O.1T(C.r/E,2J)*E;C.g=O.1T(C.g/E,2J)*E;C.b=O.1T(C.b/E,2J)*E}u C})});R.V("bX",A(G){M 4c,6j,7h,1s,H,1n,K;4c={3i:50,2G:0,9g:\'3A\',3c:{r:0,g:0,b:0}};G=1v.7N(4c,G);B(!G.1s){u o}S B(1r G.1s==="3j"){7h=49(G.1s,10)/1j;G.1s={F:o.1d.F*7h,J:o.1d.J*7h}}S B(1r G.1s==="44"){K=["F","J"];W(H=0,1n=K.P;H<1n;H++){6j=K[H];B(1r G.1s[6j]==="3j"){G.1s[6j]=o.1d[6j]*(49(G.1s[6j],10)/1j)}}}S B(G.1s==="8s"){1s=G.1s;G.1s={F:1s,J:1s}}B(1r G.2G==="3j"){G.2G=(G.1s.F/2)*(49(G.2G,10)/1j)}G.3i/=1j;G.1s.F=O.2P(G.1s.F);G.1s.J=O.2P(G.1s.J);G.1f={F:o.1d.F,J:o.1d.J};B(G.9g==="4e"&&1r G.3c==="3j"){G.3c=1X.7u(G.3c)}G.1Z={5m:(o.1d.F-G.1s.F)/2,68:o.1d.F-G.1Z.5m,5l:(o.1d.J-G.1s.J)/2,66:o.1d.J-G.1Z.5l};G.1x=[{x:G.1Z.5m+G.2G,y:G.1Z.66-G.2G},{x:G.1Z.68-G.2G,y:G.1Z.66-G.2G},{x:G.1Z.68-G.2G,y:G.1Z.5l+G.2G},{x:G.1Z.5m+G.2G,y:G.1Z.5l+G.2G}];G.4f=2b.52(0,0,G.1x[3].x,G.1x[3].y)-G.2G;u o.2m("bX",A(C){M 1p,U,4g;U=C.8R();B((U.x>G.1x[0].x&&U.x<G.1x[1].x)&&(U.y>G.1Z.5l&&U.y<G.1Z.66)){u C}B((U.x>G.1Z.5m&&U.x<G.1Z.68)&&(U.y>G.1x[3].y&&U.y<G.1x[2].y)){u C}B(U.x>G.1x[0].x&&U.x<G.1x[1].x&&U.y>G.1Z.66){1p=(U.y-G.1Z.66)/G.4f}S B(U.y>G.1x[2].y&&U.y<G.1x[1].y&&U.x>G.1Z.68){1p=(U.x-G.1Z.68)/G.4f}S B(U.x>G.1x[0].x&&U.x<G.1x[1].x&&U.y<G.1Z.5l){1p=(G.1Z.5l-U.y)/G.4f}S B(U.y>G.1x[2].y&&U.y<G.1x[1].y&&U.x<G.1Z.5m){1p=(G.1Z.5m-U.x)/G.4f}S B(U.x<=G.1x[0].x&&U.y>=G.1x[0].y){4g=D.52(U.x,U.y,G.1x[0].x,G.1x[0].y);1p=(4g-G.2G)/G.4f}S B(U.x>=G.1x[1].x&&U.y>=G.1x[1].y){4g=D.52(U.x,U.y,G.1x[1].x,G.1x[1].y);1p=(4g-G.2G)/G.4f}S B(U.x>=G.1x[2].x&&U.y<=G.1x[2].y){4g=D.52(U.x,U.y,G.1x[2].x,G.1x[2].y);1p=(4g-G.2G)/G.4f}S B(U.x<=G.1x[3].x&&U.y<=G.1x[3].y){4g=D.52(U.x,U.y,G.1x[3].x,G.1x[3].y);1p=(4g-G.2G)/G.4f}B(1p<0){u C}u 9y[G.9g](C,1p,G)})});(A(){M 4v,9o,9p,64,63;64=[2S,2S,37,2S,3u,37,3v,2S,3X,3u,3y,37,3W,3v,3V,2S,4J,3X,4I,3u,4F,3y,4z,37,4x,3W,4m,3v,34,3V,4T,2S,5Z,4J,3Q,3X,5P,4I,5N,3u,34,4F,5K,3y,4O,4z,4L,37,5z,4x,5y,3W,5x,4m,5w,3v,5v,34,5u,3V,5t,4T,3P,2S,8u,5Z,8r,4J,8o,3Q,8a,3X,7Y,5P,7M,4I,4y,5N,7e,3u,5q,34,7a,4F,79,5K,4w,3y,3P,4O,8y,4z,8x,4L,8j,37,8b,5z,3Q,4x,7X,5y,7U,3W,7S,5x,7P,4m,4y,5w,5G,3v,7p,5v,7o,34,7d,5u,8B,3V,5Y,5t,4w,4T,89,3P,81,2S,cK,8u,cw,5Z,4L,8r,cq,4J,cp,8o,cj,3Q,cc,8a,ca,3X,bT,7Y,bM,5P,bK,7M,bF,4I,bE,4y,83,5N,5G,7e,84,3u,bA,5q,bz,34,by,7a,bw,4F,86,79,5Y,5K,bu,4w,bo,3y,bj,3P,ba,4O,b9,8y,b8,4z,b7,8x,b6,4L,b5,8j,b4,37,b3,8b,b2,5z,aR,3Q,aO,4x,aJ,7X,aH,5y,aF,7U,aC,3W,az,7S,aw,5x,av,7P,au,4m,ar,4y,83,5w,ao,5G,an,3v,84,7p,ak,5v,5q,7o,aj,34,ag,7d,ad,5u,9O,8B,86,3V,a9,5Y,d7,5t,cZ,4w,cY,4T,3y,89,cX,3P,cT,81,4O];63=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];9o=A(F,J,5J,5M,2H,P,c2){M 3Z,1i,2s,6U,6R,6S,6Q;3Z=1r 2g!=="42"&&2g!==L?1y 3S():2p.3K(\'I\');3Z.F=F;3Z.J=J;6U=5J+O.c0(2H)*P*0.5;6S=5M+O.bZ(2H)*P*0.5;6R=5J-O.c0(2H)*P*0.5;6Q=5M-O.bZ(2H)*P*0.5;1i=3Z.3h("2d");2s=1i.el(6U,6S,6R,6Q);B(!c2){2s.5e(0,"7H");2s.5e(1,"93")}S{2s.5e(0,"7H");2s.5e(0.5,"93");2s.5e(1,"7H")}1i.bN=2s;1i.bL(0,0,F,J);u 1i.48(0,0,F,J)};9p=A(F,J,5J,5M,6v,6t){M 3Z,1i,2s;3Z=1r 2g!=="42"&&2g!==L?1y 3S():2p.3K(\'I\');3Z.F=F;3Z.J=J;1i=3Z.3h("2d");2s=1i.et(5J,5M,6v,5J,5M,6t);2s.5e(1,"7H");2s.5e(0,"93");1i.bN=2s;1i.bL(0,0,F,J);u 1i.48(0,0,F,J)};4v=A(){o.r=0;o.g=0;o.b=0;o.a=0;u o.1S=L};D.2w.V("96",A(bt,1U,br,7B){M 2n,2A,1O,5L,6q,2J,2l,2D,1L,J,3U,i,6p,2z,3o,7r,3R,6n,2L,p,1z,1B,Y,1A,2o,2E,1R,9a,1a,3a,2R,1b,4h,1m,1H,2M,5i,2W,8i,8h,5V,F,3l,x,y,1h,4R,4P,H,1e,1I,3m,3r,3s,3k,3w,3z,5O;F=o.1d.F;J=o.1d.J;3o=o.T;9a=bt.29;8h=F*J;5V=8h<<2;Y=[];W(i=H=0;0<=5V?H<5V:H>5V;i=0<=5V?++H:--H){Y[i]=3o[i]}6q=0;5i=7B;7B-=1;9I(5i--\x3e=0){3R=(1U+0.5)|0;B(3R===0){5I}B(3R>6A){3R=6A}2J=3R+3R+1;8i=F<<2;3l=F-1;3U=J-1;1a=3R+1;2W=1a*(1a+1)/2;2M=1y 4v();4h=da 0;1b=2M;W(i=1e=1;1<=2J?1e<2J:1e>2J;i=1<=2J?++1e:--1e){1b=1b.1S=1y 4v();B(i===1a){4h=1b}}1b.1S=2M;1m=L;1H=L;4P=1h=0;2L=64[3R];2R=63[3R];W(y=1I=0;0<=J?1I<J:1I>J;y=0<=J?++1I:--1I){2o=2l=2n=1R=1L=1O=0;2E=1a*(1A=Y[1h]);2D=1a*(1B=Y[1h+1]);2A=1a*(1z=Y[1h+2]);1R+=2W*1A;1L+=2W*1B;1O+=2W*1z;1b=2M;W(i=3m=0;0<=1a?3m<1a:3m>1a;i=0<=1a?++3m:--3m){1b.r=1A;1b.g=1B;1b.b=1z;1b=1b.1S}W(i=3r=1;1<=1a?3r<1a:3r>1a;i=1<=1a?++3r:--3r){p=1h+((3l<i?3l:i)<<2);1R+=(1b.r=(1A=Y[p]))*(3a=1a-i);1L+=(1b.g=(1B=Y[p+1]))*3a;1O+=(1b.b=(1z=Y[p+2]))*3a;2o+=1A;2l+=1B;2n+=1z;1b=1b.1S}1m=2M;1H=4h;W(x=3s=0;0<=F?3s<F:3s>F;x=0<=F?++3s:--3s){Y[1h]=(1R*2L)>>2R;Y[1h+1]=(1L*2L)>>2R;Y[1h+2]=(1O*2L)>>2R;1R-=2E;1L-=2D;1O-=2A;2E-=1m.r;2D-=1m.g;2A-=1m.b;p=(4P+((p=x+1a)<3l?p:3l))<<2;2o+=(1m.r=Y[p]);2l+=(1m.g=Y[p+1]);2n+=(1m.b=Y[p+2]);1R+=2o;1L+=2l;1O+=2n;1m=1m.1S;2E+=(1A=1H.r);2D+=(1B=1H.g);2A+=(1z=1H.b);2o-=1A;2l-=1B;2n-=1z;1H=1H.1S;1h+=4}4P+=F}W(x=3k=0;0<=F?3k<F:3k>F;x=0<=F?++3k:--3k){2l=2n=2o=1L=1O=1R=0;1h=x<<2;2E=1a*(1A=Y[1h]);2D=1a*(1B=Y[1h+1]);2A=1a*(1z=Y[1h+2]);1R+=2W*1A;1L+=2W*1B;1O+=2W*1z;1b=2M;W(i=3w=0;0<=1a?3w<1a:3w>1a;i=0<=1a?++3w:--3w){1b.r=1A;1b.g=1B;1b.b=1z;1b=1b.1S}4R=F;W(i=3z=1;1<=1a?3z<1a:3z>1a;i=1<=1a?++3z:--3z){1h=(4R+x)<<2;1R+=(1b.r=(1A=Y[1h]))*(3a=1a-i);1L+=(1b.g=(1B=Y[1h+1]))*3a;1O+=(1b.b=(1z=Y[1h+2]))*3a;2o+=1A;2l+=1B;2n+=1z;1b=1b.1S;B(i<3U){4R+=F}}1h=x;1m=2M;1H=4h;W(y=5O=0;0<=J?5O<J:5O>J;y=0<=J?++5O:--5O){p=1h<<2;Y[p]=(1R*2L)>>2R;Y[p+1]=(1L*2L)>>2R;Y[p+2]=(1O*2L)>>2R;1R-=2E;1L-=2D;1O-=2A;2E-=1m.r;2D-=1m.g;2A-=1m.b;p=(x+(((p=y+1a)<3U?p:3U)*F))<<2;1R+=(2o+=(1m.r=Y[p]));1L+=(2l+=(1m.g=Y[p+1]));1O+=(2n+=(1m.b=Y[p+2]));1m=1m.1S;2E+=(1A=1H.r);2D+=(1B=1H.g);2A+=(1z=1H.b);2o-=1A;2l-=1B;2n-=1z;1H=1H.1S;1h+=F}}1U*=br;i=8h;9I(--i>-1){2z=i<<2;6n=(9a[2z+2]&fl)/E.0*7B;7r=6n|0;B(7r===6q){5L=6A.0*(6n-(6n|0));6p=6A-5L;3o[2z]=(3o[2z]*6p+Y[2z]*5L)>>8;3o[2z+1]=(3o[2z+1]*6p+Y[2z+1]*5L)>>8;3o[2z+2]=(3o[2z+2]*6p+Y[2z+2]*5L)>>8}S B(7r===6q+1){3o[2z]=Y[2z];3o[2z+1]=Y[2z+1];3o[2z+2]=Y[2z+2]}}6q++}u o});D.R.V("fo",A(G){M 4c,2s;4c={3t:{x:o.1d.F/2,y:o.1d.J/2},2H:45,aa:6a,7v:3,7t:1.5,5i:3};G=1v.7N(4c,G);G.2H*=O.aB/47;2s=9o(o.1d.F,o.1d.J,G.3t.x,G.3t.y,G.2H,G.aa,31);u o.5a("96",[2s,G.7v,G.7t,G.5i])});u D.R.V("fv",A(G){M 4c,2s,6v,6t;4c={1s:50,3t:{x:o.1d.F/2,y:o.1d.J/2},7v:3,7t:1.5,5i:3,1U:L};G=1v.7N(4c,G);B(!G.1U){G.1U=o.1d.F<o.1d.J?o.1d.J:o.1d.F}6v=(G.1U/2)-G.1s;6t=G.1U/2;2s=9p(o.1d.F,o.1d.J,G.3t.x,G.3t.y,6v,6t);u o.5a("96",[2s,G.7v,G.7t,G.5i])})})();D.R.V("fw",A(){u o.3I("ac fy",[0,0,0,-1,1,0,0,0,0])});D.R.V("fz",A(){u o.3I("ac fA",[-1,-1,-1,-1,8,-1,-1,-1,-1])});D.R.V("fB",A(){u o.3I("fC",[-2,-1,0,-1,1,1,0,1,2])});D.R.V("9N",A(Q){M 6J,6K;6J=6A/Q;6K=E/(Q-1);u o.2m("9N",A(C){C.r=O.2P(O.2P(C.r/6J)*6K);C.g=O.2P(O.2P(C.g/6J)*6K);C.b=O.2P(O.2P(C.b/6J)*6K);u C})});D.R.V("fG",A(1V){B(1V==L){1V=31}o.4C();o.2u(5);o.8n(3);o.4a(1j);o.3x({3d:8,41:2,4U:4});o.2v(0.87);B(1V){u o.1V("40%",30)}});D.R.V("fI",A(1V){B(1V==L){1V=31}o.3A(15);o.33(15);o.2e(\'3f\',[0,0],[6a,0],[fJ,E],[E,E]);o.3D(-20);o.2v(1.8);B(1V){o.1V("50%",60)}u o.3A(5)});D.R.V("fK",A(7Q){B(7Q==L){7Q=2r}o.3Y(20);o.2e(\'3f\',[5,0],[fM,cd],[9T,fP],[fQ,E]);o.6w(15);o.1V("45%",20);B(7Q){o.4C();o.2u(4)}u o});D.R.V("fR",A(){o.2u(1j);o.3A(15);o.33(10);o.9N(80);o.8l(30);u o.4C()});D.R.V("fS",A(){o.33(3.5);o.3D(-5);o.3Y(50);o.4a(60);o.4e("#cL",10);o.3x({3d:8,41:8});o.2u(5);o.2v(1.2);u o.1V("55%",25)});D.R.V("fV",A(){o.33(5);o.4e("#cL",4);o.4a(20);o.3x({41:8,3d:3});o.2e(\'b\',[0,0],[1j,cd],[47,47],[E,E]);o.2u(15);o.3Y(75);u o.2v(1.6)});D.R.V("fW",A(){o.2e(\'3f\',[0,0],[1j,50],[bW,6a],[E,E]);o.3Y(-30);o.3D(-30);o.4e(\'#fY\',30);o.2u(-5);u o.2v(1.4)});D.R.V("fZ",A(){o.3A(5);o.33(8);o.2u(4);o.4e(\'#g0\',30);o.3Y(50);u o.2v(1.3)});D.R.V("g1",A(){o.2v(1.5);o.8l(25);o.3D(-60);o.2u(5);o.8n(5);u o.1V("50%",30)});D.R.V("g2",A(){o.3D(-35);o.2e(\'b\',[20,0],[90,7y],[g5,bV],[E,be]);o.2e(\'r\',[0,0],[bV,90],[g8,7y],[E,E]);o.2e(\'g\',[10,0],[g9,ga],[gb,1j],[E,gc]);o.2e(\'3f\',[0,0],[7y,1j],[1g,bW],[E,E]);u o.6w(20)});D.R.V("gd",A(){o.4C();o.4a(10);o.33(10);o.2u(15);u o.1V("60%",35)});D.R.V("ge",A(){o.3D(-20);o.3Y(-50);o.2v(1.1);o.4a(30);o.3x({3d:-10,41:5});o.2e(\'3f\',[0,0],[80,50],[1g,be],[E,E]);u o.1V("60%",30)});D.R.V("gf",A(1V){B(1V==L){1V=31}o.3A(10);o.2Z(A(){o.3q("5o");o.2q(80);o.4n();o.1C.2v(0.8);o.1C.2u(50);u o.1C.33(10)});o.2Z(A(){o.3q("aI");o.2q(80);u o.4B("#gg")});o.33(20);o.2v(0.8);B(1V){u o.1V("45%",20)}});D.R.V("gh",A(){o.2v(1.2);o.2Z(A(){o.3q("8v");o.2q(60);o.4n();o.1C.3x({3d:5});u o.1C.6f(15)});o.2Z(A(){o.3q("aG");o.2q(40);u o.4B("#gj")});o.2Z(A(){o.3q("5o");o.2q(35);o.4n();o.1C.3A(40);o.1C.3Y(40);o.1C.33(30);o.1C.2u(15);o.1C.2e(\'r\',[0,40],[1g,1g],[1g,1g],[E,a4]);o.1C.2e(\'g\',[0,40],[1g,1g],[1g,1g],[E,a4]);o.1C.2e(\'b\',[0,40],[1g,1g],[1g,1g],[E,a4]);u o.1C.6f(5)});o.2e(\'r\',[20,0],[1g,gl],[1g,1g],[7b,E]);o.2e(\'g\',[20,0],[1g,1g],[1g,1g],[7b,E]);o.2e(\'b\',[20,0],[1g,9n],[1g,1g],[7b,E]);u o.1V("45%",20)});D.R.V("gn",A(){o.3A(40);o.4e("#bk",10);o.2e(\'b\',[0,10],[1g,47],[9T,9T],[E,E]);o.2Z(A(){o.3q(\'8v\');o.2q(50);o.4n();o.1C.2v(0.7);u o.2Z(A(){o.3q(\'8X\');o.2q(60);u o.4B(\'#bk\')})});o.2Z(A(){o.3q(\'5o\');o.2q(60);o.4n();o.1C.3D(50);o.1C.8F(90);u o.1C.2u(10)});o.2v(1.4);o.3Y(-30);o.2Z(A(){o.2q(10);u o.4B(\'#gp\')});u o});D.R.V("gq",A(){o.3D(20);o.2v(1.4);o.4C();o.2u(5);o.4a(1j);o.3x({3d:8,41:2,4U:4});o.2v(0.8);o.2u(5);o.33(10);o.2Z(A(){o.3q(\'8v\');o.4n();o.2q(55);u o.1C.6f(10)});u o.1V("50%",30)});D.R.V("gr",A(){o.4C();o.2u(10);o.2v(0.9);o.2Z(A(){o.3q("5o");o.2q(40);o.4n();o.1C.33(15);o.1C.2u(15);u o.1C.3x({4U:10,3d:5})});o.4a(30);o.2e(\'3f\',[0,10],[7y,90],[47,6a],[7b,E]);o.3x({3d:5,4U:-2});u o.33(15)});D.R.V("gs",A(){o.6w(40);o.3D(-50);o.3x({3d:3});o.2Z(A(){o.3q("5o");o.2q(80);o.4n();o.1C.6w(5);o.1C.2u(50);o.1C.33(10);u o.1C.3x({41:5})});u o.3A(10)});D.2w.V("7f",A(3C){M 2H,I,1W,J,a7,F,x,y;2H=3C%4m;B(2H===0){u o.1d={F:o.I.F,J:o.I.J}}a7=O.aB/47;B(1r 2g!=="42"&&2g!==L){I=1y 3S()}S{I=2p.3K(\'I\');1v.5H(o.I,I)}B(2H===90||2H===-7K||2H===7K||2H===-90){F=o.I.J;J=o.I.F;x=F/2;y=J/2}S B(2H===47){F=o.I.F;J=o.I.J;x=F/2;y=J/2}S{F=O.7L(O.1T(o.51,2)+O.1T(o.5D,2));J=F;x=o.I.J/2;y=o.I.F/2}I.F=F;I.J=J;1W=I.3h(\'2d\');1W.bB();1W.gv(x,y);1W.7f(2H*a7);1W.5U(o.I,-o.I.F/2,-o.I.J/2,o.I.F,o.I.J);1W.gw();u o.73(I)});D.R.V("7f",A(){u o.5a("7f",5T.N.5f.1w(1l,0))});(A(){M 4v,64,63;64=[2S,2S,37,2S,3u,37,3v,2S,3X,3u,3y,37,3W,3v,3V,2S,4J,3X,4I,3u,4F,3y,4z,37,4x,3W,4m,3v,34,3V,4T,2S,5Z,4J,3Q,3X,5P,4I,5N,3u,34,4F,5K,3y,4O,4z,4L,37,5z,4x,5y,3W,5x,4m,5w,3v,5v,34,5u,3V,5t,4T,3P,2S,8u,5Z,8r,4J,8o,3Q,8a,3X,7Y,5P,7M,4I,4y,5N,7e,3u,5q,34,7a,4F,79,5K,4w,3y,3P,4O,8y,4z,8x,4L,8j,37,8b,5z,3Q,4x,7X,5y,7U,3W,7S,5x,7P,4m,4y,5w,5G,3v,7p,5v,7o,34,7d,5u,8B,3V,5Y,5t,4w,4T,89,3P,81,2S,cK,8u,cw,5Z,4L,8r,cq,4J,cp,8o,cj,3Q,cc,8a,ca,3X,bT,7Y,bM,5P,bK,7M,bF,4I,bE,4y,83,5N,5G,7e,84,3u,bA,5q,bz,34,by,7a,bw,4F,86,79,5Y,5K,bu,4w,bo,3y,bj,3P,ba,4O,b9,8y,b8,4z,b7,8x,b6,4L,b5,8j,b4,37,b3,8b,b2,5z,aR,3Q,aO,4x,aJ,7X,aH,5y,aF,7U,aC,3W,az,7S,aw,5x,av,7P,au,4m,ar,4y,83,5w,ao,5G,an,3v,84,7p,ak,5v,5q,7o,aj,34,ag,7d,ad,5u,9O,8B,86,3V,a9,5Y,d7,5t,cZ,4w,cY,4T,3y,89,cX,3P,cT,81,4O];63=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];4v=A(){o.r=0;o.g=0;o.b=0;o.a=0;u o.1S=L};D.2w.V("6f",A(1U){M 2n,2A,1O,2J,2l,2D,1L,J,3U,i,2L,p,1z,1B,Y,1A,2o,2E,1R,1a,3a,2R,1b,4h,1m,1H,2M,2W,8i,F,3l,x,y,1h,4R,4P,H,1e,1I,3m,3r,3s,3k,3w,3z;B(bQ(1U)||1U<1){u}1U|=0;Y=o.T;F=o.1d.F;J=o.1d.J;2J=1U+1U+1;8i=F<<2;3l=F-1;3U=J-1;1a=1U+1;2W=1a*(1a+1)/2;2M=1y 4v();1b=2M;W(i=H=1;1<=2J?H<2J:H>2J;i=1<=2J?++H:--H){1b=1b.1S=1y 4v();B(i===1a){4h=1b}}1b.1S=2M;1m=L;1H=L;4P=1h=0;2L=64[1U];2R=63[1U];W(y=1e=0;0<=J?1e<J:1e>J;y=0<=J?++1e:--1e){2o=2l=2n=1R=1L=1O=0;2E=1a*(1A=Y[1h]);2D=1a*(1B=Y[1h+1]);2A=1a*(1z=Y[1h+2]);1R+=2W*1A;1L+=2W*1B;1O+=2W*1z;1b=2M;W(i=1I=0;0<=1a?1I<1a:1I>1a;i=0<=1a?++1I:--1I){1b.r=1A;1b.g=1B;1b.b=1z;1b=1b.1S}W(i=3m=1;1<=1a?3m<1a:3m>1a;i=1<=1a?++3m:--3m){p=1h+((3l<i?3l:i)<<2);1R+=(1b.r=(1A=Y[p]))*(3a=1a-i);1L+=(1b.g=(1B=Y[p+1]))*3a;1O+=(1b.b=(1z=Y[p+2]))*3a;2o+=1A;2l+=1B;2n+=1z;1b=1b.1S}1m=2M;1H=4h;W(x=3r=0;0<=F?3r<F:3r>F;x=0<=F?++3r:--3r){Y[1h]=(1R*2L)>>2R;Y[1h+1]=(1L*2L)>>2R;Y[1h+2]=(1O*2L)>>2R;1R-=2E;1L-=2D;1O-=2A;2E-=1m.r;2D-=1m.g;2A-=1m.b;p=(4P+((p=x+1U+1)<3l?p:3l))<<2;2o+=(1m.r=Y[p]);2l+=(1m.g=Y[p+1]);2n+=(1m.b=Y[p+2]);1R+=2o;1L+=2l;1O+=2n;1m=1m.1S;2E+=(1A=1H.r);2D+=(1B=1H.g);2A+=(1z=1H.b);2o-=1A;2l-=1B;2n-=1z;1H=1H.1S;1h+=4}4P+=F}W(x=3s=0;0<=F?3s<F:3s>F;x=0<=F?++3s:--3s){2l=2n=2o=1L=1O=1R=0;1h=x<<2;2E=1a*(1A=Y[1h]);2D=1a*(1B=Y[1h+1]);2A=1a*(1z=Y[1h+2]);1R+=2W*1A;1L+=2W*1B;1O+=2W*1z;1b=2M;W(i=3k=0;0<=1a?3k<1a:3k>1a;i=0<=1a?++3k:--3k){1b.r=1A;1b.g=1B;1b.b=1z;1b=1b.1S}4R=F;W(i=3w=1;1<=1U?3w<=1U:3w>=1U;i=1<=1U?++3w:--3w){1h=(4R+x)<<2;1R+=(1b.r=(1A=Y[1h]))*(3a=1a-i);1L+=(1b.g=(1B=Y[1h+1]))*3a;1O+=(1b.b=(1z=Y[1h+2]))*3a;2o+=1A;2l+=1B;2n+=1z;1b=1b.1S;B(i<3U){4R+=F}}1h=x;1m=2M;1H=4h;W(y=3z=0;0<=J?3z<J:3z>J;y=0<=J?++3z:--3z){p=1h<<2;Y[p]=(1R*2L)>>2R;Y[p+1]=(1L*2L)>>2R;Y[p+2]=(1O*2L)>>2R;1R-=2E;1L-=2D;1O-=2A;2E-=1m.r;2D-=1m.g;2A-=1m.b;p=(x+(((p=y+1a)<3U?p:3U)*F))<<2;1R+=(2o+=(1m.r=Y[p]));1L+=(2l+=(1m.g=Y[p+1]));1O+=(2n+=(1m.b=Y[p+2]));1m=1m.1S;2E+=(1A=1H.r);2D+=(1B=1H.g);2A+=(1z=1H.b);2o-=1A;2l-=1B;2n-=1z;1H=1H.1S;1h+=F}}u o});u D.R.V("6f",A(1U){u o.5a("6f",[1U])})})();D.R.V("c3",A(Q){u o.2m("c3",A(C){M 6L;6L=(0.bp*C.r)+(0.bs*C.g)+(0.bv*C.b);B(6L<Q){C.r=0;C.g=0;C.b=0}S{C.r=E;C.g=E;C.b=E}u C})})}).1w(o);',62,
1026,"                        this      return      function if rgba Caman 255 width opts _i canvas height _ref null var prototype Math length adjust Filter else pixelData loc register for rgbaParent pixels rgbaLayer           radiusPlus1 stack max dimensions _j image 128 yi context 100 args arguments stackIn _len _results amt name typeof size type pixel Util call corners new pb pr pg filter _this result options src stackOut _k start img g_sum min callback b_sum Renderer end r_sum next pow radius vignette ctx Convert Log coords       endX  Pixel data layer Calculate currentJob  curves val exports bezier case push Blender g_in_sum process b_in_sum r_in_sum document opacity false gradient key contrast gamma Plugin debug imageData idx b_out_sum newDims obj g_out_sum r_out_sum controlPoints cornerRadius angle kernel div divisor mul_sum stackStart IO NodeJS floor Event shg_sum 512 bnum builder throw sumFactor id parentData newLayer  true Store exposure 312   456 target Layer rbs initObj color red bias rgb Type getContext strength string _o widthMinus1 _l 055 imagePixels ret setBlendingMode _m _n center 328 335 _p channels 271 _q brightness levels degrees saturation caman hex prev clampRGB processKernel cps createElement Module newLoc to execute 265 428 iradius Canvas _ref1 heightMinus1 292 388 405 vibrance cnv  blue undefined chans object  ele 180 getImageData parseInt sepia plugin defaults ratio colorize maxDist radialDist stackEnd get devicePixelRatio add processNext 360 copyParent _ref2 res value apply rand Blocks pointsPerSegment BlurStack 278 420 354 496 mul fillColor greyscale abs avg 298 ctrl2 ctrl1 364 454 Analyze 475 from window 259 yw search yp renderer 273 green Image imageHeight hsv trigger break  originalWidth distance modPixelData CamanParser  layerData proxyUrl lowBound highBound processPlugin imageWidth values substr addColorStop slice originalPixelData in steps func lang bottom left events multiply items 320 clamp lerp 282 302 323 347 374 404 437 p0 p1 _error originalHeight builderIndex leftCoord 341 copyAttributes continue centerX 284 blend centerY 345 _r 383 level file chan Array drawImage wh4 __slice last 287 482  switch round shg_table mul_table toString top CamanJS right 1379310345 200 Requires getAttribute nodeFileReady child stackBlur blockFinished parent Invalid dim finishInit attr event lookupValue pop iblend currentIndex allowRevert __indexOf radius2 url radius1 sharpen require http cropCoordinates 256 Fiber copy pixelStack prop dataArray err imageLoaded renderQueue numOfAreas numOfValues luminance getFloat currentLayer algo toLowerCase y2 x2 y1 blockN x1 adjustSize preScaledWidth unparsedInstructions preScaledHeight imgs  numPixels scaledCanvas replaceCanvas __hasProp  fac1 fac2 fac3 291 305 235 parentNode 307 337 rotate pointsPerStep percent pos isURLRemote sub matches dist processFn 318 329 source index rightCoord radiusFactor hexToRGB startRadius langToExt putImageData 120 oldCanvas sel blurLevels root initializedPixelData coord disabled hiDPIRatio white hueToRGB overwrite 270 sqrt 373 extend buf 367 grey resized 381 dest 396 Root match 412 394 moduleKeywords  261 Logger 350 332 Blur 294  resize 269 417 446 horiz vert updateContext includeAlpha INST_REGEX wh w4 465 startX clip hiDPIReplacement noise 441 blocksDone setTimeout 468 number remoteProxy 497 overlay startY 485 507 imageUrl initType 297 fac0 complete whiteZ hue finished listener lastBlockN blockPixelLength eachBlock finishedFn job plugins pixelAtLocation canvasQueue crop locationXY layerStack setContext coordinatesToLocation console except normal blendingMode uniqid  stats  black toBase64  compoundBlur included bind info radiusPixels ctor LoadOverlay _type _fn xyz method 1284185493 2068965517 787037037 3333333333 008856451679 getAttrId 108 getLinearGradientMap getRadialGradientMap readyState whiteY whiteX crossOrigin 4166666667 0031308 version __bind vignetteFilters req 04045 on error replaceChild m1 m0 count missingValues while imageAdjustments of waitForImageLoaded needsHiDPISwap posterize 299 naturalWidth blenders catch try 190 nodeName instFunc inst DOMUpdated LayerFinished LayerDequeue Revert Kernel Single backingStoreRatio 215 _ref3 endY to_radians render 289 focusWidth dataStr Edge 304 renderBlock renderKernel 310 filterFunc Block 315 326 blockNum totalBlocks 338 344 yield domainRegex 357 corsEnabled chunk 363 370 377 use node 385 delete PI 392 newCanvas hiDPIDisabled 400 addition 408 softLight 416 remoteCheck rgbToHSV setInitObject extended 424 binary given 433 addEventListener initialized DOM remote hsvToRGB renderStart proxy hiDPICapable invert rgbToXYZ 442 451 460 470 480 491 501 257 262 isRemote Object swapped 230 RegExp setup parseArguments domIsLoaded 268 ea1c5d scaled executeLayer pushContext 274 2126 reverse increaseFactor 7152 radiusData 281 0722 301 popContext 309 316 324 save nodeSave browserSave 359 368 png cropped 1000 toImage 378 fillRect 389 fillStyle applyCurrentLayer has isNaN hermite item 399 applyToParent 144 140 rectangularVignette instanceof sin cos reloadCanvasData mirrored threshold put px assignId hasId style xyzToLab 411  422 150 randomRange readFromHttp mode https autoload 435 proxyParam locationToCoordinates anonymous 047 DEBUG 447 461 onload date release 883 _super 489 initCanvas Height log parser isImageLoaded Uint8Array Width initImage 116 500 me parse getPixelRelative 505 e87b22 __extends initNode hidpi nowLoc URL setAttribute loaded 263 types processStart processComplete 267 275 280 renderFinished blockStarted originalVisiblePixels or shift loadOverlay executePlugin 285 executeFilter hiDPIAdjustments void ready extends nodeValue 2013 camanProxyUrl Version Released Sharpen Motion motionBlur Gaussian gaussianBlur Radial Heavy heavyRadialBlur Box boxBlur missing split analyze 869 534 272 168 314 349 189 769 607 readystatechange 01 lighten exclusion difference screen flush blocksFinished Rendering Could not endPixel startPixel End Start Executing run find default initialization cpus os toHex toKey putPixel getPixel putPixelRelative warn attributes overlayImage Initializing createImageData layerID readFile toDataURL writing Finished toBuffer writeFile output querySelector Creating isFile createLinearGradient statSync href location stream octet replace caman_proxy createRadialGradient proxies js javascript pl perl py python rb ruby useProxy set defineProperty encodeURIComponent aliasProperty images aliasFunction loading Cannot configured without delegate includes fibers load Attempting __super__ constructor domain credentials listen labToRGB rgbToLab labToXYZ 0570 hasOwnProperty 2040 0557 0415 8758 9689 4986 5372 2406 indexOf xyzToRGB 9505 1192 0193 1805 3576 4124 Fetching setEncoding 0xff hslToRGB  tiltShift Buffer rgbToHSL charAt  keys Remote radialBlur edgeEnhance detected Enhance edgeDetect Detect emboss Emboss using 114 587 vintage toFixed lomo 155 clarity random 130 naturalHeight Function 220 250 sinCity sunrise DOMContentLoaded querySelectorAll crossProcess orangePeel calculateLevels ff9000 love c42007 grungy jarques resetOriginalPixelData HiDPI 186 scale webkitBackingStorePixelRatio 138 115 105 148 248 pinhole oldBoot glowingSun f49600 hazyDays mozBackingStorePixelRatio 6899ba msBackingStorePixelRatio 158 oBackingStorePixelRatio herMajesty backingStorePixelRatio e5f0ff nostalgia hemingway concentrate reset revert translate restore darken".split(" "),
0,{}));var fabric=fabric||{version:"1.6.3"};"undefined"!=typeof exports&&(exports.fabric=fabric);"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow);fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement;
fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window;fabric.SHARED_ATTRIBUTES="display transform fill fill-opacity fill-rule opacity stroke stroke-dasharray stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width id".split(" ");fabric.DPI=96;fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)";fabric.fontPaths={};fabric.charWidthsCache={};
fabric.devicePixelRatio=fabric.window.devicePixelRatio||fabric.window.webkitDevicePixelRatio||fabric.window.mozDevicePixelRatio||1;
(function(){function h(b,d){if(this.__eventListeners[b]){var a=this.__eventListeners[b];d?a[a.indexOf(d)]=!1:fabric.util.array.fill(a,!1)}}function f(b,d){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var a in b)this.on(a,b[a]);else this.__eventListeners[b]||(this.__eventListeners[b]=[]),this.__eventListeners[b].push(d);return this}function e(b,d){if(this.__eventListeners){if(0===arguments.length)for(b in this.__eventListeners)h.call(this,b);else if(1===arguments.length&&
"object"==typeof arguments[0])for(var a in b)h.call(this,a,b[a]);else h.call(this,b,d);return this}}function b(b,d){if(this.__eventListeners){var a=this.__eventListeners[b];if(a){for(var c=0,g=a.length;c<g;c++)a[c]&&a[c].call(this,d||{});return this.__eventListeners[b]=a.filter(function(a){return!1!==a}),this}}}fabric.Observable={observe:f,stopObserving:e,fire:b,on:f,off:e,trigger:b}})();
fabric.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,f=arguments.length;h<f;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(h,f,e){var b=this.getObjects();return e?b[f]=h:b.splice(f,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var h,f=this.getObjects(),e=!1,b=0,g=arguments.length;b<g;b++)h=
f.indexOf(arguments[b]),-1!==h&&(e=!0,f.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[b]));return this.renderOnAddRemove&&e&&this.renderAll(),this},forEachObject:function(h,f){for(var e=this.getObjects(),b=e.length;b--;)h.call(f,e[b],b,e);return this},getObjects:function(h){return"undefined"==typeof h?this._objects:this._objects.filter(function(f){return f.type===h})},item:function(h){return this.getObjects()[h]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},
contains:function(h){return-1<this.getObjects().indexOf(h)},complexity:function(){return this.getObjects().reduce(function(h,f){return h+(f.complexity?f.complexity():0)},0)}};
(function(h){var f=Math.sqrt,e=Math.atan2,b=Math.pow,g=Math.abs,d=Math.PI/180;fabric.util={removeFromArray:function(a,c){var d=a.indexOf(c);return-1!==d&&a.splice(d,1),a},getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1))+a},degreesToRadians:function(a){return a*d},radiansToDegrees:function(a){return a/d},rotatePoint:function(a,c,d){a.subtractEquals(c);a=fabric.util.rotateVector(a,d);return(new fabric.Point(a.x,a.y)).addEquals(c)},rotateVector:function(a,c){var d=Math.sin(c),b=Math.cos(c);
return{x:a.x*b-a.y*d,y:a.x*d+a.y*b}},transformPoint:function(a,c,d){return d?new fabric.Point(c[0]*a.x+c[2]*a.y,c[1]*a.x+c[3]*a.y):new fabric.Point(c[0]*a.x+c[2]*a.y+c[4],c[1]*a.x+c[3]*a.y+c[5])},makeBoundingBoxFromPoints:function(a){var c=[a[0].x,a[1].x,a[2].x,a[3].x],d=fabric.util.array.min(c),c=fabric.util.array.max(c),c=Math.abs(d-c),b=[a[0].y,a[1].y,a[2].y,a[3].y];a=fabric.util.array.min(b);b=fabric.util.array.max(b);return{left:d,top:a,width:c,height:Math.abs(a-b)}},invertTransform:function(a){var c=
1/(a[0]*a[3]-a[1]*a[2]),c=[c*a[3],-c*a[1],-c*a[2],c*a[0]];a=fabric.util.transformPoint({x:a[4],y:a[5]},c,!0);return c[4]=-a.x,c[5]=-a.y,c},toFixed:function(a,c){return parseFloat(Number(a).toFixed(c))},parseUnit:function(a,c){var d=/\D{0,2}$/.exec(a),b=parseFloat(a);switch(c||(c=fabric.Text.DEFAULT_SVG_FONT_SIZE),d[0]){case "mm":return b*fabric.DPI/25.4;case "cm":return b*fabric.DPI/2.54;case "in":return b*fabric.DPI;case "pt":return b*fabric.DPI/72;case "pc":return b*fabric.DPI/72*12;case "em":return b*
c;default:return b}},falseFunction:function(){return!1},getKlass:function(a,c){return a=fabric.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),fabric.util.resolveNamespace(c)[a]},resolveNamespace:function(a){if(!a)return fabric;a=a.split(".");for(var c=a.length,d=h||fabric.window,b=0;b<c;++b)d=d[a[b]];return d},loadImage:function(a,c,d,b){if(!a)return void(c&&c.call(d,a));var g=fabric.util.createImage();g.onload=function(){c&&c.call(d,g);g=g.onload=g.onerror=null};g.onerror=function(){fabric.log("Error loading "+
g.src);c&&c.call(d,null,!0);g=g.onload=g.onerror=null};0!==a.indexOf("data")&&b&&(g.crossOrigin=b);g.src=a},enlivenObjects:function(a,c,d,b){function g(){++f===m&&c&&c(e)}a=a||[];var e=[],f=0,m=a.length;return m?void a.forEach(function(a,c){if(!a||!a.type)return void g();var f=fabric.util.getKlass(a.type,d);f.async?f.fromObject(a,function(d,f){f||(e[c]=d,b&&b(a,e[c]));g()}):(e[c]=f.fromObject(a),b&&b(a,e[c]),g())}):void(c&&c(e))},groupSVGElements:function(a,c,d){var b;return b=new fabric.PathGroup(a,
c),"undefined"!=typeof d&&b.setSourcePath(d),b},populateWithProperties:function(a,c,d){if(d&&"[object Array]"===Object.prototype.toString.call(d))for(var b=0,g=d.length;b<g;b++)d[b]in a&&(c[d[b]]=a[d[b]])},drawDashedLine:function(a,c,d,b,g,h){b-=c;var m=g-d;g=f(b*b+m*m);b=e(m,b);var m=h.length,k=0,p=!0;a.save();a.translate(c,d);a.moveTo(0,0);a.rotate(b);for(c=0;g>c;)c+=h[k++%m],c>g&&(c=g),a[p?"lineTo":"moveTo"](c,0),p=!p;a.restore()},createCanvasElement:function(a){return a||(a=fabric.document.createElement("canvas")),
a.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(a),a},createImage:function(){return fabric.isLikelyNode?new (require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(a){a=a.prototype;for(var c=a.stateProperties.length;c--;){var d=a.stateProperties[c],b=d.charAt(0).toUpperCase()+d.slice(1),g="set"+b,b="get"+b;a[b]||(a[b]=new Function('return this.get("'+d+'")'));a[g]||(a[g]=new Function("value",'return this.set("'+d+'", value)'))}},
clipContext:function(a,c){c.save();c.beginPath();a.clipTo(c);c.clip()},multiplyTransformMatrices:function(a,c,d){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],d?0:a[0]*c[4]+a[2]*c[5]+a[4],d?0:a[1]*c[4]+a[3]*c[5]+a[5]]},qrDecompose:function(a){var c=e(a[1],a[0]),g=b(a[0],2)+b(a[1],2),h=f(g),p=(a[0]*a[3]-a[2]*a[1])/h,g=e(a[0]*a[2]+a[1]*a[3],g);return{angle:c/d,scaleX:h,scaleY:p,skewX:g/d,skewY:0,translateX:a[4],translateY:a[5]}},customTransformMatrix:function(a,
c,b){b=[1,0,g(Math.tan(b*d)),1];a=[g(a),0,0,g(c)];return fabric.util.multiplyTransformMatrices(a,b,!0)},resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.skewX=0;a.skewY=0;a.flipX=!1;a.flipY=!1;a.setAngle(0)},getFunctionBody:function(a){return(String(a).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(a,c,d,b){0<b&&(c>b?c-=b:c=0,d>b?d-=b:d=0);var g=!0;a=a.getImageData(c,d,2*b||1,2*b||1);c=3;for(d=a.data.length;c<d&&(g=0>=a.data[c],!1!==g);c+=4);return g},parsePreserveAspectRatioAttribute:function(a){var c,
d="meet",b="Mid",g="Mid";a=a.split(" ");return a&&a.length&&(d=a.pop(),"meet"!==d&&"slice"!==d?(c=d,d="meet"):a.length&&(c=a.pop())),b="none"!==c?c.slice(1,4):"none",g="none"!==c?c.slice(5,8):"none",{meetOrSlice:d,alignX:b,alignY:g}},clearFabricFontCache:function(a){a?fabric.charWidthsCache[a]&&delete fabric.charWidthsCache[a]:fabric.charWidthsCache={}}}})("undefined"!=typeof exports?exports:this);
(function(){function h(a,d,b,h,n,t,r){var m=c.call(arguments);if(g[m])return g[m];var k=Math.PI,p=r*k/180,q=Math.sin(p),p=Math.cos(p),x=0,z=0;b=Math.abs(b);h=Math.abs(h);var w=-p*a*.5-q*d*.5,B=-p*d*.5+q*a*.5,C=b*b,E=h*h,I=B*B,J=w*w,D=C*E-C*I-E*J,N=0;0>D?(C=Math.sqrt(1-D/(C*E)),b*=C,h*=C):N=(n===t?-1:1)*Math.sqrt(D/(C*I+E*J));I=N*b*B/h;J=-N*h*w/b;N=p*I-q*J+.5*a;C=q*I+p*J+.5*d;E=e(1,0,(w-I)/b,(B-J)/h);B=e((w-I)/b,(B-J)/h,(-w-I)/b,(-B-J)/h);0===t&&0<B?B-=2*k:1===t&&0>B&&(B+=2*k);k=Math.ceil(Math.abs(B/
k*2));w=[];B/=k;I=8/3*Math.sin(B/4)*Math.sin(B/4)/Math.sin(B/2);J=E+B;for(D=0;D<k;D++)w[D]=f(E,J,p,q,b,h,N,C,I,x,z),x=w[D][4],z=w[D][5],E=J,J+=B;return g[m]=w,w}function f(a,b,g,e,f,h,r,u,A,y,v){var m=c.call(arguments);if(d[m])return d[m];var k=Math.cos(a),p=Math.sin(a),n=Math.cos(b),q=Math.sin(b),t=g*f*n-e*h*q+r,I=e*f*n+g*h*q+u;return d[m]=[y+A*(-g*f*p-e*h*k),v+A*(-e*f*p+g*h*k),t+A*(g*f*q+e*h*n),I+A*(e*f*q-g*h*n),t,I],d[m]}function e(a,c,d,b){a=Math.atan2(c,a);d=Math.atan2(b,d);return d>=a?d-a:2*
Math.PI-(a-d)}function b(d,b,g,e,f,h,r,u){var m=c.call(arguments);if(a[m])return a[m];var k,p,n,q,t,B,C,E=Math.sqrt,I=Math.min,J=Math.max,D=Math.abs,N=[],O=[[],[]];p=6*d-12*g+6*f;k=-3*d+9*g-9*f+3*r;n=3*g-3*d;for(var G=0;2>G;++G)(0<G&&(p=6*b-12*e+6*h,k=-3*b+9*e-9*h+3*u,n=3*e-3*b),1E-12>D(k))?1E-12>D(p)||(q=-n/p,0<q&&1>q&&N.push(q)):(q=p*p-4*n*k,0>q||(C=E(q),t=(-p+C)/(2*k),0<t&&1>t&&N.push(t),B=(-p-C)/(2*k),0<B&&1>B&&N.push(B)));for(p=k=N.length;k--;)q=N[k],t=1-q,n=t*t*t*d+3*t*t*q*g+3*t*q*q*f+q*q*q*
r,O[0][k]=n,q=t*t*t*b+3*t*t*q*e+3*t*q*q*h+q*q*q*u,O[1][k]=q;O[0][p]=d;O[1][p]=b;O[0][p+1]=r;O[1][p+1]=u;I=[{x:I.apply(null,O[0]),y:I.apply(null,O[1])},{x:J.apply(null,O[0]),y:J.apply(null,O[1])}];return a[m]=I,I}var g={},d={},a={},c=Array.prototype.join;fabric.util.drawArc=function(a,c,d,b){var g=[[],[],[],[]];b=h(b[5]-c,b[6]-d,b[0],b[1],b[3],b[4],b[2]);for(var e=0,f=b.length;e<f;e++)g[e][0]=b[e][0]+c,g[e][1]=b[e][1]+d,g[e][2]=b[e][2]+c,g[e][3]=b[e][3]+d,g[e][4]=b[e][4]+c,g[e][5]=b[e][5]+d,a.bezierCurveTo.apply(a,
g[e])};fabric.util.getBoundsOfArc=function(a,c,d,g,e,f,r,u,A){var m=0,k=0,p=[];d=h(u-a,A-c,d,g,f,r,e);g=[[],[]];e=0;for(f=d.length;e<f;e++)m=b(m,k,d[e][0],d[e][1],d[e][2],d[e][3],d[e][4],d[e][5]),g[0].x=m[0].x+a,g[0].y=m[0].y+c,g[1].x=m[1].x+a,g[1].y=m[1].y+c,p.push(g[0]),p.push(g[1]),m=d[e][4],k=d[e][5];return p};fabric.util.getBoundsOfCurve=b})();
(function(){function h(e,b,g){if(e&&0!==e.length){var d=e.length-1,a=b?e[d][b]:e[d];if(b)for(;d--;)g(e[d][b],a)&&(a=e[d][b]);else for(;d--;)g(e[d],a)&&(a=e[d]);return a}}var f=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(void 0===this||null===this)throw new TypeError;var b=Object(this),g=b.length>>>0;if(0===g)return-1;var d=0;if(0<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==Number.POSITIVE_INFINITY&&d!==Number.NEGATIVE_INFINITY&&(d=(0<d||
-1)*Math.floor(Math.abs(d)))),d>=g)return-1;for(d=0<=d?d:Math.max(g-Math.abs(d),0);d<g;d++)if(d in b&&b[d]===e)return d;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(e,b){for(var g=0,d=this.length>>>0;g<d;g++)g in this&&e.call(b,this[g],g,this)});Array.prototype.map||(Array.prototype.map=function(e,b){for(var g=[],d=0,a=this.length>>>0;d<a;d++)d in this&&(g[d]=e.call(b,this[d],d,this));return g});Array.prototype.every||(Array.prototype.every=function(e,b){for(var g=0,d=this.length>>>
0;g<d;g++)if(g in this&&!e.call(b,this[g],g,this))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(e,b){for(var g=0,d=this.length>>>0;g<d;g++)if(g in this&&e.call(b,this[g],g,this))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(e,b){for(var g,d=[],a=0,c=this.length>>>0;a<c;a++)a in this&&(g=this[a],e.call(b,g,a,this)&&d.push(g));return d});Array.prototype.reduce||(Array.prototype.reduce=function(e){var b,g=this.length>>>0,d=0;if(1<arguments.length)b=
arguments[1];else for(;;){if(d in this){b=this[d++];break}if(++d>=g)throw new TypeError;}for(;d<g;d++)d in this&&(b=e.call(null,b,this[d],d,this));return b});fabric.util.array={fill:function(e,b){for(var g=e.length;g--;)e[g]=b;return e},invoke:function(e,b){for(var g=f.call(arguments,2),d=[],a=0,c=e.length;a<c;a++)d[a]=g.length?e[a][b].apply(e[a],g):e[a][b].call(e[a]);return d},min:function(e,b){return h(e,b,function(b,d){return b<d})},max:function(e,b){return h(e,b,function(b,d){return b>=d})}}})();
(function(){function h(f,e){for(var b in e)f[b]=e[b];return f}fabric.util.object={extend:h,clone:function(f){return h({},f)}}})();
(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});fabric.util.string={camelize:function(h){return h.replace(/-+(.)?/g,function(f,e){return e?e.toUpperCase():""})},capitalize:function(h,f){return h.charAt(0).toUpperCase()+(f?h.slice(1):h.slice(1).toLowerCase())},escapeXml:function(h){return h.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();
(function(){var h=Array.prototype.slice,f=Function.prototype.apply,e=function(){};Function.prototype.bind||(Function.prototype.bind=function(b){var g,d=this,a=h.call(arguments,1);return g=a.length?function(){return f.call(d,this instanceof e?this:b,a.concat(h.call(arguments)))}:function(){return f.call(d,this instanceof e?this:b,arguments)},e.prototype=this.prototype,g.prototype=new e,g})})();
(function(){function h(){}function f(a){var c=this.constructor.superclass.prototype[a];return 1<arguments.length?c.apply(this,e.call(arguments,1)):c.call(this)}var e=Array.prototype.slice,b=function(){},g=function(){for(var a in{toString:1})if("toString"===a)return!1;return!0}(),d=function(a,c,d){for(var b in c)b in a.prototype&&"function"==typeof a.prototype[b]&&-1<(c[b]+"").indexOf("callSuper")?a.prototype[b]=function(a){return function(){var b=this.constructor.superclass;this.constructor.superclass=
d;var g=c[a].apply(this,arguments);if(this.constructor.superclass=b,"initialize"!==a)return g}}(b):a.prototype[b]=c[b],g&&(c.toString!==Object.prototype.toString&&(a.prototype.toString=c.toString),c.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=c.valueOf))};fabric.util.createClass=function(){function a(){this.initialize.apply(this,arguments)}var c=null,g=e.call(arguments,0);"function"==typeof g[0]&&(c=g.shift());a.superclass=c;a.subclasses=[];c&&(h.prototype=c.prototype,a.prototype=new h,
c.subclasses.push(a));for(var k=0,p=g.length;k<p;k++)d(a,g[k],c);return a.prototype.initialize||(a.prototype.initialize=b),a.prototype.constructor=a,a.prototype.callSuper=f,a}})();
(function(){function h(a){var c,d,b=Array.prototype.slice.call(arguments,1),g=b.length;for(d=0;d<g;d++)if(c=typeof a[b[d]],!/^(?:function|object|unknown)$/.test(c))return!1;return!0}function f(a,c){return function(d){c.call(g(a),d||fabric.window.event)}}function e(a,c){return function(d){if(n[a]&&n[a][c])for(var b=n[a][c],g=0,e=b.length;g<e;g++)b[g].call(this,d||fabric.window.event)}}function b(a,c,d){var b="touchend"===a.type?"changedTouches":"touches";return a[b]&&a[b][0]?a[b][0][c]-(a[b][0][c]-
a[b][0][d])||a[d]:a[d]}var g,d,a=function(){var a=0;return function(c){return c.__uniqueID||(c.__uniqueID="uniqueID__"+a++)}}();!function(){var a={};g=function(c){return a[c]};d=function(c,d){a[c]=d}}();var c,m,k=h(fabric.document.documentElement,"addEventListener","removeEventListener")&&h(fabric.window,"addEventListener","removeEventListener"),p=h(fabric.document.documentElement,"attachEvent","detachEvent")&&h(fabric.window,"attachEvent","detachEvent"),q={},n={};k?(c=function(a,c,d){a.addEventListener(c,
d,!1)},m=function(a,c,d){a.removeEventListener(c,d,!1)}):p?(c=function(c,b,g){var e=a(c);d(e,c);q[e]||(q[e]={});q[e][b]||(q[e][b]=[]);g={handler:g,wrappedHandler:f(e,g)};q[e][b].push(g);c.attachEvent("on"+b,g.wrappedHandler)},m=function(c,d,b){var g,e=a(c);if(q[e]&&q[e][d])for(var f=0,h=q[e][d].length;f<h;f++)(g=q[e][d][f])&&g.handler===b&&(c.detachEvent("on"+d,g.wrappedHandler),q[e][d][f]=null)}):(c=function(c,d,b){var g=a(c);if(n[g]||(n[g]={}),!n[g][d]){n[g][d]=[];var f=c["on"+d];f&&n[g][d].push(f);
c["on"+d]=e(g,d)}n[g][d].push(b)},m=function(c,d,b){c=a(c);if(n[c]&&n[c][d]){d=n[c][d];c=0;for(var g=d.length;c<g;c++)d[c]===b&&d.splice(c,1)}});fabric.util.addListener=c;fabric.util.removeListener=m;var t=function(a){return"unknown"!==typeof a.clientX?a.clientX:0},r=function(a){return"unknown"!==typeof a.clientY?a.clientY:0};fabric.isTouchSupported&&(t=function(a){return b(a,"pageX","clientX")},r=function(a){return b(a,"pageY","clientY")});fabric.util.getPointer=function(a){a||(a=fabric.window.event);
var c=fabric.util.getScrollLeftTop(a.target||("unknown"!==typeof a.srcElement?a.srcElement:null));return{x:t(a)+c.left,y:r(a)+c.top}};fabric.util.object.extend(fabric.util,fabric.Observable)})();
(function(){var h=fabric.document.createElement("div"),f="string"==typeof h.style.filter,e=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,b=function(b){return b};"string"==typeof h.style.opacity?b=function(b,d){return b.style.opacity=d,b}:f&&(b=function(b,d){var a=b.style;return b.currentStyle&&!b.currentStyle.hasLayout&&(a.zoom=1),e.test(a.filter)?(d=.9999<=d?"":"alpha(opacity="+100*d+")",a.filter=a.filter.replace(e,d)):a.filter+=" alpha(opacity="+100*d+")",b});fabric.util.setStyle=function(g,d){var a=
g.style;if(!a)return g;if("string"==typeof d)return g.style.cssText+=";"+d,-1<d.indexOf("opacity")?b(g,d.match(/opacity:\s*(\d?\.?\d*)/)[1]):g;for(var c in d)"opacity"===c?b(g,d[c]):a["float"===c||"cssFloat"===c?"undefined"==typeof a.styleFloat?"cssFloat":"styleFloat":c]=d[c];return g}})();
(function(){function h(a,c){var d=fabric.document.createElement(a),b;for(b in c)"class"===b?d.className=c[b]:"for"===b?d.htmlFor=c[b]:d.setAttribute(b,c[b]);return d}function f(a){for(var c=0,d=0,b=fabric.document.documentElement,g=fabric.document.body||{scrollLeft:0,scrollTop:0};a&&(a.parentNode||a.host)&&(a=a.parentNode||a.host,a===fabric.document?(c=g.scrollLeft||b.scrollLeft||0,d=g.scrollTop||b.scrollTop||0):(c+=a.scrollLeft||0,d+=a.scrollTop||0),1!==a.nodeType||"fixed"!==fabric.util.getElementStyle(a,
"position")););return{left:c,top:d}}var e,b=Array.prototype.slice,g=function(a){return b.call(a,0)};try{e=g(fabric.document.childNodes)instanceof Array}catch(a){}e||(g=function(a){for(var c=Array(a.length),d=a.length;d--;)c[d]=a[d];return c});var d;d=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(a,c){var d=fabric.document.defaultView.getComputedStyle(a,null);return d?d[c]:void 0}:function(a,c){var d=a.style[c];return!d&&a.currentStyle&&(d=a.currentStyle[c]),d};
(function(){var a=fabric.document.documentElement.style,c="userSelect"in a?"userSelect":"MozUserSelect"in a?"MozUserSelect":"WebkitUserSelect"in a?"WebkitUserSelect":"KhtmlUserSelect"in a?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=function(a){return"undefined"!=typeof a.onselectstart&&(a.onselectstart=fabric.util.falseFunction),c?a.style[c]="none":"string"==typeof a.unselectable&&(a.unselectable="on"),a};fabric.util.makeElementSelectable=function(a){return"undefined"!=typeof a.onselectstart&&
(a.onselectstart=null),c?a.style[c]="":"string"==typeof a.unselectable&&(a.unselectable=""),a}})();(function(){fabric.util.getScript=function(a,c){var d=fabric.document.getElementsByTagName("head")[0],b=fabric.document.createElement("script"),g=!0;b.onload=b.onreadystatechange=function(a){!g||"string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(g=!1,c(a||fabric.window.event),b=b.onload=b.onreadystatechange=null)};b.src=a;d.appendChild(b)}})();fabric.util.getById=
function(a){return"string"==typeof a?fabric.document.getElementById(a):a};fabric.util.toArray=g;fabric.util.makeElement=h;fabric.util.addClass=function(a,c){a&&-1===(" "+a.className+" ").indexOf(" "+c+" ")&&(a.className+=(a.className?" ":"")+c)};fabric.util.wrapElement=function(a,c,d){return"string"==typeof c&&(c=h(c,d)),a.parentNode&&a.parentNode.replaceChild(c,a),c.appendChild(a),c};fabric.util.getScrollLeftTop=f;fabric.util.getElementOffset=function(a){var c,b,g=a&&a.ownerDocument,e={left:0,top:0},
h={left:0,top:0},n={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!g)return h;for(var t in n)h[n[t]]+=parseInt(d(a,t),10)||0;return c=g.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(e=a.getBoundingClientRect()),b=f(a),{left:e.left+b.left-(c.clientLeft||0)+h.left,top:e.top+b.top-(c.clientTop||0)+h.top}};fabric.util.getElementStyle=d})();
(function(){function h(b,g){return b+(/\?/.test(b)?"&":"?")+g}function f(){}var e=function(){for(var b=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],g=b.length;g--;)try{if(b[g]())return b[g]}catch(d){}}();fabric.util.request=function(b,g){g||(g={});var d=g.method?g.method.toUpperCase():"GET",a=g.onComplete||function(){},c=e(),m=g.body||
g.parameters;return c.onreadystatechange=function(){4===c.readyState&&(a(c),c.onreadystatechange=f)},"GET"===d&&(m=null,"string"==typeof g.parameters&&(b=h(b,g.parameters))),c.open(d,b,!0),"POST"!==d&&"PUT"!==d||c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(m),c}})();fabric.log=function(){};fabric.warn=function(){};
"undefined"!=typeof console&&["log","warn"].forEach(function(h){"undefined"!=typeof console[h]&&"function"==typeof console[h].apply&&(fabric[h]=function(){return console[h].apply(console,arguments)})});
(function(){function h(){return f.apply(fabric.window,arguments)}var f=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(e){fabric.window.setTimeout(e,1E3/60)};fabric.util.animate=function(e){h(function(b){e||(e={});var g,d=b||+new Date,a=e.duration||500,c=d+a,f=e.onChange||function(){},k=e.abort||function(){return!1},p=e.easing||function(a,c,
d,b){return-d*Math.cos(a/b*(Math.PI/2))+d+c},q="startValue"in e?e.startValue:0;b="endValue"in e?e.endValue:100;var n=e.byValue||b-q;e.onStart&&e.onStart();(function r(b){g=b||+new Date;b=g>c?a:g-d;return k()?void(e.onComplete&&e.onComplete()):(f(p(b,q,n,a)),g>c?void(e.onComplete&&e.onComplete()):void h(r))})(d)})};fabric.util.requestAnimFrame=h})();
(function(){function h(b,d,a,c){return b<Math.abs(d)?(b=d,c=a/4):c=0===d&&0===b?a/(2*Math.PI)*Math.asin(1):a/(2*Math.PI)*Math.asin(d/b),{a:b,c:d,p:a,s:c}}function f(b,d,a){return b.a*Math.pow(2,10*--d)*Math.sin(2*(d*a-b.s)*Math.PI/b.p)}function e(g,d,a,c){return a-b(c-g,0,a,c)+d}function b(b,d,a,c){return(b/=c)<1/2.75?7.5625*a*b*b+d:b<2/2.75?a*(7.5625*(b-=1.5/2.75)*b+.75)+d:b<2.5/2.75?a*(7.5625*(b-=2.25/2.75)*b+.9375)+d:a*(7.5625*(b-=2.625/2.75)*b+.984375)+d}fabric.util.ease={easeInQuad:function(b,
d,a,c){return a*(b/=c)*b+d},easeOutQuad:function(b,d,a,c){return-a*(b/=c)*(b-2)+d},easeInOutQuad:function(b,d,a,c){return b/=c/2,1>b?a/2*b*b+d:-a/2*(--b*(b-2)-1)+d},easeInCubic:function(b,d,a,c){return a*(b/=c)*b*b+d},easeOutCubic:function(b,d,a,c){return a*((b=b/c-1)*b*b+1)+d},easeInOutCubic:function(b,d,a,c){return b/=c/2,1>b?a/2*b*b*b+d:a/2*((b-=2)*b*b+2)+d},easeInQuart:function(b,d,a,c){return a*(b/=c)*b*b*b+d},easeOutQuart:function(b,d,a,c){return-a*((b=b/c-1)*b*b*b-1)+d},easeInOutQuart:function(b,
d,a,c){return b/=c/2,1>b?a/2*b*b*b*b+d:-a/2*((b-=2)*b*b*b-2)+d},easeInQuint:function(b,d,a,c){return a*(b/=c)*b*b*b*b+d},easeOutQuint:function(b,d,a,c){return a*((b=b/c-1)*b*b*b*b+1)+d},easeInOutQuint:function(b,d,a,c){return b/=c/2,1>b?a/2*b*b*b*b*b+d:a/2*((b-=2)*b*b*b*b+2)+d},easeInSine:function(b,d,a,c){return-a*Math.cos(b/c*(Math.PI/2))+a+d},easeOutSine:function(b,d,a,c){return a*Math.sin(b/c*(Math.PI/2))+d},easeInOutSine:function(b,d,a,c){return-a/2*(Math.cos(Math.PI*b/c)-1)+d},easeInExpo:function(b,
d,a,c){return 0===b?d:a*Math.pow(2,10*(b/c-1))+d},easeOutExpo:function(b,d,a,c){return b===c?d+a:a*(-Math.pow(2,-10*b/c)+1)+d},easeInOutExpo:function(b,d,a,c){return 0===b?d:b===c?d+a:(b/=c/2,1>b?a/2*Math.pow(2,10*(b-1))+d:a/2*(-Math.pow(2,-10*--b)+2)+d)},easeInCirc:function(b,d,a,c){return-a*(Math.sqrt(1-(b/=c)*b)-1)+d},easeOutCirc:function(b,d,a,c){return a*Math.sqrt(1-(b=b/c-1)*b)+d},easeInOutCirc:function(b,d,a,c){return b/=c/2,1>b?-a/2*(Math.sqrt(1-b*b)-1)+d:a/2*(Math.sqrt(1-(b-=2)*b)+1)+d},
easeInElastic:function(b,d,a,c){var e=0;if(0===b)return d;if(b/=c,1===b)return d+a;e||(e=.3*c);a=h(a,a,e,1.70158);return-f(a,b,c)+d},easeOutElastic:function(b,d,a,c){var e=0;if(0===b)return d;if(b/=c,1===b)return d+a;e||(e=.3*c);a=h(a,a,e,1.70158);return a.a*Math.pow(2,-10*b)*Math.sin(2*(b*c-a.s)*Math.PI/a.p)+a.c+d},easeInOutElastic:function(b,d,a,c){var e=0;if(0===b)return d;if(b/=c/2,2===b)return d+a;e||(e=.3*c*1.5);a=h(a,a,e,1.70158);return 1>b?-.5*f(a,b,c)+d:a.a*Math.pow(2,-10*--b)*Math.sin(2*
(b*c-a.s)*Math.PI/a.p)*.5+a.c+d},easeInBack:function(b,d,a,c,e){return void 0===e&&(e=1.70158),a*(b/=c)*b*((e+1)*b-e)+d},easeOutBack:function(b,d,a,c,e){return void 0===e&&(e=1.70158),a*((b=b/c-1)*b*((e+1)*b+e)+1)+d},easeInOutBack:function(b,d,a,c,e){return void 0===e&&(e=1.70158),b/=c/2,1>b?a/2*b*b*(((e*=1.525)+1)*b-e)+d:a/2*((b-=2)*b*(((e*=1.525)+1)*b+e)+2)+d},easeInBounce:e,easeOutBounce:b,easeInOutBounce:function(g,d,a,c){return g<c/2?.5*e(2*g,0,a,c)+d:.5*b(2*g-c,0,a,c)+.5*a+d}}})();
(function(h){function f(a){return a in C?C[a]:a}function e(a,c,d,b){var e,g="[object Array]"===Object.prototype.toString.call(c);return"fill"!==a&&"stroke"!==a||"none"!==c?"strokeDashArray"===a?c=c.replace(/,/g," ").split(/\s+/).map(function(a){return parseFloat(a)}):"transformMatrix"===a?c=d&&d.transformMatrix?v(d.transformMatrix,n.parseTransformAttribute(c)):n.parseTransformAttribute(c):"visible"===a?(c="none"!==c&&"hidden"!==c,d&&!1===d.visible&&(c=!1)):"originX"===a?c="start"===c?"left":"end"===
c?"right":"center":e=g?c.map(y):y(c,b):c="",!g&&isNaN(e)?c:e}function b(a){for(var c in E)if("undefined"!=typeof a[E[c]]&&""!==a[c]){if("undefined"==typeof a[c]){if(!n.Object.prototype[c])continue;a[c]=n.Object.prototype[c]}if(0!==a[c].indexOf("url(")){var d=new n.Color(a[c]);a[c]=d.setAlpha(A(d.getAlpha()*a[E[c]],2)).toRgba()}}return a}function g(a,c){for(var d,b=[],e=0;e<c.length;e++)d=c[e],d=a.getElementsByTagName(d),b=b.concat(Array.prototype.slice.call(d));return b}function d(a,c){var d,b;a.replace(/;\s*$/,
"").split(";").forEach(function(a){a=a.split(":");d=f(a[0].trim().toLowerCase());b=e(d,a[1].trim());c[d]=b})}function a(a,d){var b={},e;for(e in n.cssRules[d]){var g,f=a,h=e.split(" "),m=!0;if((g=c(f,h.pop()))&&h.length){for(var m=void 0,k=h,p=!0;f.parentNode&&1===f.parentNode.nodeType&&k.length;)p&&(m=k.pop()),f=f.parentNode,p=c(f,m);m=0===k.length}if(g&&m&&0===h.length)for(var r in n.cssRules[d][e])b[r]=n.cssRules[d][e][r]}return b}function c(a,c){var d,b=a.nodeName,e=a.getAttribute("class"),g=
a.getAttribute("id");if(d=new RegExp("^"+b,"i"),c=c.replace(d,""),g&&c.length&&(d=new RegExp("#"+g+"(?![a-zA-Z\\-]+)","i"),c=c.replace(d,"")),e&&c.length)for(e=e.split(" "),b=e.length;b--;)d=new RegExp("\\."+e[b]+"(?![a-zA-Z\\-]+)","i"),c=c.replace(d,"");return 0===c.length}function m(a){for(var c=g(a,["use","svg:use"]),d=0;c.length&&d<c.length;){var b,e,f,h,m=c[d];f=m.getAttribute("xlink:href").substr(1);b=m.getAttribute("x")||0;e=m.getAttribute("y")||0;var p;a:{h=p=void 0;var r=a;if(r.getElementById&&
(h=r.getElementById(f)),h)p=h;else{r=r.getElementsByTagName("*");for(h=0;h<r.length;h++)if(p=r[h],f===p.getAttribute("id"))break a;p=void 0}}p=p.cloneNode(!0);var r=(p.getAttribute("transform")||"")+" translate("+b+", "+e+")",n=c.length;if(k(p),/^svg$/i.test(p.nodeName)){var q=p.ownerDocument.createElement("g");e=0;f=p.attributes;for(h=f.length;e<h;e++)b=f.item(e),q.setAttribute(b.nodeName,b.nodeValue);for(;null!=p.firstChild;)q.appendChild(p.firstChild);p=q}e=0;f=m.attributes;for(h=f.length;e<h;e++)b=
f.item(e),"x"!==b.nodeName&&"y"!==b.nodeName&&"xlink:href"!==b.nodeName&&("transform"===b.nodeName?r=b.nodeValue+" "+r:p.setAttribute(b.nodeName,b.nodeValue));p.setAttribute("transform",r);p.setAttribute("instantiated_by_use","1");p.removeAttribute("id");m.parentNode.replaceChild(p,m);c.length===n&&d++}}function k(a){var c,d,b,e=a.getAttribute("viewBox"),g=1,f=1,h=0,m=0,k=a.getAttribute("width"),p=a.getAttribute("height"),r=a.getAttribute("x")||0,q=a.getAttribute("y")||0,u=a.getAttribute("preserveAspectRatio")||
"",t=!e||!z.test(a.nodeName)||!(e=e.match(I)),A=!k||!p||"100%"===k||"100%"===p,w=t&&A,v={};b="";if(v.width=0,v.height=0,v.toBeParsed=w,w)return v;if(t)return v.width=y(k),v.height=y(p),v;if(h=-parseFloat(e[1]),m=-parseFloat(e[2]),c=parseFloat(e[3]),d=parseFloat(e[4]),A?(v.width=c,v.height=d):(v.width=y(k),v.height=y(p),g=v.width/c,f=v.height/d),u=n.util.parsePreserveAspectRatioAttribute(u),"none"!==u.alignX&&(f=g=g>f?f:g),1===g&&1===f&&0===h&&0===m&&0===r&&0===q)return v;if((r||q)&&(b=" translate("+
y(r)+" "+y(q)+") "),c=b+" matrix("+g+" 0 0 "+f+" "+h*g+" "+m*f+") ","svg"===a.nodeName){for(b=a.ownerDocument.createElement("g");null!=a.firstChild;)b.appendChild(a.firstChild);a.appendChild(b)}else b=a,c=b.getAttribute("transform")+c;return b.setAttribute("transform",c),v}function p(a){var c=a.objects;a=a.options;return c=c.map(function(a){return n[r(a.type)].fromObject(a)}),{objects:c,options:a}}function q(a,c,d){c[d]&&c[d].toSVG&&a.push('\t<pattern x="0" y="0" id="',d,'Pattern" ','width="',c[d].source.width,
'" height="',c[d].source.height,'" patternUnits="userSpaceOnUse">\n','\t\t<image x="0" y="0" ','width="',c[d].source.width,'" height="',c[d].source.height,'" xlink:href="',c[d].source.src,'"></image>\n\t</pattern>\n')}var n=h.fabric||(h.fabric={}),t=n.util.object.extend,r=n.util.string.capitalize,u=n.util.object.clone,A=n.util.toFixed,y=n.util.parseUnit,v=n.util.multiplyTransformMatrices,x=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/i,z=/^(symbol|image|marker|pattern|view|svg)$/i,
w=/^(?:pattern|defs|symbol|metadata)$/i,B=/^(symbol|g|a|svg)$/i,C={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity",
"stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},E={stroke:"strokeOpacity",fill:"fillOpacity"};n.cssRules={};n.gradientDefs={};n.parseTransformAttribute=function(){function a(a,c){var d=c[0],b=3===c.length?c[1]:0,e=3===c.length?c[2]:0;a[0]=Math.cos(d);a[1]=Math.sin(d);a[2]=-Math.sin(d);a[3]=Math.cos(d);a[4]=b-(a[0]*b+a[2]*e);a[5]=e-(a[1]*b+a[3]*e)}function c(a,c){var d=2===c.length?c[1]:c[0];a[0]=c[0];a[3]=d}function d(a,c){a[4]=c[0];2===c.length&&(a[5]=c[1])}
var b=[1,0,0,1,0,0],e=n.reNum,g="(?:"+("(?:(matrix)\\s*\\(\\s*("+e+")(?:\\s+,?\\s*|,\\s*)("+e+")(?:\\s+,?\\s*|,\\s*)("+e+")(?:\\s+,?\\s*|,\\s*)("+e+")(?:\\s+,?\\s*|,\\s*)("+e+")(?:\\s+,?\\s*|,\\s*)("+e+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+e+")(?:(?:\\s+,?\\s*|,\\s*)("+e+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+e+")(?:(?:\\s+,?\\s*|,\\s*)("+e+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+e+")(?:(?:\\s+,?\\s*|,\\s*)("+e+")(?:\\s+,?\\s*|,\\s*)("+e+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+
e+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+e+")\\s*\\))")+")",f=new RegExp("^\\s*(?:"+("(?:"+g+"(?:(?:\\s+,?\\s*|,\\s*)*"+g+")*)")+"?)\\s*$"),h=new RegExp(g,"g");return function(e){var m=b.concat(),k=[];if(!e||e&&!f.test(e))return m;e.replace(h,function(e){var f=(new RegExp(g)).exec(e).filter(function(a){return""!==a&&null!=a});e=f[1];f=f.slice(2).map(parseFloat);switch(e){case "translate":d(m,f);break;case "rotate":f[0]=n.util.degreesToRadians(f[0]);a(m,f);break;case "scale":c(m,f);break;case "skewX":m[2]=
Math.tan(n.util.degreesToRadians(f[0]));break;case "skewY":m[1]=Math.tan(n.util.degreesToRadians(f[0]));break;case "matrix":m=f}k.push(m.concat());m=b.concat()});for(e=k[0];1<k.length;)k.shift(),e=n.util.multiplyTransformMatrices(e,k[0]);return e}}();var I=new RegExp("^\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*$");n.parseSVGDocument=function(){return function(a,c,d){if(a){m(a);var b=new Date,e=n.Object.__uid++,g=k(a),f=n.util.toArray(a.getElementsByTagName("*"));
if(g.svgUid=e,0===f.length&&n.isLikelyNode){for(var f=a.selectNodes('//*[name(.)!="svg"]'),h=[],p=0,r=f.length;p<r;p++)h[p]=f[p];f=h}f=f.filter(function(a){k(a);var c;if(c=x.test(a.nodeName.replace("svg:",""))){a:{for(;a&&(a=a.parentNode);)if(a.nodeName&&w.test(a.nodeName.replace("svg:",""))&&!a.getAttribute("instantiated_by_use")){a=!0;break a}a=!1}c=!a}return c});if(!f||f&&!f.length)return void(c&&c([],{}));n.gradientDefs[e]=n.getGradientDefs(a);n.cssRules[e]=n.getCSSRules(a);n.parseElements(f,
function(a){n.documentParsingTime=new Date-b;c&&c(a,g)},u(g),d)}}}();var J={has:function(a,c){c(!1)},get:function(){},set:function(){}},D=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+n.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+n.reNum+"))?\\s+(.*)");t(n,{parseFontDeclaration:function(a,c){var d=a.match(D);if(d){var b=d[1],e=d[3],g=d[4],f=d[5],d=d[6];b&&(c.fontStyle=b);e&&(c.fontWeight=isNaN(parseFloat(e))?e:
parseFloat(e));g&&(c.fontSize=y(g));d&&(c.fontFamily=d);f&&(c.lineHeight="normal"===f?1:f)}},getGradientDefs:function(a){var c,d,b=g(a,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),e,f={},h={};for(e=b.length;e--;)a=b[e],d=a.getAttribute("xlink:href"),c=a.getAttribute("id"),d&&(h[c]=d.substr(1)),f[c]=a;for(c in h)for(d=f[h[c]].cloneNode(!0),a=f[c];d.firstChild;)a.appendChild(d.firstChild);return f},parseAttributes:function(c,d,g){if(c){var h,m,k={};"undefined"==typeof g&&
(g=c.getAttribute("svgUid"));c.parentNode&&B.test(c.parentNode.nodeName)&&(k=n.parseAttributes(c.parentNode,d,g));m=k&&k.fontSize||c.getAttribute("font-size")||n.Text.DEFAULT_SVG_FONT_SIZE;d=d.reduce(function(a,d){return h=c.getAttribute(d),h&&(d=f(d),h=e(d,h,k,m),a[d]=h),a},{});return d=t(d,t(a(c,g),n.parseStyleAttribute(c))),d.font&&n.parseFontDeclaration(d.font,d),b(t(k,d))}},parseElements:function(a,c,d,b){(new n.ElementsParser(a,c,d,b)).parse()},parseStyleAttribute:function(a){var c={};if(a=
a.getAttribute("style"))if("string"==typeof a)d(a,c);else{var b,g,h;for(h in a)"undefined"!=typeof a[h]&&(b=f(h.toLowerCase()),g=e(b,a[h]),c[b]=g)}return c},parsePointsAttribute:function(a){if(!a)return null;a=a.replace(/,/g," ").trim();a=a.split(/\s+/);var c,d,b=[];c=0;for(d=a.length;c<d;c+=2)b.push({x:parseFloat(a[c]),y:parseFloat(a[c+1])});return b},getCSSRules:function(a){var c;a=a.getElementsByTagName("style");for(var d={},b=0,g=a.length;b<g;b++){var h=a[b].textContent||a[b].text,h=h.replace(/\/\*[\s\S]*?\*\//g,
"");""!==h.trim()&&(c=h.match(/[^{]*\{[\s\S]*?\}/g),c=c.map(function(a){return a.trim()}),c.forEach(function(a){a=a.match(/([\s\S]*?)\s*\{([^}]*)\}/);for(var c={},b=a[2].trim().replace(/;$/,"").split(/\s*;\s*/),g=0,h=b.length;g<h;g++){var m=b[g].split(/\s*:\s*/),k=f(m[0]),m=e(k,m[1],m[0]);c[k]=m}a=a[1];a.split(",").forEach(function(a){a=a.replace(/^svg/i,"").trim();""!==a&&(d[a]?n.util.object.extend(d[a],c):d[a]=n.util.object.clone(c))})}))}return d},loadSVGFromURL:function(a,c,d){function b(b){var e=
b.responseXML;e&&!e.documentElement&&n.window.ActiveXObject&&b.responseText&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(b.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));e&&e.documentElement||c&&c(null);n.parseSVGDocument(e.documentElement,function(d,b){J.set(a,{objects:n.util.array.invoke(d,"toObject"),options:b});c&&c(d,b)},d)}a=a.replace(/^\n\s*/,"").trim();J.has(a,function(d){d?J.get(a,function(a){a=p(a);c(a.objects,a.options)}):new n.util.request(a,{method:"get",
onComplete:b})})},loadSVGFromString:function(a,c,d){a=a.trim();var b;if("undefined"!=typeof DOMParser){var e=new DOMParser;e&&e.parseFromString&&(b=e.parseFromString(a,"text/xml"))}else n.window.ActiveXObject&&(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));n.parseSVGDocument(b.documentElement,function(a,d){c(a,d)},d)},createSVGFontFacesMarkup:function(a){for(var c,d,b,e,g,f,h="",m={},k=n.fontPaths,p=0,r=a.length;p<r;p++)if(c=
a[p],d=c.fontFamily,-1!==c.type.indexOf("text")&&!m[d]&&k[d]&&(m[d]=!0,c.styles))for(g in b=c.styles,b)for(f in e=b[g],e)d=e[f],d=d.fontFamily,!m[d]&&k[d]&&(m[d]=!0);for(var q in m)h+=["\t\t@font-face {\n\t\t\tfont-family: '",q,"';\n\t\t\tsrc: url('",k[q],"');\n\t\t}\n"].join("");return h&&(h=['\t<style type="text/css"><![CDATA[\n',h,"]]\x3e</style>\n"].join("")),h},createSVGRefElementsMarkup:function(a){var c=[];return q(c,a,"backgroundColor"),q(c,a,"overlayColor"),c.join("")}})})("undefined"!=typeof exports?
exports:this);fabric.ElementsParser=function(h,f,e,b){this.elements=h;this.callback=f;this.options=e;this.reviver=b;this.svgUid=e&&e.svgUid||0};fabric.ElementsParser.prototype.parse=function(){this.instances=Array(this.elements.length);this.numElements=this.elements.length;this.createObjects()};
fabric.ElementsParser.prototype.createObjects=function(){for(var h=0,f=this.elements.length;h<f;h++)this.elements[h].setAttribute("svgUid",this.svgUid),function(e,b){setTimeout(function(){e.createObject(e.elements[b],b)},0)}(this,h)};fabric.ElementsParser.prototype.createObject=function(h,f){var e=fabric[fabric.util.string.capitalize(h.tagName.replace("svg:",""))];if(e&&e.fromElement)try{this._createObject(e,h,f)}catch(b){fabric.log(b)}else this.checkIfDone()};
fabric.ElementsParser.prototype._createObject=function(h,f,e){h.async?h.fromElement(f,this.createCallback(e,f),this.options):(h=h.fromElement(f,this.options),this.resolveGradient(h,"fill"),this.resolveGradient(h,"stroke"),this.reviver&&this.reviver(f,h),this.instances[e]=h,this.checkIfDone())};fabric.ElementsParser.prototype.createCallback=function(h,f){var e=this;return function(b){e.resolveGradient(b,"fill");e.resolveGradient(b,"stroke");e.reviver&&e.reviver(f,b);e.instances[h]=b;e.checkIfDone()}};
fabric.ElementsParser.prototype.resolveGradient=function(h,f){var e=h.get(f);/^url\(/.test(e)&&(e=e.slice(5,e.length-1),fabric.gradientDefs[this.svgUid][e]&&h.set(f,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][e],h)))};fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(h){return null!=h}),this.callback(this.instances))};
(function(h){function f(e,b){this.x=e;this.y=b}h=h.fabric||(h.fabric={});return h.Point?void h.warn("fabric.Point is already defined"):(h.Point=f,void(f.prototype={type:"point",constructor:f,add:function(e){return new f(this.x+e.x,this.y+e.y)},addEquals:function(e){return this.x+=e.x,this.y+=e.y,this},scalarAdd:function(e){return new f(this.x+e,this.y+e)},scalarAddEquals:function(e){return this.x+=e,this.y+=e,this},subtract:function(e){return new f(this.x-e.x,this.y-e.y)},subtractEquals:function(e){return this.x-=
e.x,this.y-=e.y,this},scalarSubtract:function(e){return new f(this.x-e,this.y-e)},scalarSubtractEquals:function(e){return this.x-=e,this.y-=e,this},multiply:function(e){return new f(this.x*e,this.y*e)},multiplyEquals:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return new f(this.x/e,this.y/e)},divideEquals:function(e){return this.x/=e,this.y/=e,this},eq:function(e){return this.x===e.x&&this.y===e.y},lt:function(e){return this.x<e.x&&this.y<e.y},lte:function(e){return this.x<=e.x&&
this.y<=e.y},gt:function(e){return this.x>e.x&&this.y>e.y},gte:function(e){return this.x>=e.x&&this.y>=e.y},lerp:function(e,b){return"undefined"==typeof b&&(b=.5),new f(this.x+(e.x-this.x)*b,this.y+(e.y-this.y)*b)},distanceFrom:function(e){var b=this.x-e.x;e=this.y-e.y;return Math.sqrt(b*b+e*e)},midPointFrom:function(e){return this.lerp(e)},min:function(e){return new f(Math.min(this.x,e.x),Math.min(this.y,e.y))},max:function(e){return new f(Math.max(this.x,e.x),Math.max(this.y,e.y))},toString:function(){return this.x+
","+this.y},setXY:function(e,b){return this.x=e,this.y=b,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setFromPoint:function(e){return this.x=e.x,this.y=e.y,this},swap:function(e){var b=this.x,g=this.y;this.x=e.x;this.y=e.y;e.x=b;e.y=g},clone:function(){return new f(this.x,this.y)}}))})("undefined"!=typeof exports?exports:this);
(function(h){function f(b){this.status=b;this.points=[]}var e=h.fabric||(h.fabric={});return e.Intersection?void e.warn("fabric.Intersection is already defined"):(e.Intersection=f,e.Intersection.prototype={constructor:f,appendPoint:function(b){return this.points.push(b),this},appendPoints:function(b){return this.points=this.points.concat(b),this}},e.Intersection.intersectLineLine=function(b,g,d,a){var c,h=(a.x-d.x)*(b.y-d.y)-(a.y-d.y)*(b.x-d.x),k=(g.x-b.x)*(b.y-d.y)-(g.y-b.y)*(b.x-d.x);d=(a.y-d.y)*
(g.x-b.x)-(a.x-d.x)*(g.y-b.y);0!==d?(h/=d,k/=d,0<=h&&1>=h&&0<=k&&1>=k?(c=new f("Intersection"),c.appendPoint(new e.Point(b.x+h*(g.x-b.x),b.y+h*(g.y-b.y)))):c=new f):c=new f(0===h||0===k?"Coincident":"Parallel");return c},e.Intersection.intersectLinePolygon=function(b,e,d){for(var a,c,g=new f,h=d.length,p=0;p<h;p++)a=d[p],c=d[(p+1)%h],a=f.intersectLineLine(b,e,a,c),g.appendPoints(a.points);return 0<g.points.length&&(g.status="Intersection"),g},e.Intersection.intersectPolygonPolygon=function(b,e){for(var d=
new f,a=b.length,c=0;c<a;c++){var g=f.intersectLinePolygon(b[c],b[(c+1)%a],e);d.appendPoints(g.points)}return 0<d.points.length&&(d.status="Intersection"),d},void(e.Intersection.intersectPolygonRectangle=function(b,g,d){var a=g.min(d),c=g.max(d);d=new e.Point(c.x,a.y);var h=new e.Point(a.x,c.y);g=f.intersectLinePolygon(a,d,b);d=f.intersectLinePolygon(d,c,b);c=f.intersectLinePolygon(c,h,b);b=f.intersectLinePolygon(h,a,b);a=new f;return a.appendPoints(g.points),a.appendPoints(d.points),a.appendPoints(c.points),
a.appendPoints(b.points),0<a.points.length&&(a.status="Intersection"),a}))})("undefined"!=typeof exports?exports:this);
(function(h){function f(b){b?this._tryParsingColor(b):this.setSource([0,0,0,1])}function e(b,d,a){return 0>a&&(a+=1),1<a&&--a,a<1/6?b+6*(d-b)*a:.5>a?d:a<2/3?b+(d-b)*(2/3-a)*6:b}var b=h.fabric||(h.fabric={});return b.Color?void b.warn("fabric.Color is already defined."):(b.Color=f,b.Color.prototype={_tryParsingColor:function(b){var d;b in f.colorNameMap&&(b=f.colorNameMap[b]);"transparent"===b&&(d=[255,255,255,0]);d||(d=f.sourceFromHex(b));d||(d=f.sourceFromRgb(b));d||(d=f.sourceFromHsl(b));d||(d=
[0,0,0,1]);d&&this.setSource(d)},_rgbToHsl:function(e,d,a){e/=255;d/=255;a/=255;var c,g,f,h=b.util.array.max([e,d,a]);g=b.util.array.min([e,d,a]);if(f=(h+g)/2,h===g)c=g=0;else{var q=h-g;switch(g=.5<f?q/(2-h-g):q/(h+g),h){case e:c=(d-a)/q+(d<a?6:0);break;case d:c=(a-e)/q+2;break;case a:c=(e-d)/q+4}c/=6}return[Math.round(360*c),Math.round(100*g),Math.round(100*f)]},getSource:function(){return this._source},setSource:function(b){this._source=b},toRgb:function(){var b=this.getSource();return"rgb("+b[0]+
","+b[1]+","+b[2]+")"},toRgba:function(){var b=this.getSource();return"rgba("+b[0]+","+b[1]+","+b[2]+","+b[3]+")"},toHsl:function(){var b=this.getSource(),b=this._rgbToHsl(b[0],b[1],b[2]);return"hsl("+b[0]+","+b[1]+"%,"+b[2]+"%)"},toHsla:function(){var b=this.getSource(),d=this._rgbToHsl(b[0],b[1],b[2]);return"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+b[3]+")"},toHex:function(){var b,d,a,c=this.getSource();return b=c[0].toString(16),b=1===b.length?"0"+b:b,d=c[1].toString(16),d=1===d.length?"0"+d:d,a=c[2].toString(16),
a=1===a.length?"0"+a:a,b.toUpperCase()+d.toUpperCase()+a.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(b){var d=this.getSource();return d[3]=b,this.setSource(d),this},toGrayscale:function(){var b=this.getSource(),d=parseInt((.3*b[0]+.59*b[1]+.11*b[2]).toFixed(0),10);return this.setSource([d,d,d,b[3]]),this},toBlackWhite:function(b){var d=this.getSource(),a=(.3*d[0]+.59*d[1]+.11*d[2]).toFixed(0),d=d[3];return b=b||127,a=Number(a)<Number(b)?0:255,this.setSource([a,
a,a,d]),this},overlayWith:function(b){b instanceof f||(b=new f(b));var d=[],a=this.getAlpha(),c=this.getSource();b=b.getSource();for(var e=0;3>e;e++)d.push(Math.round(.5*c[e]+.5*b[e]));return d[3]=a,this.setSource(d),this}},b.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,b.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,b.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,
b.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",grey:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},b.Color.fromRgb=function(b){return f.fromSource(f.sourceFromRgb(b))},b.Color.sourceFromRgb=function(b){if(b=b.match(f.reRGBa)){var d=parseInt(b[1],10)/(/%$/.test(b[1])?100:1)*(/%$/.test(b[1])?
255:1),a=parseInt(b[2],10)/(/%$/.test(b[2])?100:1)*(/%$/.test(b[2])?255:1),c=parseInt(b[3],10)/(/%$/.test(b[3])?100:1)*(/%$/.test(b[3])?255:1);return[parseInt(d,10),parseInt(a,10),parseInt(c,10),b[4]?parseFloat(b[4]):1]}},b.Color.fromRgba=f.fromRgb,b.Color.fromHsl=function(b){return f.fromSource(f.sourceFromHsl(b))},b.Color.sourceFromHsl=function(b){if(b=b.match(f.reHSLa)){var d,a,c;c=(parseFloat(b[1])%360+360)%360/360;a=parseFloat(b[2])/(/%$/.test(b[2])?100:1);d=parseFloat(b[3])/(/%$/.test(b[3])?
100:1);if(0===a)d=a=c=d;else{var g=.5>=d?d*(a+1):d+a-d*a,h=2*d-g;d=e(h,g,c+1/3);a=e(h,g,c);c=e(h,g,c-1/3)}return[Math.round(255*d),Math.round(255*a),Math.round(255*c),b[4]?parseFloat(b[4]):1]}},b.Color.fromHsla=f.fromHsl,b.Color.fromHex=function(b){return f.fromSource(f.sourceFromHex(b))},b.Color.sourceFromHex=function(b){if(b.match(f.reHex)){var d=b.slice(b.indexOf("#")+1),a=3===d.length;b=a?d.charAt(0)+d.charAt(0):d.substring(0,2);var c=a?d.charAt(1)+d.charAt(1):d.substring(2,4),d=a?d.charAt(2)+
d.charAt(2):d.substring(4,6);return[parseInt(b,16),parseInt(c,16),parseInt(d,16),1]}},void(b.Color.fromSource=function(b){var d=new f;return d.setSource(b),d}))})("undefined"!=typeof exports?exports:this);
(function(){function h(e){var b,f,d,a=e.getAttribute("style"),c=e.getAttribute("offset")||0;if(c=parseFloat(c)/(/%$/.test(c)?100:1),c=0>c?0:1<c?1:c,a){a=a.split(/\s*;\s*/);""===a[a.length-1]&&a.pop();for(var h=a.length;h--;){var k=a[h].split(/\s*:\s*/),p=k[0].trim(),k=k[1].trim();"stop-color"===p?b=k:"stop-opacity"===p&&(d=k)}}return b||(b=e.getAttribute("stop-color")||"rgb(0,0,0)"),d||(d=e.getAttribute("stop-opacity")),b=new fabric.Color(b),f=b.getAlpha(),d=isNaN(parseFloat(d))?1:parseFloat(d),d*=
f,{offset:c,color:b.toRgb(),opacity:d}}function f(e,b,f){var d,a=0,c,g="",h;for(h in b)"Infinity"===b[h]?b[h]=1:"-Infinity"===b[h]&&(b[h]=0),d=parseFloat(b[h],10),c="string"==typeof b[h]&&/^\d+%$/.test(b[h])?.01:1,"x1"===h||"x2"===h||"r2"===h?(c*="objectBoundingBox"===f?e.width:1,a="objectBoundingBox"===f?e.left||0:0):"y1"!==h&&"y2"!==h||(c*="objectBoundingBox"===f?e.height:1,a="objectBoundingBox"===f?e.top||0:0),b[h]=d*c+a;"ellipse"===e.type&&null!==b.r2&&"objectBoundingBox"===f&&e.rx!==e.ry&&(e=
e.ry/e.rx,g=" scale(1, "+e+")",b.y1&&(b.y1/=e),b.y2&&(b.y2/=e));return g}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(e){e||(e={});var b;this.id=fabric.Object.__uid++;this.type=e.type||"linear";b={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0};"radial"===this.type&&(b.r1=e.coords.r1||0,b.r2=e.coords.r2||0);this.coords=b;this.colorStops=e.colorStops.slice();e.gradientTransform&&(this.gradientTransform=e.gradientTransform);this.offsetX=e.offsetX||
this.offsetX;this.offsetY=e.offsetY||this.offsetY},addColorStop:function(e){for(var b in e){var f=new fabric.Color(e[b]);this.colorStops.push({offset:b,color:f.toRgb(),opacity:f.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform}},toSVG:function(e){var b,f=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(a,
c){return a.offset-c.offset}),!e.group||"path-group"!==e.group.type)for(var d in f)"x1"===d||"x2"===d||"r2"===d?f[d]+=this.offsetX-e.width/2:"y1"!==d&&"y2"!==d||(f[d]+=this.offsetY-e.height/2);e='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"';this.gradientTransform&&(e+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" ');"linear"===this.type?b=["<linearGradient ",e,' x1="',f.x1,'" y1="',f.y1,'" x2="',f.x2,'" y2="',f.y2,'">\n']:"radial"===this.type&&(b=["<radialGradient ",
e,' cx="',f.x2,'" cy="',f.y2,'" r="',f.r2,'" fx="',f.x1,'" fy="',f.y1,'">\n']);for(f=0;f<this.colorStops.length;f++)b.push("<stop ",'offset="',100*this.colorStops[f].offset+"%",'" style="stop-color:',this.colorStops[f].color,null!=this.colorStops[f].opacity?";stop-opacity: "+this.colorStops[f].opacity:";",'"/>\n');return b.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),b.join("")},toLive:function(e,b){var f,d,a=fabric.util.object.clone(this.coords);if(this.type){if(b.group&&
"path-group"===b.group.type)for(d in a)"x1"===d||"x2"===d?a[d]+=-this.offsetX+b.width/2:"y1"!==d&&"y2"!==d||(a[d]+=-this.offsetY+b.height/2);"linear"===this.type?f=e.createLinearGradient(a.x1,a.y1,a.x2,a.y2):"radial"===this.type&&(f=e.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2));d=0;for(a=this.colorStops.length;d<a;d++){var c=this.colorStops[d].color,h=this.colorStops[d].opacity,k=this.colorStops[d].offset;"undefined"!=typeof h&&(c=(new fabric.Color(c)).setAlpha(h).toRgba());f.addColorStop(parseFloat(k),
c)}return f}}});fabric.util.object.extend(fabric.Gradient,{fromElement:function(e,b){var g,d,a;a=e.getElementsByTagName("stop");var c=e.getAttribute("gradientUnits")||"objectBoundingBox",m=e.getAttribute("gradientTransform"),k=[];g="linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?"linear":"radial";"linear"===g?d={x1:e.getAttribute("x1")||0,y1:e.getAttribute("y1")||0,x2:e.getAttribute("x2")||"100%",y2:e.getAttribute("y2")||0}:"radial"===g&&(d={x1:e.getAttribute("fx")||e.getAttribute("cx")||
"50%",y1:e.getAttribute("fy")||e.getAttribute("cy")||"50%",r1:0,x2:e.getAttribute("cx")||"50%",y2:e.getAttribute("cy")||"50%",r2:e.getAttribute("r")||"50%"});for(var p=a.length;p--;)k.push(h(a[p]));a=f(b,d,c);g=new fabric.Gradient({type:g,coords:d,colorStops:k,offsetX:-b.left,offsetY:-b.top});return(m||""!==a)&&(g.gradientTransform=fabric.parseTransformAttribute((m||"")+a)),g},forObject:function(e,b){return b||(b={}),f(e,b.coords,"userSpaceOnUse"),new fabric.Gradient(b)}})})();
fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(h){if(h||(h={}),this.id=fabric.Object.__uid++,h.source)if("string"==typeof h.source)if("undefined"!=typeof fabric.util.getFunctionBody(h.source))this.source=new Function(fabric.util.getFunctionBody(h.source));else{var f=this;this.source=fabric.util.createImage();fabric.util.loadImage(h.source,function(e){f.source=e})}else this.source=h.source;h.repeat&&(this.repeat=h.repeat);h.offsetX&&(this.offsetX=h.offsetX);
h.offsetY&&(this.offsetY=h.offsetY)},toObject:function(){var h;return"function"==typeof this.source?h=String(this.source):"string"==typeof this.source.src?h=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(h=this.source.toDataURL()),{source:h,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(h){var f="function"==typeof this.source?this.source():this.source,e=f.width/h.getWidth(),b=f.height/h.getHeight(),g=this.offsetX/h.getWidth();h=this.offsetY/h.getHeight();
var d="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(b=1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(e=1),f.src?d=f.src:f.toDataURL&&(d=f.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+g+'" y="'+h+'" width="'+e+'" height="'+b+'">\n<image x="0" y="0" width="'+f.width+'" height="'+f.height+'" xlink:href="'+d+'"></image>\n</pattern>\n'},toLive:function(h){var f="function"==typeof this.source?this.source():this.source;return f&&("undefined"==typeof f.src||f.complete&&0!==
f.naturalWidth&&0!==f.naturalHeight)?h.createPattern(f,this.repeat):""}});
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.toFixed;return f.Shadow?void f.warn("fabric.Shadow is already defined."):(f.Shadow=f.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(b){"string"==typeof b&&(b=this._parseShadow(b));for(var e in b)this[e]=b[e];this.id=f.Object.__uid++},_parseShadow:function(b){b=b.trim();var e=f.Shadow.reOffsetsAndBlur.exec(b)||[];return{color:(b.replace(f.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),
offsetX:parseInt(e[1],10)||0,offsetY:parseInt(e[2],10)||0,blur:parseInt(e[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(b){var g=40,d=40,a=f.Object.NUM_FRACTION_DIGITS,c=f.util.rotateVector({x:this.offsetX,y:this.offsetY},f.util.degreesToRadians(-b.angle));return b.width&&b.height&&(g=100*e((Math.abs(c.x)+this.blur)/b.width,a)+20,d=100*e((Math.abs(c.y)+this.blur)/b.height,a)+20),b.flipX&&(c.x*=-1),b.flipY&&(c.y*=-1),'<filter id="SVGID_'+
this.id+'" y="-'+d+'%" height="'+(100+2*d)+'%" x="-'+g+'%" width="'+(100+2*g)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+e(this.blur?this.blur/2:0,a)+'"></feGaussianBlur>\n\t<feOffset dx="'+e(c.x,a)+'" dy="'+e(c.y,a)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+this.color+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,
blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke};var b={},e=f.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke"].forEach(function(d){this[d]!==e[d]&&(b[d]=this[d])},this),b}}),void(f.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))})("undefined"!=typeof exports?exports:this);
(function(){if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var h=fabric.util.object.extend,f=fabric.util.getElementOffset,e=fabric.util.removeFromArray,b=fabric.util.toFixed,g=Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(b,a){a||(a={});this._initStatic(b,a)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,
controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:[1,0,0,1,0,0],backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,_initStatic:function(b,a){var c=fabric.StaticCanvas.prototype.renderAll.bind(this);this._objects=[];this._createLowerCanvas(b);this._initOptions(a);this._setImageSmoothing();this.interactive||this._initRetinaScaling();a.overlayImage&&this.setOverlayImage(a.overlayImage,c);a.backgroundImage&&this.setBackgroundImage(a.backgroundImage,
c);a.backgroundColor&&this.setBackgroundColor(a.backgroundColor,c);a.overlayColor&&this.setOverlayColor(a.overlayColor,c);this.calcOffset()},_isRetinaScaling:function(){return 1!==fabric.devicePixelRatio&&this.enableRetinaScaling},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*fabric.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*fabric.devicePixelRatio),this.contextContainer.scale(fabric.devicePixelRatio,fabric.devicePixelRatio))},
calcOffset:function(){return this._offset=f(this.lowerCanvasEl),this},setOverlayImage:function(b,a,c){return this.__setBgOverlayImage("overlayImage",b,a,c)},setBackgroundImage:function(b,a,c){return this.__setBgOverlayImage("backgroundImage",b,a,c)},setOverlayColor:function(b,a){return this.__setBgOverlayColor("overlayColor",b,a)},setBackgroundColor:function(b,a){return this.__setBgOverlayColor("backgroundColor",b,a)},_setImageSmoothing:function(){var b=this.getContext();b.imageSmoothingEnabled=b.imageSmoothingEnabled||
b.webkitImageSmoothingEnabled||b.mozImageSmoothingEnabled||b.msImageSmoothingEnabled||b.oImageSmoothingEnabled;b.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(b,a,c,e){return"string"==typeof a?fabric.util.loadImage(a,function(a){a&&(this[b]=new fabric.Image(a,e));c&&c(a)},this,e&&e.crossOrigin):(e&&a.setOptions(e),this[b]=a,c&&c(a)),this},__setBgOverlayColor:function(b,a,c){if(a&&a.source){var d=this;fabric.util.loadImage(a.source,function(e){d[b]=new fabric.Pattern({source:e,
repeat:a.repeat,offsetX:a.offsetX,offsetY:a.offsetY});c&&c()})}else this[b]=a,c&&c();return this},_createCanvasElement:function(){var b=fabric.document.createElement("canvas");if(b.style||(b.style={}),!b)throw g;return this._initCanvasElement(b),b},_initCanvasElement:function(b){if(fabric.util.createCanvasElement(b),"undefined"==typeof b.getContext)throw g;},_initOptions:function(b){for(var a in b)this[a]=b[a];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||
parseInt(this.lowerCanvasEl.height,10)||0;this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(b){this.lowerCanvasEl=fabric.util.getById(b)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);fabric.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&
this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(b,a){return this.setDimensions({width:b},a)},setHeight:function(b,a){return this.setDimensions({height:b},a)},setDimensions:function(b,a){var c;a=a||{};for(var d in b)c=b[d],a.cssOnly||(this._setBackstoreDimension(d,b[d]),c+="px"),a.backstoreOnly||this._setCssDimension(d,c);return this._initRetinaScaling(),
this._setImageSmoothing(),this.calcOffset(),a.cssOnly||this.renderAll(),this},_setBackstoreDimension:function(b,a){return this.lowerCanvasEl[b]=a,this.upperCanvasEl&&(this.upperCanvasEl[b]=a),this.cacheCanvasEl&&(this.cacheCanvasEl[b]=a),this[b]=a,this},_setCssDimension:function(b,a){return this.lowerCanvasEl.style[b]=a,this.upperCanvasEl&&(this.upperCanvasEl.style[b]=a),this.wrapperEl&&(this.wrapperEl.style[b]=a),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},
setViewportTransform:function(b){var a=this.getActiveGroup();this.viewportTransform=b;b=0;for(var c=this._objects.length;b<c;b++)this._objects[b].setCoords();return a&&a.setCoords(),this.renderAll(),this},zoomToPoint:function(b,a){var c=b,d=this.viewportTransform.slice(0);b=fabric.util.transformPoint(b,fabric.util.invertTransform(this.viewportTransform));d[0]=a;d[3]=a;var e=fabric.util.transformPoint(b,d);return d[4]+=c.x-e.x,d[5]+=c.y-e.y,this.setViewportTransform(d)},setZoom:function(b){return this.zoomToPoint(new fabric.Point(0,
0),b),this},absolutePan:function(b){var a=this.viewportTransform.slice(0);return a[4]=-b.x,a[5]=-b.y,this.setViewportTransform(a)},relativePan:function(b){return this.absolutePan(new fabric.Point(-b.x-this.viewportTransform[4],-b.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_onObjectAdded:function(b){this.stateful&&b.setupState();b._set("canvas",this);b.setCoords();this.fire("object:added",
{target:b});b.fire("added")},_onObjectRemoved:function(b){this.fire("object:removed",{target:b});b.fire("removed")},clearContext:function(b){return b.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(){return this.renderCanvas(this.contextContainer,this._objects),this},renderCanvas:function(b,a){this.clearContext(b);
this.fire("before:render");this.clipTo&&fabric.util.clipContext(this,b);this._renderBackground(b);b.save();b.transform.apply(b,this.viewportTransform);this._renderObjects(b,a);b.restore();!this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);this.clipTo&&b.restore();this._renderOverlay(b);this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);this.fire("after:render")},drawControls:function(){},_renderObjects:function(b,a){for(var c=0,d=a.length;c<d;++c)a[c]&&a[c].render(b)},
_renderBackgroundOrOverlay:function(b,a){var c=this[a+"Color"];c&&(b.fillStyle=c.toLive?c.toLive(b):c,b.fillRect(c.offsetX||0,c.offsetY||0,this.width,this.height));(c=this[a+"Image"])&&(this[a+"Vpt"]&&(b.save(),b.transform.apply(b,this.viewportTransform)),c.render(b),this[a+"Vpt"]&&b.restore())},_renderBackground:function(b){this._renderBackgroundOrOverlay(b,"background")},_renderOverlay:function(b){this._renderBackgroundOrOverlay(b,"overlay")},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/
2}},centerObjectH:function(b){return this._centerObject(b,new fabric.Point(this.getCenter().left,b.getCenterPoint().y))},centerObjectV:function(b){return this._centerObject(b,new fabric.Point(b.getCenterPoint().x,this.getCenter().top))},centerObject:function(b){var a=this.getCenter();return this._centerObject(b,new fabric.Point(a.left,a.top))},viewportCenterObject:function(b){var a=this.getVpCenter();return this._centerObject(b,a)},viewportCenterObjectH:function(b){var a=this.getVpCenter();return this._centerObject(b,
new fabric.Point(a.x,b.getCenterPoint().y)),this},viewportCenterObjectV:function(b){var a=this.getVpCenter();return this._centerObject(b,new fabric.Point(b.getCenterPoint().x,a.y))},getVpCenter:function(){var b=this.getCenter(),a=fabric.util.invertTransform(this.viewportTransform);return fabric.util.transformPoint({x:b.left,y:b.top},a)},_centerObject:function(b,a){return b.setPositionByOrigin(a,"center","center"),this.renderAll(),this},toDatalessJSON:function(b){return this.toDatalessObject(b)},toObject:function(b){return this._toObjectMethod("toObject",
b)},toDatalessObject:function(b){return this._toObjectMethod("toDatalessObject",b)},_toObjectMethod:function(b,a){var c={objects:this._toObjects(b,a)};return h(c,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,c,a),c},_toObjects:function(b,a){return this.getObjects().filter(function(a){return!a.excludeFromExport}).map(function(c){return this._toObject(c,b,a)},this)},_toObject:function(b,a,c){var d;this.includeDefaultValues||(d=b.includeDefaultValues,b.includeDefaultValues=!1);
var e=this._realizeGroupTransformOnObject(b);a=b[a](c);return this.includeDefaultValues||(b.includeDefaultValues=d),this._unwindGroupTransformOnObject(b,e),a},_realizeGroupTransformOnObject:function(b){var a="angle flipX flipY height left scaleX scaleY top width".split(" ");if(b.group&&b.group===this.getActiveGroup()){var c={};return a.forEach(function(a){c[a]=b[a]}),this.getActiveGroup().realizeTransform(b),c}return null},_unwindGroupTransformOnObject:function(b,a){a&&b.set(a)},__serializeBgOverlay:function(){var b=
{background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(b.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(b.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(b.overlayImage=this.overlayImage.toObject()),b},svgViewportTransformation:!0,toSVG:function(b,a){b||(b={});var c=[];return this._setSVGPreamble(c,b),this._setSVGHeader(c,b),this._setSVGBgOverlayColor(c,
"backgroundColor"),this._setSVGBgOverlayImage(c,"backgroundImage",a),this._setSVGObjects(c,a),this._setSVGBgOverlayColor(c,"overlayColor"),this._setSVGBgOverlayImage(c,"overlayImage",a),c.push("</svg>"),c.join("")},_setSVGPreamble:function(b,a){a.suppressPreamble||b.push('<?xml version="1.0" encoding="',a.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(d,a){var c,e=a.width||
this.width,f=a.height||this.height,g='viewBox="0 0 '+this.width+" "+this.height+'" ',h=fabric.Object.NUM_FRACTION_DIGITS;a.viewBox?g='viewBox="'+a.viewBox.x+" "+a.viewBox.y+" "+a.viewBox.width+" "+a.viewBox.height+'" ':this.svgViewportTransformation&&(c=this.viewportTransform,g='viewBox="'+b(-c[4]/c[0],h)+" "+b(-c[5]/c[3],h)+" "+b(this.width/c[0],h)+" "+b(this.height/c[3],h)+'" ');d.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',
e,'" ','height="',f,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,g,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",fabric.version,"</desc>\n","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>\n")},_setSVGObjects:function(b,a){for(var c,d,e=0,f=this.getObjects(),g=f.length;e<g;e++)c=f[e],c.excludeFromExport||(d=this._realizeGroupTransformOnObject(c),b.push(c.toSVG(a)),
this._unwindGroupTransformOnObject(c,d))},_setSVGBgOverlayImage:function(b,a,c){this[a]&&this[a].toSVG&&b.push(this[a].toSVG(c))},_setSVGBgOverlayColor:function(b,a){this[a]&&this[a].source?b.push('<rect x="',this[a].offsetX,'" y="',this[a].offsetY,'" ','width="',"repeat-y"===this[a].repeat||"no-repeat"===this[a].repeat?this[a].source.width:this.width,'" height="',"repeat-x"===this[a].repeat||"no-repeat"===this[a].repeat?this[a].source.height:this.height,'" fill="url(#'+a+'Pattern)"',"></rect>\n"):
this[a]&&"overlayColor"===a&&b.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[a],'"',"></rect>\n")},sendToBack:function(b){if(!b)return this;var a,c;a=this.getActiveGroup?this.getActiveGroup():null;if(b===a)for(c=a._objects,b=c.length;b--;)a=c[b],e(this._objects,a),this._objects.unshift(a);else e(this._objects,b),this._objects.unshift(b);return this.renderAll&&this.renderAll()},bringToFront:function(b){if(!b)return this;var a,c;a=this.getActiveGroup?this.getActiveGroup():
null;if(b===a)for(c=a._objects,b=0;b<c.length;b++)a=c[b],e(this._objects,a),this._objects.push(a);else e(this._objects,b),this._objects.push(b);return this.renderAll&&this.renderAll()},sendBackwards:function(b,a){if(!b)return this;var c,d,f,g,h;c=this.getActiveGroup?this.getActiveGroup():null;if(b===c)for(h=c._objects,c=0;c<h.length;c++)d=h[c],f=this._objects.indexOf(d),0!==f&&(g=f-1,e(this._objects,d),this._objects.splice(g,0,d));else f=this._objects.indexOf(b),0!==f&&(g=this._findNewLowerIndex(b,
f,a),e(this._objects,b),this._objects.splice(g,0,b));return this.renderAll&&this.renderAll(),this},_findNewLowerIndex:function(b,a,c){if(c)for(c=a,--a;0<=a;--a){if(b.intersectsWithObject(this._objects[a])||b.isContainedWithinObject(this._objects[a])||this._objects[a].isContainedWithinObject(b)){c=a;break}}else c=a-1;return c},bringForward:function(b,a){if(!b)return this;var c,d,f,g,h;c=this.getActiveGroup?this.getActiveGroup():null;if(b===c)for(h=c._objects,c=h.length;c--;)d=h[c],f=this._objects.indexOf(d),
f!==this._objects.length-1&&(g=f+1,e(this._objects,d),this._objects.splice(g,0,d));else f=this._objects.indexOf(b),f!==this._objects.length-1&&(g=this._findNewUpperIndex(b,f,a),e(this._objects,b),this._objects.splice(g,0,b));return this.renderAll&&this.renderAll(),this},_findNewUpperIndex:function(b,a,c){if(c)for(c=a,a+=1;a<this._objects.length;++a){if(b.intersectsWithObject(this._objects[a])||b.isContainedWithinObject(this._objects[a])||this._objects[a].isContainedWithinObject(b)){c=a;break}}else c=
a+1;return c},moveTo:function(b,a){return e(this._objects,b),this._objects.splice(a,0,b),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});h(fabric.StaticCanvas.prototype,fabric.Observable);h(fabric.StaticCanvas.prototype,fabric.Collection);h(fabric.StaticCanvas.prototype,fabric.DataURLExporter);h(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',
supports:function(b){var a=fabric.util.createCanvasElement();if(!a||!a.getContext)return null;var c=a.getContext("2d");if(!c)return null;switch(b){case "getImageData":return"undefined"!=typeof c.getImageData;case "setLineDash":return"undefined"!=typeof c.setLineDash;case "toDataURL":return"undefined"!=typeof a.toDataURL;case "toDataURLWithQuality":try{return a.toDataURL("image/jpeg",0),!0}catch(m){}return!1;default:return null}}});fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject})();
fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(h){return this.shadow=new fabric.Shadow(h),this},_setBrushStyles:function(){var h=this.canvas.contextTop;h.strokeStyle=this.color;h.lineWidth=this.width;h.lineCap=this.strokeLineCap;h.lineJoin=this.strokeLineJoin;this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&h.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var h=
this.canvas.contextTop;h.shadowColor=this.shadow.color;h.shadowBlur=this.shadow.blur;h.shadowOffsetX=this.shadow.offsetX;h.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="";h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0}});
(function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(h){this.canvas=h;this._points=[]},onMouseDown:function(h){this._prepareForDrawing(h);this._captureDrawingPath(h);this._render()},onMouseMove:function(h){this._captureDrawingPath(h);this.canvas.clearContext(this.canvas.contextTop);this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(h){h=new fabric.Point(h.x,h.y);this._reset();this._addPoint(h);this.canvas.contextTop.moveTo(h.x,
h.y)},_addPoint:function(h){this._points.push(h)},_reset:function(){this._points.length=0;this._setBrushStyles();this._setShadow()},_captureDrawingPath:function(h){h=new fabric.Point(h.x,h.y);this._addPoint(h)},_render:function(){var h=this.canvas.contextTop,f=this.canvas.viewportTransform,e=this._points[0],b=this._points[1];h.save();h.transform(f[0],f[1],f[2],f[3],f[4],f[5]);h.beginPath();2===this._points.length&&e.x===b.x&&e.y===b.y&&(e.x-=.5,b.x+=.5);h.moveTo(e.x,e.y);for(var f=1,g=this._points.length;f<
g;f++)b=e.midPointFrom(b),h.quadraticCurveTo(e.x,e.y,b.x,b.y),e=this._points[f],b=this._points[f+1];h.lineTo(e.x,e.y);h.stroke();h.restore()},convertPointsToSVGPath:function(h){var f=[],e=new fabric.Point(h[0].x,h[0].y),b=new fabric.Point(h[1].x,h[1].y);f.push("M ",h[0].x," ",h[0].y," ");for(var g=1,d=h.length;g<d;g++){var a=e.midPointFrom(b);f.push("Q ",e.x," ",e.y," ",a.x," ",a.y," ");e=new fabric.Point(h[g].x,h[g].y);g+1<h.length&&(b=new fabric.Point(h[g+1].x,h[g+1].y))}return f.push("L ",e.x,
" ",e.y," "),f},createPath:function(h){h=new fabric.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,h.setShadow(this.shadow)),h},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath();var h=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===h)return void this.canvas.renderAll();
h=this.createPath(h);this.canvas.add(h);h.setCoords();this.canvas.clearContext(this.canvas.contextTop);this._resetShadow();this.canvas.renderAll();this.canvas.fire("path:created",{path:h})}})})();
fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(h){this.canvas=h;this.points=[]},drawDot:function(h){h=this.addPoint(h);var f=this.canvas.contextTop,e=this.canvas.viewportTransform;f.save();f.transform(e[0],e[1],e[2],e[3],e[4],e[5]);f.fillStyle=h.fill;f.beginPath();f.arc(h.x,h.y,h.radius,0,2*Math.PI,!1);f.closePath();f.fill();f.restore()},onMouseDown:function(h){this.points.length=0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.drawDot(h)},
onMouseMove:function(h){this.drawDot(h)},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var f=[],e=0,b=this.points.length;e<b;e++){var g=this.points[e],g=new fabric.Circle({radius:g.radius,left:g.x,top:g.y,originX:"center",originY:"center",fill:g.fill});this.shadow&&g.setShadow(this.shadow);f.push(g)}f=new fabric.Group(f,{originX:"center",originY:"center"});f.canvas=this.canvas;this.canvas.add(f);this.canvas.fire("path:created",{path:f});this.canvas.clearContext(this.canvas.contextTop);
this._resetShadow();this.canvas.renderOnAddRemove=h;this.canvas.renderAll()},addPoint:function(h){h=new fabric.Point(h.x,h.y);var f=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,e=(new fabric.Color(this.color)).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return h.radius=f,h.fill=e,this.points.push(h),h}});
fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h;this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.addSprayChunk(h);this.render()},onMouseMove:function(h){this.addSprayChunk(h);this.render()},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=
!1;for(var f=[],e=0,b=this.sprayChunks.length;e<b;e++)for(var g=this.sprayChunks[e],d=0,a=g.length;d<a;d++){var c=new fabric.Rect({width:g[d].width,height:g[d].width,left:g[d].x+1,top:g[d].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&c.setShadow(this.shadow);f.push(c)}this.optimizeOverlapping&&(f=this._getOptimizedRects(f));f=new fabric.Group(f,{originX:"center",originY:"center"});f.canvas=this.canvas;this.canvas.add(f);this.canvas.fire("path:created",{path:f});this.canvas.clearContext(this.canvas.contextTop);
this._resetShadow();this.canvas.renderOnAddRemove=h;this.canvas.renderAll()},_getOptimizedRects:function(h){for(var f,e={},b=0,g=h.length;b<g;b++)f=h[b].left+""+h[b].top,e[f]||(e[f]=h[b]);h=[];for(f in e)h.push(e[f]);return h},render:function(){var h=this.canvas.contextTop;h.fillStyle=this.color;var f=this.canvas.viewportTransform;h.save();h.transform(f[0],f[1],f[2],f[3],f[4],f[5]);for(var f=0,e=this.sprayChunkPoints.length;f<e;f++){var b=this.sprayChunkPoints[f];"undefined"!=typeof b.opacity&&(h.globalAlpha=
b.opacity);h.fillRect(b.x,b.y,b.width,b.width)}h.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];for(var f,e,b,g=this.width/2,d=0;d<this.density;d++)f=fabric.util.getRandomInt(h.x-g,h.x+g),e=fabric.util.getRandomInt(h.y-g,h.y+g),b=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth,f=new fabric.Point(f,e),f.width=b,this.randomOpacity&&(f.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(f);
this.sprayChunks.push(this.sprayChunkPoints)}});
fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var h=fabric.document.createElement("canvas"),f=h.getContext("2d");return h.width=h.height=25,f.fillStyle=this.color,f.beginPath(),f.arc(10,10,10,0,2*Math.PI,!1),f.closePath(),f.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles");
this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(h){h=this.callSuper("createPath",h);var f=h._getLeftTopCoords().scalarAdd(h.strokeWidth/2);return h.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-f.x,offsetY:-f.y}),h}});
(function(){var h=fabric.util.getPointer,f=fabric.util.degreesToRadians,e=fabric.util.radiansToDegrees,b=Math.atan2,g=Math.abs;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(a,c){c||(c={});this._initStatic(a,c);this._initInteractive();this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",
selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,_initInteractive:function(){this._groupSelector=this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();
this._initRetinaScaling();this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this);this.calcOffset()},_chooseObjectsToRender:function(){var a,c=this.getActiveGroup(),b=this.getActiveObject(),d=[],e=[];if(!c&&!b||this.preserveObjectStacking)d=this._objects;else{for(var f=0,g=this._objects.length;f<g;f++)a=this._objects[f],c&&c.contains(a)||a===b?e.push(a):d.push(a);c&&(c._set("_objects",e),d.push(c));b&&d.push(b)}return d},renderAll:function(){!this.selection||this._groupSelector||this.isDrawingMode||
this.clearContext(this.contextTop);return this.renderCanvas(this.contextContainer,this._chooseObjectsToRender()),this},renderTop:function(){var a=this.contextTop;return this.clearContext(a),this.selection&&this._groupSelector&&this._drawSelection(a),this.fire("after:render"),this},_resetCurrentTransform:function(){var a=this._currentTransform;a.target.set({scaleX:a.original.scaleX,scaleY:a.original.scaleY,skewX:a.original.skewX,skewY:a.original.skewY,left:a.original.left,top:a.original.top});this._shouldCenterTransform(a.target)?
"rotate"===a.action?this._setOriginToCenter(a.target):("center"!==a.originX&&("right"===a.originX?a.mouseXSign=-1:a.mouseXSign=1),"center"!==a.originY&&("bottom"===a.originY?a.mouseYSign=-1:a.mouseYSign=1),a.originX="center",a.originY="center"):(a.originX=a.original.originX,a.originY=a.original.originY)},containsPoint:function(a,c,b){var d;a=b||this.getPointer(a,!0);return d=c.group&&c.group===this.getActiveGroup()?this._normalizePointer(c.group,a):{x:a.x,y:a.y},c.containsPoint(d)||c._findTargetCorner(a)},
_normalizePointer:function(a,c){var b=a.calcTransformMatrix(),d=fabric.util.invertTransform(b),b=this.viewportTransform,e=this.restorePointerVpt(c),d=fabric.util.transformPoint(e,d);return fabric.util.transformPoint(d,b)},isTargetTransparent:function(a,c,b){var d=a.hasBorders,e=a.transparentCorners,f=this.contextCache,g=a.selectionBackgroundColor;a.hasBorders=a.transparentCorners=!1;a.selectionBackgroundColor="";f.save();f.transform.apply(f,this.viewportTransform);a.render(f);f.restore();a.active&&
a._renderControls(f);a.hasBorders=d;a.transparentCorners=e;a.selectionBackgroundColor=g;a=fabric.util.isTransparent(f,c,b,this.targetFindTolerance);return this.clearContext(f),a},_shouldClearSelection:function(a,c){var b=this.getActiveGroup(),d=this.getActiveObject();return!c||c&&b&&!b.contains(c)&&b!==c&&!a[this.selectionKey]||c&&!c.evented||c&&!c.selectable&&d&&d!==c},_shouldCenterTransform:function(a){if(a){var c,b=this._currentTransform;return"scale"===b.action||"scaleX"===b.action||"scaleY"===
b.action?c=this.centeredScaling||a.centeredScaling:"rotate"===b.action&&(c=this.centeredRotation||a.centeredRotation),c?!b.altKey:b.altKey}},_getOriginFromCorner:function(a,c){var b={x:a.originX,y:a.originY};return"ml"===c||"tl"===c||"bl"===c?b.x="right":"mr"!==c&&"tr"!==c&&"br"!==c||(b.x="left"),"tl"===c||"mt"===c||"tr"===c?b.y="bottom":"bl"!==c&&"mb"!==c&&"br"!==c||(b.y="top"),b},_getActionFromCorner:function(a,c,b){if(!c)return"drag";switch(c){case "mtr":return"rotate";case "ml":case "mr":return b[this.altActionKey]?
"skewY":"scaleX";case "mt":case "mb":return b[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(a,c){if(c){var b=this.getPointer(a),d=c._findTargetCorner(this.getPointer(a,!0)),e=this._getActionFromCorner(c,d,a),g=this._getOriginFromCorner(c,d);this._currentTransform={target:c,action:e,corner:d,scaleX:c.scaleX,scaleY:c.scaleY,skewX:c.skewX,skewY:c.skewY,offsetX:b.x-c.left,offsetY:b.y-c.top,originX:g.x,originY:g.y,ex:b.x,ey:b.y,lastX:b.x,lastY:b.y,left:c.left,
top:c.top,theta:f(c.angle),width:c.width*c.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:a.shiftKey,altKey:a[this.centeredKey]};this._currentTransform.original={left:c.left,top:c.top,scaleX:c.scaleX,scaleY:c.scaleY,skewX:c.skewX,skewY:c.skewY,originX:g.x,originY:g.y};this._resetCurrentTransform()}},_translateObject:function(a,c){var b=this._currentTransform,d=b.target,e=a-b.offsetX,b=c-b.offsetY,f=!d.get("lockMovementX")&&d.left!==e,g=!d.get("lockMovementY")&&d.top!==b;return f&&d.set("left",e),g&&d.set("top",
b),f||g},_changeSkewTransformOrigin:function(a,c,b){var d="originX",e={0:"center"},f=c.target.skewX,g="left",h="right",m="mt"===c.corner||"ml"===c.corner?1:-1,u=1;a=0<a?1:-1;"y"===b&&(f=c.target.skewY,g="top",h="bottom",d="originY");e[-1]=g;e[1]=h;c.target.flipX&&(u*=-1);c.target.flipY&&(u*=-1);0===f?(c.skewSign=-m*a*u,c[d]=e[-a]):(f=0<f?1:-1,c.skewSign=f,c[d]=e[f*m*u])},_skewObject:function(a,c,b){var d=this._currentTransform,e=d.target,f=!1,g=e.get("lockSkewingX"),h=e.get("lockSkewingY");if(g&&
"x"===b||h&&"y"===b)return!1;var m,u,g=e.getCenterPoint(),h=e.toLocalPoint(new fabric.Point(a,c),"center","center")[b],A=e.toLocalPoint(new fabric.Point(d.lastX,d.lastY),"center","center")[b],y=e._getTransformedDimensions();return this._changeSkewTransformOrigin(h-A,d,b),m=e.toLocalPoint(new fabric.Point(a,c),d.originX,d.originY)[b],u=e.translateToOriginPoint(g,d.originX,d.originY),f=this._setObjectSkew(m,d,b,y),d.lastX=a,d.lastY=c,e.setPositionByOrigin(u,d.originX,d.originY),f},_setObjectSkew:function(a,
c,b,d){var e,f,g,h,m,k,A,y,v,x=c.target,z=!1;c=c.skewSign;return"x"===b?(h="y",m="Y",k="X",y=0,v=x.skewY):(h="x",m="X",k="Y",y=x.skewX,v=0),g=x._getTransformedDimensions(y,v),A=2*Math.abs(a)-g[b],2>=A?e=0:(e=c*Math.atan(A/x["scale"+k]/(g[h]/x["scale"+m])),e=fabric.util.radiansToDegrees(e)),z=x["skew"+k]!==e,x.set("skew"+k,e),0!==x["skew"+m]&&(f=x._getTransformedDimensions(),e=d[h]/f[h]*x["scale"+m],x.set("scale"+m,e)),z},_scaleObject:function(a,c,b){var d=this._currentTransform,e=d.target,f=e.get("lockScalingX"),
g=e.get("lockScalingY"),h=e.get("lockScalingFlip");if(f&&g)return!1;var m=e.translateToOriginPoint(e.getCenterPoint(),d.originX,d.originY);a=e.toLocalPoint(new fabric.Point(a,c),d.originX,d.originY);c=e._getTransformedDimensions();var u=!1;return this._setLocalMouse(a,d),u=this._setObjectScale(a,d,f,g,b,h,c),e.setPositionByOrigin(m,d.originX,d.originY),u},_setObjectScale:function(a,c,b,d,e,f,g){var h,m,k,p,n=c.target,q=!1,x=!1,z=!1;return k=a.x*n.scaleX/g.x,p=a.y*n.scaleY/g.y,h=n.scaleX!==k,m=n.scaleY!==
p,f&&0>=k&&k<n.scaleX&&(q=!0),f&&0>=p&&p<n.scaleY&&(x=!0),"equally"!==e||b||d?e?"x"!==e||n.get("lockUniScaling")?"y"!==e||n.get("lockUniScaling")||x||d||n.set("scaleY",p)&&(z=z||m):q||b||n.set("scaleX",k)&&(z=z||h):(q||b||n.set("scaleX",k)&&(z=z||h),x||d||n.set("scaleY",p)&&(z=z||m)):q||x||(z=this._scaleObjectEqually(a,n,c,g)),c.newScaleX=k,c.newScaleY=p,q||x||this._flipObject(c,e),z},_scaleObjectEqually:function(a,c,b,d){var e;a=a.y+a.x;d=d.y*b.original.scaleY/c.scaleY+d.x*b.original.scaleX/c.scaleX;
return b.newScaleX=b.original.scaleX*a/d,b.newScaleY=b.original.scaleY*a/d,e=b.newScaleX!==c.scaleX||b.newScaleY!==c.scaleY,c.set("scaleX",b.newScaleX),c.set("scaleY",b.newScaleY),e},_flipObject:function(a,c){0>a.newScaleX&&"y"!==c&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX="left"));0>a.newScaleY&&"x"!==c&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(a,c){var b=c.target;"right"===c.originX?a.x*=-1:"center"===c.originX&&
(a.x=2*a.x*c.mouseXSign,0>a.x&&(c.mouseXSign=-c.mouseXSign));"bottom"===c.originY?a.y*=-1:"center"===c.originY&&(a.y=2*a.y*c.mouseYSign,0>a.y&&(c.mouseYSign=-c.mouseYSign));g(a.x)>b.padding?0>a.x?a.x+=b.padding:a.x-=b.padding:a.x=0;g(a.y)>b.padding?0>a.y?a.y+=b.padding:a.y-=b.padding:a.y=0},_rotateObject:function(a,c){var d=this._currentTransform;if(d.target.get("lockRotation"))return!1;var f=b(d.ey-d.top,d.ex-d.left),g=b(c-d.top,a-d.left),f=e(g-f+d.theta);return 0>f&&(f=360+f),d.target.angle=f%360,
!0},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.skewX=0;a.skewY=0;a.setAngle(0)},_drawSelection:function(a){var c=this._groupSelector,b=c.left,d=c.top,e=g(b),f=g(d);(a.fillStyle=this.selectionColor,a.fillRect(c.ex-(0<b?0:-b),c.ey-(0<d?0:-d),e,f),a.lineWidth=this.selectionLineWidth,a.strokeStyle=this.selectionBorderColor,1<this.selectionDashArray.length)?(b=c.ex+.5-(0<b?0:e),c=c.ey+.5-(0<d?0:f),a.beginPath(),fabric.util.drawDashedLine(a,
b,c,b+e,c,this.selectionDashArray),fabric.util.drawDashedLine(a,b,c+f-1,b+e,c+f-1,this.selectionDashArray),fabric.util.drawDashedLine(a,b,c,b,c+f,this.selectionDashArray),fabric.util.drawDashedLine(a,b+e-1,c,b+e-1,c+f,this.selectionDashArray),a.closePath(),a.stroke()):a.strokeRect(c.ex+.5-(0<b?0:e),c.ey+.5-(0<d?0:f),e,f)},findTarget:function(a,c){if(!this.skipTargetFind){var b=this.getPointer(a,!0),d=this.getActiveGroup(),e=this.getActiveObject();if(d&&!c&&this._checkTarget(b,d))return d;if(e&&this._checkTarget(b,
e))return e;this.targets=[];b=this._searchPossibleTargets(this._objects,b);return this._fireOverOutEvents(b,a),b}},_fireOverOutEvents:function(a,c){a?this._hoveredTarget!==a&&(this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:c}),this._hoveredTarget.fire("mouseout")),this.fire("mouse:over",{target:a,e:c}),a.fire("mouseover"),this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:c}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=
null)},_checkTarget:function(a,c){if(c&&c.visible&&c.evented&&this.containsPoint(null,c,a)&&(!this.perPixelTargetFind&&!c.perPixelTargetFind||c.isEditing||!this.isTargetTransparent(c,a.x,a.y)))return!0},_searchPossibleTargets:function(a,c){for(var b,d,e,f=a.length;f--;)if(this._checkTarget(c,a[f])){b=a[f];"group"===b.type&&b.subTargetCheck&&(d=this._normalizePointer(b,c),e=this._searchPossibleTargets(b._objects,d),e&&this.targets.push(e));break}return b},restorePointerVpt:function(a){return fabric.util.transformPoint(a,
fabric.util.invertTransform(this.viewportTransform))},getPointer:function(a,b,d){d||(d=this.upperCanvasEl);var c;a=h(a);var e=d.getBoundingClientRect(),f=e.width||0,g=e.height||0;return f&&g||("top"in e&&"bottom"in e&&(g=Math.abs(e.top-e.bottom)),"right"in e&&"left"in e&&(f=Math.abs(e.right-e.left))),this.calcOffset(),a.x-=this._offset.left,a.y-=this._offset.top,b||(a=this.restorePointerVpt(a)),c=0===f||0===g?{width:1,height:1}:{width:d.width/f,height:d.height/g},{x:a.x*c.width,y:a.y*c.height}},_createUpperCanvas:function(){var a=
this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+a);this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",this.width);
this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass});fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var b=this.getWidth()||a.width,d=this.getHeight()||a.height;fabric.util.setStyle(a,
{position:"absolute",width:b+"px",height:d+"px",left:0,top:0});a.width=b;a.height=d;fabric.util.makeElementUnselectable(a)},_copyCanvasStyle:function(a,b){b.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,b){return this._setActiveObject(a),this.renderAll(),
this.fire("object:selected",{target:a,e:b}),a.fire("selected",{e:b}),this},getActiveObject:function(){return this._activeObject},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared"));this.callSuper("_onObjectRemoved",a)},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=null},discardActiveObject:function(a){return this._discardActiveObject(),
this.renderAll(),this.fire("selection:cleared",{e:a}),this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,b){return this._setActiveGroup(a),a&&(this.fire("object:selected",{target:a,e:b}),a.fire("selected",{e:b})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){return this._discardActiveGroup(),this.fire("selection:cleared",
{e:a}),this},deactivateAll:function(){for(var a=this.getObjects(),b=0,d=a.length;b<d;b++)a[b].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(a){var b=this.getActiveGroup()||this.getActiveObject();return b&&this.fire("before:selection:cleared",{target:b,e:a}),this.deactivateAll(),b&&this.fire("selection:cleared",{e:a}),this},dispose:function(){this.callSuper("dispose");var a=this.wrapperEl;return this.removeListeners(),a.removeChild(this.upperCanvasEl),
a.removeChild(this.lowerCanvasEl),delete this.upperCanvasEl,a.parentNode&&a.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,this},clear:function(){return this.discardActiveGroup(),this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(a){var b=this.getActiveGroup();b?b._renderControls(a):this._drawObjectsControls(a)},_drawObjectsControls:function(a){for(var b=0,d=this._objects.length;b<d;++b)this._objects[b]&&this._objects[b].active&&
this._objects[b]._renderControls(a)}});for(var d in fabric.StaticCanvas)"prototype"!==d&&(fabric.Canvas[d]=fabric.StaticCanvas[d]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){});fabric.Element=fabric.Canvas})();
(function(){var h={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},f=fabric.util.addListener,e=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:"n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" "),_initEventListeners:function(){this._bindEvents();f(fabric.window,"resize",this._onResize);f(this.upperCanvasEl,"mousedown",this._onMouseDown);f(this.upperCanvasEl,"mousemove",this._onMouseMove);f(this.upperCanvasEl,"mousewheel",this._onMouseWheel);
f(this.upperCanvasEl,"mouseout",this._onMouseOut);f(this.upperCanvasEl,"touchstart",this._onMouseDown);f(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},
_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onLongPress=this._onLongPress.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this);this._onMouseOut=this._onMouseOut.bind(this)},
removeListeners:function(){e(fabric.window,"resize",this._onResize);e(this.upperCanvasEl,"mousedown",this._onMouseDown);e(this.upperCanvasEl,"mousemove",this._onMouseMove);e(this.upperCanvasEl,"mousewheel",this._onMouseWheel);e(this.upperCanvasEl,"mouseout",this._onMouseOut);e(this.upperCanvasEl,"touchstart",this._onMouseDown);e(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,
"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(b,e){this.__onTransformGesture&&this.__onTransformGesture(b,e)},_onDrag:function(b,e){this.__onDrag&&this.__onDrag(b,e)},_onMouseWheel:function(b,e){this.__onMouseWheel&&this.__onMouseWheel(b,e)},_onMouseOut:function(b){var e=this._hoveredTarget;this.fire("mouse:out",
{target:e,e:b});this._hoveredTarget=null;e&&e.fire("mouseout",{e:b})},_onOrientationChange:function(b,e){this.__onOrientationChange&&this.__onOrientationChange(b,e)},_onShake:function(b,e){this.__onShake&&this.__onShake(b,e)},_onLongPress:function(b,e){this.__onLongPress&&this.__onLongPress(b,e)},_onMouseDown:function(b){this.__onMouseDown(b);f(fabric.document,"touchend",this._onMouseUp);f(fabric.document,"touchmove",this._onMouseMove);e(this.upperCanvasEl,"mousemove",this._onMouseMove);e(this.upperCanvasEl,
"touchmove",this._onMouseMove);"touchstart"===b.type?e(this.upperCanvasEl,"mousedown",this._onMouseDown):(f(fabric.document,"mouseup",this._onMouseUp),f(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(b){if(this.__onMouseUp(b),e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove),e(fabric.document,"touchmove",this._onMouseMove),f(this.upperCanvasEl,"mousemove",this._onMouseMove),f(this.upperCanvasEl,
"touchmove",this._onMouseMove),"touchend"===b.type){var g=this;setTimeout(function(){f(g.upperCanvasEl,"mousedown",g._onMouseDown)},400)}},_onMouseMove:function(b){!this.allowTouchScrolling&&b.preventDefault&&b.preventDefault();this.__onMouseMove(b)},_onResize:function(){this.calcOffset()},_shouldRender:function(b,e){var d=this.getActiveGroup()||this.getActiveObject();return!!(b&&(b.isMoving||b!==d)||!b&&d||!b&&!d&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||
e.y!==this._previousPointer.y))},__onMouseUp:function(b){var e;e=!0;var d=this._currentTransform,a=this._groupSelector,a=!a||0===a.left&&0===a.top;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(b);d&&(this._finalizeCurrentTransform(),e=!d.actionPerformed);e=e?this.findTarget(b,!0):d.target;d=this._shouldRender(e,this.getPointer(b));e||!a?this._maybeGroupObjects(b):(this._groupSelector=null,this._currentTransform=null);e&&(e.isMoving=!1);this._handleCursorAndEvent(b,
e,"up");e&&(e.__corner=0);d&&this.renderAll()},_handleCursorAndEvent:function(b,e,d){this._setCursorFromEvent(b,e);this._handleEvent(b,d,e?e:null)},_handleEvent:function(b,e,d){var a=this.targets||[];b={e:b,target:d,subTargets:a};this.fire("mouse:"+e,b);d&&d.fire("mouse"+e,b);for(d=0;d<a.length;d++)a[d].fire("mouse"+e,b)},_finalizeCurrentTransform:function(){var b=this._currentTransform,e=b.target;e._scaling&&(e._scaling=!1);e.setCoords();this._restoreOriginXY(e);(b.actionPerformed||this.stateful&&
e.hasStateChanged())&&(this.fire("object:modified",{target:e}),e.fire("modified"))},_restoreOriginXY:function(b){if(this._previousOriginX&&this._previousOriginY){var e=b.translateToOriginPoint(b.getCenterPoint(),this._previousOriginX,this._previousOriginY);b.originX=this._previousOriginX;b.originY=this._previousOriginY;b.left=e.x;b.top=e.y;this._previousOriginY=this._previousOriginX=null}},_onMouseDownInDrawingMode:function(b){this._isCurrentlyDrawing=!0;this.discardActiveObject(b).renderAll();this.clipTo&&
fabric.util.clipContext(this,this.contextTop);var e=this.getPointer(b);this.freeDrawingBrush.onMouseDown(e);this._handleEvent(b,"down")},_onMouseMoveInDrawingMode:function(b){if(this._isCurrentlyDrawing){var e=this.getPointer(b);this.freeDrawingBrush.onMouseMove(e)}this.setCursor(this.freeDrawingCursor);this._handleEvent(b,"move")},_onMouseUpInDrawingMode:function(b){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this._handleEvent(b,"up")},__onMouseDown:function(b){if(("which"in
b?1===b.which:0===b.button)||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(b);if(!this._currentTransform){var e=this.findTarget(b),d=this.getPointer(b,!0);this._previousPointer=d;var a=this._shouldRender(e,d),c=this._shouldGroup(b,e);this._shouldClearSelection(b,e)?this._clearSelection(b,e,d):c&&(this._handleGrouping(b,e),e=this.getActiveGroup());e&&(!e.selectable||!e.__corner&&c||(this._beforeTransform(b,e),this._setupCurrentTransform(b,e)),e!==this.getActiveGroup()&&
e!==this.getActiveObject()&&(this.deactivateAll(),e.selectable&&this.setActiveObject(e,b)));this._handleEvent(b,"down",e?e:null);a&&this.renderAll()}}},_beforeTransform:function(b,e){this.stateful&&e.saveState();e._findTargetCorner(this.getPointer(b))&&this.onBeforeScaleRotate(e)},_clearSelection:function(b,e,d){this.deactivateAllWithDispatch(b);e&&e.selectable?this.setActiveObject(e,b):this.selection&&(this._groupSelector={ex:d.x,ey:d.y,top:0,left:0})},_setOriginToCenter:function(b){this._previousOriginX=
this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;var e=b.getCenterPoint();b.originX="center";b.originY="center";b.left=e.x;b.top=e.y;this._currentTransform.left=b.left;this._currentTransform.top=b.top},_setCenterToOrigin:function(b){var e=b.translateToOriginPoint(b.getCenterPoint(),this._previousOriginX,this._previousOriginY);b.originX=this._previousOriginX;b.originY=this._previousOriginY;b.left=e.x;b.top=e.y;this._previousOriginY=this._previousOriginX=
null},__onMouseMove:function(b){var e,d;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(b);if(!("undefined"!=typeof b.touches&&1<b.touches.length)){var a=this._groupSelector;a?(d=this.getPointer(b,!0),a.left=d.x-a.ex,a.top=d.y-a.ey,this.renderTop()):this._currentTransform?this._transformObject(b):(e=this.findTarget(b),this._setCursorFromEvent(b,e));this._handleEvent(b,"move",e?e:null)}},_transformObject:function(b){var e=this.getPointer(b),d=this._currentTransform;d.reset=!1;d.target.isMoving=
!0;this._beforeScaleTransform(b,d);this._performTransformAction(b,d,e);d.actionPerformed&&this.renderAll()},_performTransformAction:function(b,e,d){var a=d.x;d=d.y;var c=e.target,f=e.action,g=!1;"rotate"===f?(g=this._rotateObject(a,d))&&this._fire("rotating",c,b):"scale"===f?(g=this._onScale(b,e,a,d))&&this._fire("scaling",c,b):"scaleX"===f?(g=this._scaleObject(a,d,"x"))&&this._fire("scaling",c,b):"scaleY"===f?(g=this._scaleObject(a,d,"y"))&&this._fire("scaling",c,b):"skewX"===f?(g=this._skewObject(a,
d,"x"))&&this._fire("skewing",c,b):"skewY"===f?(g=this._skewObject(a,d,"y"))&&this._fire("skewing",c,b):(g=this._translateObject(a,d),g&&(this._fire("moving",c,b),this.setCursor(c.moveCursor||this.moveCursor)));e.actionPerformed=g},_fire:function(b,e,d){this.fire("object:"+b,{target:e,e:d});e.fire(b,{e:d})},_beforeScaleTransform:function(b,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var d=this._shouldCenterTransform(e.target);(d&&("center"!==e.originX||"center"!==e.originY)||
!d&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(b,e,d,a){return!b[this.uniScaleKey]&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(d,a,"equally")):(e.currentAction="scale",this._scaleObject(d,a))},_setCursorFromEvent:function(b,e){if(!e)return this.setCursor(this.defaultCursor),!1;var d=e.hoverCursor||this.hoverCursor;
if(e.selectable){var a=this.getActiveGroup();(a=e._findTargetCorner&&(!a||!a.contains(e))&&e._findTargetCorner(this.getPointer(b,!0)))?this._setCornerCursor(a,e,b):this.setCursor(d)}else this.setCursor(d);return!0},_setCornerCursor:function(b,e,d){if(b in h)this.setCursor(this._getRotatedCornerCursor(b,e,d));else{if("mtr"!==b||!e.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(b,e,d){e=Math.round(e.getAngle()%360/
45);return 0>e&&(e+=8),e+=h[b],d[this.altActionKey]&&0===h[b]%2&&(e+=2),e%=8,this.cursorMap[e]}})})();
(function(){var h=Math.min,f=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(e,b){var f=this.getActiveObject();return e[this.selectionKey]&&b&&b.selectable&&(this.getActiveGroup()||f&&f!==b)&&this.selection},_handleGrouping:function(e,b){var f=this.getActiveGroup();(b!==f||(b=this.findTarget(e,!0)))&&(f?this._updateActiveGroup(b,e):this._createActiveGroup(b,e),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(e,b){var f=this.getActiveGroup();
if(f.contains(e)){if(f.removeWithUpdate(e),e.set("active",!1),1===f.size())return this.discardActiveGroup(b),void this.setActiveObject(f.item(0))}else f.addWithUpdate(e);this.fire("selection:created",{target:f,e:b});f.set("active",!0)},_createActiveGroup:function(e,b){if(this._activeObject&&e!==this._activeObject){var f=this._createGroup(e);f.addWithUpdate();this.setActiveGroup(f);this._activeObject=null;this.fire("selection:created",{target:f,e:b})}e.set("active",!0)},_createGroup:function(e){var b=
this.getObjects();e=b.indexOf(this._activeObject)<b.indexOf(e)?[this._activeObject,e]:[e,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new fabric.Group(e,{canvas:this})},_groupSelectedObjects:function(e){var b=this._collectObjects();1===b.length?this.setActiveObject(b[0],e):1<b.length&&(b=new fabric.Group(b.reverse(),{canvas:this}),b.addWithUpdate(),this.setActiveGroup(b,e),b.saveCoords(),this.fire("selection:created",{target:b}),this.renderAll())},_collectObjects:function(){for(var e,
b=[],g=this._groupSelector.ex,d=this._groupSelector.ey,a=g+this._groupSelector.left,c=d+this._groupSelector.top,m=new fabric.Point(h(g,a),h(d,c)),k=new fabric.Point(f(g,a),f(d,c)),g=g===a&&d===c,d=this._objects.length;d--&&(e=this._objects[d],!(e&&e.selectable&&e.visible&&(e.intersectsWithRect(m,k)||e.isContainedWithinRect(m,k)||e.containsPoint(m)||e.containsPoint(k))&&(e.set("active",!0),b.push(e),g))););return b},_maybeGroupObjects:function(e){this.selection&&this._groupSelector&&this._groupSelectedObjects(e);
(e=this.getActiveGroup())&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor));this._currentTransform=this._groupSelector=null}})})();
fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var f=h.format||"png",e=h.quality||1,b=h.multiplier||1;h={left:h.left,top:h.top,width:h.width,height:h.height};return this._isRetinaScaling()&&(b*=fabric.devicePixelRatio),1!==b?this.__toDataURLWithMultiplier(f,e,h,b):this.__toDataURL(f,e,h)},__toDataURL:function(h,f,e){this.renderAll();var b=this.contextContainer.canvas;e=this.__getCroppedCanvas(b,e);"jpg"===h&&(h="jpeg");return fabric.StaticCanvas.supports("toDataURLWithQuality")?
(e||b).toDataURL("image/"+h,f):(e||b).toDataURL("image/"+h)},__getCroppedCanvas:function(h,f){var e,b;return("left"in f||"top"in f||"width"in f||"height"in f)&&(e=fabric.util.createCanvasElement(),b=e.getContext("2d"),e.width=f.width||this.width,e.height=f.height||this.height,b.drawImage(h,-f.left||0,-f.top||0)),e},__toDataURLWithMultiplier:function(h,f,e,b){var g=this.getWidth(),d=this.getHeight(),a=g*b,c=d*b,m=this.getActiveObject(),k=this.getActiveGroup(),p=this.getZoom(),q=p*b/fabric.devicePixelRatio;
1<b&&this.setDimensions({width:a,height:c});this.setZoom(q);e.left&&(e.left*=b);e.top&&(e.top*=b);e.width?e.width*=b:1>b&&(e.width=a);e.height?e.height*=b:1>b&&(e.height=c);k?this._tempRemoveBordersControlsFromGroup(k):m&&this.deactivateAll&&this.deactivateAll();h=this.__toDataURL(h,f,e);return k?this._restoreBordersControlsOnGroup(k):m&&this.setActiveObject&&this.setActiveObject(m),this.setZoom(p),this.setDimensions({width:g,height:d}),h},toDataURLWithMultiplier:function(h,f,e){return this.toDataURL({format:h,
multiplier:f,quality:e})},_tempRemoveBordersControlsFromGroup:function(h){h.origHasControls=h.hasControls;h.origBorderColor=h.borderColor;h.hasControls=!0;h.borderColor="rgba(0,0,0,0)";h.forEachObject(function(f){f.origBorderColor=f.borderColor;f.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(h){h.hideControls=h.origHideControls;h.borderColor=h.origBorderColor;h.forEachObject(function(f){f.borderColor=f.origBorderColor;delete f.origBorderColor})}});
fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(h,f,e){return this.loadFromJSON(h,f,e)},loadFromJSON:function(h,f,e){if(h){var b="string"==typeof h?JSON.parse(h):fabric.util.object.clone(h);this.clear();var g=this;return this._enlivenObjects(b.objects,function(){g._setBgOverlay(b,function(){delete b.objects;delete b.backgroundImage;delete b.overlayImage;delete b.background;delete b.overlay;for(var d in b)g[d]=b[d];f&&f()})},e),this}},_setBgOverlay:function(h,
f){var e=this,b={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(h.backgroundImage||h.overlayImage||h.background||h.overlay))return void(f&&f());var g=function(){b.backgroundImage&&b.overlayImage&&b.backgroundColor&&b.overlayColor&&(e.renderAll(),f&&f())};this.__setBgOverlay("backgroundImage",h.backgroundImage,b,g);this.__setBgOverlay("overlayImage",h.overlayImage,b,g);this.__setBgOverlay("backgroundColor",h.background,b,g);this.__setBgOverlay("overlayColor",h.overlay,
b,g);g()},__setBgOverlay:function(h,f,e,b){var g=this;return f?void("backgroundImage"===h||"overlayImage"===h?fabric.Image.fromObject(f,function(d){g[h]=d;e[h]=!0;b&&b()}):this["set"+fabric.util.string.capitalize(h,!0)](f,function(){e[h]=!0;b&&b()})):void(e[h]=!0)},_enlivenObjects:function(h,f,e){var b=this;if(!h||0===h.length)return void(f&&f());var g=this.renderOnAddRemove;this.renderOnAddRemove=!1;fabric.util.enlivenObjects(h,function(d){d.forEach(function(a,c){b.insertAt(a,c)});b.renderOnAddRemove=
g;f&&f()},null,e)},_toDataURL:function(h,f){this.clone(function(e){f(e.toDataURL(h))})},_toDataURLWithMultiplier:function(h,f,e){this.clone(function(b){e(b.toDataURLWithMultiplier(h,f))})},clone:function(h,f){var e=JSON.stringify(this.toJSON(f));this.cloneWithoutData(function(b){b.loadFromJSON(e,function(){h&&h(b)})})},cloneWithoutData:function(h){var f=fabric.document.createElement("canvas");f.width=this.getWidth();f.height=this.getHeight();var e=new fabric.Canvas(f);e.clipTo=this.clipTo;this.backgroundImage?
(e.setBackgroundImage(this.backgroundImage.src,function(){e.renderAll();h&&h(e)}),e.backgroundImageOpacity=this.backgroundImageOpacity,e.backgroundImageStretch=this.backgroundImageStretch):h&&h(e)}});
(function(h){var f=h.fabric||(h.fabric={});h=f.util.object.extend;var e=f.util.toFixed,b=f.util.string.capitalize,g=f.util.degreesToRadians,d=f.StaticCanvas.supports("setLineDash");f.Object||(f.Object=f.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,
cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,
hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor alignX alignY meetOrSlice skewX skewY".split(" "),
initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof f.Gradient||this.set("fill",new f.Gradient(a.fill));!a.stroke||!a.stroke.colorStops||a.stroke instanceof f.Gradient||this.set("stroke",new f.Gradient(a.stroke))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof f.Pattern||this.set("fill",new f.Pattern(a.fill));!a.stroke||!a.stroke.source||a.stroke instanceof f.Pattern||this.set("stroke",new f.Pattern(a.stroke))},
_initClipping:function(a){a.clipTo&&"string"==typeof a.clipTo&&(a=f.util.getFunctionBody(a.clipTo),"undefined"!=typeof a&&(this.clipTo=new Function("ctx",a)))},setOptions:function(a){for(var b in a)this.set(b,a[b]);this._initGradient(a);this._initPattern(a);this._initClipping(a)},transform:function(a,b){this.group&&!this.group._transformDone&&this.group===this.canvas._activeGroup&&this.group.transform(a);var c=b?this._getLeftTopCoords():this.getCenterPoint();a.translate(c.x,c.y);a.rotate(g(this.angle));
a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1));a.transform(1,0,Math.tan(g(this.skewX)),1,0,0);a.transform(1,Math.tan(g(this.skewY)),0,1,0,0)},toObject:function(a){var b=f.Object.NUM_FRACTION_DIGITS,b={type:this.type,originX:this.originX,originY:this.originY,left:e(this.left,b),top:e(this.top,b),width:e(this.width,b),height:e(this.height,b),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,
strokeWidth:e(this.strokeWidth,b),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:e(this.strokeMiterLimit,b),scaleX:e(this.scaleX,b),scaleY:e(this.scaleY,b),angle:e(this.getAngle(),b),flipX:this.flipX,flipY:this.flipY,opacity:e(this.opacity,b),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),
backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():this.transformMatrix,skewX:e(this.skewX,b),skewY:e(this.skewY,b)};return this.includeDefaultValues||(b=this._removeDefaultValues(b)),f.util.populateWithProperties(this,b,a),b},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var b=f.util.getKlass(a.type).prototype;return b.stateProperties.forEach(function(c){a[c]===
b[c]&&delete a[c];"[object Array]"===Object.prototype.toString.call(a[c])&&"[object Array]"===Object.prototype.toString.call(b[c])&&0===a[c].length&&0===b[c].length&&delete a[c]}),a},toString:function(){return"#<fabric."+b(this.type)+">"},get:function(a){return this[a]},getObjectScaling:function(){var a=this.scaleX,b=this.scaleY;if(this.group)var d=this.group.getObjectScaling(),a=a*d.scaleX,b=b*d.scaleY;return{scaleX:a,scaleY:b}},_setObject:function(a){for(var b in a)this._set(b,a[b])},set:function(a,
b){return"object"==typeof a?this._setObject(a):"function"==typeof b&&"clipTo"!==a?this._set(a,b(this.get(a))):this._set(a,b),this},_set:function(a,b){return("scaleX"===a||"scaleY"===a)&&(b=this._constrainScale(b)),"scaleX"===a&&0>b?(this.flipX=!this.flipX,b*=-1):"scaleY"===a&&0>b?(this.flipY=!this.flipY,b*=-1):"shadow"!==a||!b||b instanceof f.Shadow||(b=new f.Shadow(b)),this[a]=b,"width"!==a&&"height"!==a||(this.minScaleLimit=Math.min(.1,1/Math.max(this.width,this.height))),this},setOnGroup:function(){},
toggle:function(a){var b=this.get(a);return"boolean"==typeof b&&this.set(a,!b),this},setSourcePath:function(a){return this.sourcePath=a,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(a,b){0===this.width&&0===this.height||!this.visible||(a.save(),this._setupCompositeOperation(a),this.drawSelectionBackground(a),b||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&
a.transform.apply(a,this.transformMatrix),this._setOpacity(a),this._setShadow(a),this.clipTo&&f.util.clipContext(this,a),this._render(a,b),this.clipTo&&a.restore(),a.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){this.stroke&&(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke)},
_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill)},_setLineDash:function(a,b,e){b&&(1&b.length&&b.push.apply(b,b),d?a.setLineDash(b):e&&e(a))},_renderControls:function(a,b){if(!(!this.active||b||this.group&&this.group!==this.canvas.getActiveGroup())){var c;c=this.getViewportTransform();var d=this.calcTransformMatrix(),d=f.util.multiplyTransformMatrices(c,d);c=f.util.qrDecompose(d);a.save();a.translate(c.translateX,c.translateY);a.lineWidth=1*this.borderScaleFactor;
a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;this.group&&this.group===this.canvas.getActiveGroup()?(a.rotate(g(c.angle)),this.drawBordersInGroup(a,c)):(a.rotate(g(this.angle)),this.drawBorders(a));this.drawControls(a);a.restore()}},_setShadow:function(a){if(this.shadow){var b=this.canvas&&this.canvas.viewportTransform[0]||1,d=this.canvas&&this.canvas.viewportTransform[3]||1,e=this.getObjectScaling();this.canvas&&this.canvas._isRetinaScaling()&&(b*=f.devicePixelRatio,d*=f.devicePixelRatio);
a.shadowColor=this.shadow.color;a.shadowBlur=this.shadow.blur*(b+d)*(e.scaleX+e.scaleY)/4;a.shadowOffsetX=this.shadow.offsetX*b*e.scaleX;a.shadowOffsetY=this.shadow.offsetY*d*e.scaleY}},_removeShadow:function(a){this.shadow&&(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&((a.save(),this.fill.gradientTransform)&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||
0),"evenodd"===this.fillRule?a.fill("evenodd"):a.fill(),a.restore())},_renderStroke:function(a){this.stroke&&0!==this.strokeWidth&&((this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),a.save(),this._setLineDash(a,this.strokeDashArray,this._renderDashedStroke),this.stroke.gradientTransform)&&a.transform.apply(a,this.stroke.gradientTransform),this.stroke.toLive&&a.translate(-this.width/2+this.stroke.offsetX||0,-this.height/2+this.stroke.offsetY||0),a.stroke(),a.restore())},clone:function(a,
b){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(b),a):new f.Object(this.toObject(b))},cloneAsImage:function(a,b){var c=this.toDataURL(b);return f.util.loadImage(c,function(b){a&&a(new f.Image(b))}),this},toDataURL:function(a){a||(a={});var b=f.util.createCanvasElement(),d=this.getBoundingRect();b.width=d.width;b.height=d.height;f.util.wrapElement(b,"div");b=new f.StaticCanvas(b,{enableRetinaScaling:a.enableRetinaScaling});"jpg"===a.format&&(a.format="jpeg");"jpeg"===
a.format&&(b.backgroundColor="#fff");d={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1);this.setPositionByOrigin(new f.Point(b.getWidth()/2,b.getHeight()/2),"center","center");var e=this.canvas;b.add(this);a=b.toDataURL(a);return this.set(d).setCoords(),this.canvas=e,b.dispose(),a},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,b){b||(b={});var c={colorStops:[]};c.type=
b.type||(b.r1||b.r2?"radial":"linear");c.coords={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2};(b.r1||b.r2)&&(c.coords.r1=b.r1,c.coords.r2=b.r2);b.gradientTransform&&(c.gradientTransform=b.gradientTransform);for(var d in b.colorStops){var e=new f.Color(b.colorStops[d]);c.colorStops.push({offset:d,color:e.toRgb(),opacity:e.getAlpha()})}return this.set(a,f.Gradient.forObject(this,c))},setPatternFill:function(a){return this.set("fill",new f.Pattern(a))},setShadow:function(a){return this.set("shadow",a?new f.Shadow(a):
null)},setColor:function(a){return this.set("fill",a),this},setAngle:function(a){var b=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return b&&this._setOriginToCenter(),this.set("angle",a),b&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&
this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},remove:function(){return this.canvas&&this.canvas.remove(this),this},getLocalPointer:function(a,b){b=b||this.canvas.getPointer(a);var c=new f.Point(b.x,b.y),d=this._getLeftTopCoords();return this.angle&&(c=f.util.rotatePoint(c,d,f.util.degreesToRadians(-this.angle))),{x:c.x-d.x,y:c.y-d.y}},
_setupCompositeOperation:function(a){this.globalCompositeOperation&&(a.globalCompositeOperation=this.globalCompositeOperation)}}),f.util.createAccessors(f.Object),f.Object.prototype.rotate=f.Object.prototype.setAngle,h(f.Object.prototype,f.Observable),f.Object.NUM_FRACTION_DIGITS=2,f.Object.__uid=0)})("undefined"!=typeof exports?exports:this);
(function(){var h=fabric.util.degreesToRadians,f={left:-.5,center:0,right:.5},e={top:-.5,center:0,bottom:.5};fabric.util.object.extend(fabric.Object.prototype,{translateToGivenOrigin:function(b,g,d,a,c){var h,k,p,q=b.x,n=b.y;return"string"==typeof g?g=f[g]:g-=.5,"string"==typeof a?a=f[a]:a-=.5,h=a-g,"string"==typeof d?d=e[d]:d-=.5,"string"==typeof c?c=e[c]:c-=.5,k=c-d,(h||k)&&(p=this._getTransformedDimensions(),q=b.x+h*p.x,n=b.y+k*p.y),new fabric.Point(q,n)},translateToCenterPoint:function(b,e,d){e=
this.translateToGivenOrigin(b,e,d,"center","center");return this.angle?fabric.util.rotatePoint(e,b,h(this.angle)):e},translateToOriginPoint:function(b,e,d){e=this.translateToGivenOrigin(b,"center","center",e,d);return this.angle?fabric.util.rotatePoint(e,b,h(this.angle)):e},getCenterPoint:function(){var b=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(b,this.originX,this.originY)},getPointByOrigin:function(b,e){var d=this.getCenterPoint();return this.translateToOriginPoint(d,
b,e)},toLocalPoint:function(b,e,d){var a,c,f=this.getCenterPoint();return a="undefined"!=typeof e&&"undefined"!=typeof d?this.translateToGivenOrigin(f,"center","center",e,d):new fabric.Point(this.left,this.top),c=new fabric.Point(b.x,b.y),this.angle&&(c=fabric.util.rotatePoint(c,f,-h(this.angle))),c.subtractEquals(a)},setPositionByOrigin:function(b,e,d){b=this.translateToCenterPoint(b,e,d);b=this.translateToOriginPoint(b,this.originX,this.originY);this.set("left",b.x);this.set("top",b.y)},adjustPosition:function(b){var e,
d;e=h(this.angle);d=this.getWidth();var a=Math.cos(e)*d,c=Math.sin(e)*d;e="string"==typeof this.originX?f[this.originX]:this.originX-.5;d="string"==typeof b?f[b]:b-.5;this.left+=a*(d-e);this.top+=c*(d-e);this.setCoords();this.originX=b},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var b=this.getCenterPoint();this.originY=this.originX="center";this.left=b.x;this.top=b.y},_resetOrigin:function(){var b=this.translateToOriginPoint(this.getCenterPoint(),
this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=b.x;this.top=b.y;this._originalOriginY=this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();
(function(){function h(b){return[new fabric.Point(b.tl.x,b.tl.y),new fabric.Point(b.tr.x,b.tr.y),new fabric.Point(b.br.x,b.br.y),new fabric.Point(b.bl.x,b.bl.y)]}var f=fabric.util.degreesToRadians,e=fabric.util.multiplyTransformMatrices;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(b,e){var d=h(this.oCoords);return"Intersection"===fabric.Intersection.intersectPolygonRectangle(d,b,e).status},intersectsWithObject:function(b){return"Intersection"===fabric.Intersection.intersectPolygonPolygon(h(this.oCoords),
h(b.oCoords)).status},isContainedWithinObject:function(b){var e=b.getBoundingRect();b=new fabric.Point(e.left,e.top);e=new fabric.Point(e.left+e.width,e.top+e.height);return this.isContainedWithinRect(b,e)},isContainedWithinRect:function(b,e){var d=this.getBoundingRect();return d.left>=b.x&&d.left+d.width<=e.x&&d.top>=b.y&&d.top+d.height<=e.y},containsPoint:function(b){this.oCoords||this.setCoords();var e=this._getImageLines(this.oCoords);b=this._findCrossPoints(b,e);return 0!==b&&1===b%2},_getImageLines:function(b){return{topline:{o:b.tl,
d:b.tr},rightline:{o:b.tr,d:b.br},bottomline:{o:b.br,d:b.bl},leftline:{o:b.bl,d:b.tl}}},_findCrossPoints:function(b,e){var d,a,c,f,g,h=0,q;for(q in e)if(g=e[q],!(g.o.y<b.y&&g.d.y<b.y||g.o.y>=b.y&&g.d.y>=b.y||(g.o.x===g.d.x&&g.o.x>=b.x?f=g.o.x:(d=(g.d.y-g.o.y)/(g.d.x-g.o.x),a=b.y-0*b.x,c=g.o.y-d*g.o.x,f=-(a-c)/(0-d)),f>=b.x&&(h+=1),2!==h)))break;return h},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){return this.oCoords||
this.setCoords(),fabric.util.makeBoundingBoxFromPoints([this.oCoords.tl,this.oCoords.tr,this.oCoords.br,this.oCoords.bl])},getWidth:function(){return this._getTransformedDimensions().x},getHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(b){return Math.abs(b)<this.minScaleLimit?0>b?-this.minScaleLimit:this.minScaleLimit:b},scale:function(b){return b=this._constrainScale(b),0>b&&(this.flipX=!this.flipX,this.flipY=!this.flipY,b*=-1),this.scaleX=b,this.scaleY=b,this.setCoords(),
this},scaleToWidth:function(b){var e=this.getBoundingRect().width/this.getWidth();return this.scale(b/this.width/e)},scaleToHeight:function(b){var e=this.getBoundingRect().height/this.getHeight();return this.scale(b/this.height/e)},setCoords:function(){var b=f(this.angle),e=this.getViewportTransform(),d=this._calculateCurrentDimensions(),a=d.x,c=d.y;0>a&&(a=Math.abs(a));var d=Math.sin(b),h=Math.cos(b),k=0<a?Math.atan(c/a):0,p=a/Math.cos(k)/2,q=Math.cos(k+b)*p,b=Math.sin(k+b)*p,k=fabric.util.transformPoint(this.getCenterPoint(),
e),e=new fabric.Point(k.x-q,k.y-b),a=new fabric.Point(e.x+a*h,e.y+a*d),c=new fabric.Point(e.x-c*d,e.y+c*h),q=new fabric.Point(k.x+q,k.y+b),b=new fabric.Point((e.x+c.x)/2,(e.y+c.y)/2),k=new fabric.Point((a.x+e.x)/2,(a.y+e.y)/2),p=new fabric.Point((q.x+a.x)/2,(q.y+a.y)/2),n=new fabric.Point((q.x+c.x)/2,(q.y+c.y)/2),d=new fabric.Point(k.x+d*this.rotatingPointOffset,k.y-h*this.rotatingPointOffset);return this.oCoords={tl:e,tr:a,br:q,bl:c,ml:b,mt:k,mr:p,mb:n,mtr:d},this._setCornerCoords&&this._setCornerCoords(),
this},_calcRotateMatrix:function(){if(this.angle){var b=f(this.angle),e=Math.cos(b),b=Math.sin(b);return[e,b,-b,e,0,0]}return[1,0,0,1,0,0]},calcTransformMatrix:function(){var b=this.getCenterPoint(),b=[1,0,0,1,b.x,b.y],f=this._calcRotateMatrix(),d=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0),a=this.group?this.group.calcTransformMatrix():[1,0,0,1,0,0];return a=e(a,b),a=e(a,f),e(a,d)},_calcDimensionsTransformMatrix:function(b,g,d){b=[1,0,Math.tan(f(b)),1];g=[1,Math.tan(f(g)),0,1];d=
e([this.scaleX*(d&&this.flipX?-1:1),0,0,this.scaleY*(d&&this.flipY?-1:1)],b,!0);return e(d,g,!0)}})})();
fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?
fabric.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas.moveTo(this,h),this}});
(function(){function h(f,e){if(e){if(e.toLive)return f+": url(#SVGID_"+e.id+"); ";var b=new fabric.Color(e),g=f+": "+b.toRgb()+"; ",b=b.getAlpha();return 1!==b&&(g+=f+"-opacity: "+b.toString()+"; "),g}return f+": none; "}fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(f){var e=this.fillRule,b=this.strokeWidth?this.strokeWidth:"0",g=this.strokeDashArray?this.strokeDashArray.join(" "):"none",d=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:
"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",m="undefined"!=typeof this.opacity?this.opacity:"1",k=this.visible?"":" visibility: hidden;";f=f?"":this.getSvgFilter();var p=h("fill",this.fill);return[h("stroke",this.stroke),"stroke-width: ",b,"; stroke-dasharray: ",g,"; stroke-linecap: ",d,"; stroke-linejoin: ",a,"; stroke-miterlimit: ",c,"; ",p,"fill-rule: ",e,"; opacity: ",m,";",f,k].join("")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgId:function(){return this.id?
'id="'+this.id+'" ':""},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var f=fabric.util.toFixed,e=this.getAngle(),b=this.getSkewX()%360,g=this.getSkewY()%360,d=this.getCenterPoint(),a=fabric.Object.NUM_FRACTION_DIGITS,d="path-group"===this.type?"":"translate("+f(d.x,a)+" "+f(d.y,a)+")",e=0!==e?" rotate("+f(e,a)+")":"",c=1===this.scaleX&&1===this.scaleY?"":" scale("+f(this.scaleX,a)+" "+f(this.scaleY,a)+")",b=0!==b?" skewX("+f(b,a)+")":"",f=0!==g?" skewY("+f(g,a)+
")":"",g="path-group"===this.type?this.width:0,a="path-group"===this.type?this.height:0;return[d,e,c,this.flipX?" matrix(-1 0 0 1 "+g+" 0) ":"",this.flipY?" matrix(1 0 0 -1 0 "+a+")":"",b,f].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var f=[];return this.fill&&this.fill.toLive&&f.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&f.push(this.stroke.toSVG(this,!1)),this.shadow&&
f.push(this.shadow.toSVG(this)),f}})})();
fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(h){return this.get(h)!==this.originalState[h]},this)},saveState:function(h){return this.stateProperties.forEach(function(f){this.originalState[f]=this.get(f)},this),h&&h.stateProperties&&h.stateProperties.forEach(function(f){this.originalState[f]=this.get(f)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}});
(function(){var h=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(f){if(!this.hasControls||!this.active)return!1;var e,b,g=f.x;f=f.y;this.__corner=0;for(var d in this.oCoords)if(this.isControlVisible(d)&&("mtr"!==d||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==d&&"mr"!==d&&"mb"!==d&&"ml"!==d)&&(b=this._getImageLines(this.oCoords[d].corner),e=this._findCrossPoints({x:g,y:f},b),0!==e&&1===e%2))return this.__corner=
d,d;return!1},_setCornerCoords:function(){var f,e,b=this.oCoords;f=h(45-this.angle);e=.707106*this.cornerSize;var g=e*Math.cos(f),d=e*Math.sin(f),a;for(a in b)f=b[a].x,e=b[a].y,b[a].corner={tl:{x:f-d,y:e-g},tr:{x:f+g,y:e-d},bl:{x:f-g,y:e+d},br:{x:f+d,y:e+g}}},_getNonTransformedDimensions:function(){var f=this.strokeWidth,e=this.width,b=this.height,g=!0,d=!0;return"line"===this.type&&"butt"===this.strokeLineCap&&(d=e,g=b),d&&(b+=0>b?-f:f),g&&(e+=0>e?-f:f),{x:e,y:b}},_getTransformedDimensions:function(f,
e){"undefined"==typeof f&&(f=this.skewX);"undefined"==typeof e&&(e=this.skewY);var b,g,d=this._getNonTransformedDimensions();b=d.x/2;var d=d.y/2,d=[{x:-b,y:-d},{x:b,y:-d},{x:-b,y:d},{x:b,y:d}],a=this._calcDimensionsTransformMatrix(f,e,!1);for(b=0;b<d.length;b++)d[b]=fabric.util.transformPoint(d[b],a);return g=fabric.util.makeBoundingBoxFromPoints(d),{x:g.width,y:g.height}},_calculateCurrentDimensions:function(){var f=this.getViewportTransform(),e=this._getTransformedDimensions();return fabric.util.transformPoint(new fabric.Point(e.x,
e.y),f,!0).scalarAdd(2*this.padding)},drawSelectionBackground:function(f){if(!this.selectionBackgroundColor||this.group||this!==this.canvas.getActiveObject())return this;f.save();var e=this.getCenterPoint(),b=this._calculateCurrentDimensions(),g=this.canvas.viewportTransform;return f.translate(e.x,e.y),f.scale(1/g[0],1/g[3]),f.rotate(h(this.angle)),f.fillStyle=this.selectionBackgroundColor,f.fillRect(-b.x/2,-b.y/2,b.x,b.y),f.restore(),this},drawBorders:function(f){if(!this.hasBorders)return this;
var e=this._calculateCurrentDimensions(),b=1/this.borderScaleFactor,g=e.x+b,e=e.y+b;if(f.save(),f.strokeStyle=this.borderColor,this._setLineDash(f,this.borderDashArray,null),f.strokeRect(-g/2,-e/2,g,e),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls)g=-e/2,f.beginPath(),f.moveTo(0,g),f.lineTo(0,g-this.rotatingPointOffset),f.closePath(),f.stroke();return f.restore(),this},drawBordersInGroup:function(f,e){if(!this.hasBorders)return this;var b=this._getNonTransformedDimensions(),
g=fabric.util.customTransformMatrix(e.scaleX,e.scaleY,e.skewX),g=fabric.util.transformPoint(b,g),d=1/this.borderScaleFactor,b=g.x+d+2*this.padding,g=g.y+d+2*this.padding;return f.save(),this._setLineDash(f,this.borderDashArray,null),f.strokeStyle=this.borderColor,f.strokeRect(-b/2,-g/2,b,g),f.restore(),this},drawControls:function(f){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(),b=e.x,e=e.y,g=this.cornerSize,d=-(b+g)/2,g=-(e+g)/2,a=this.transparentCorners?"stroke":"fill";
return f.save(),f.strokeStyle=f.fillStyle=this.cornerColor,this.transparentCorners||(f.strokeStyle=this.cornerStrokeColor),this._setLineDash(f,this.cornerDashArray,null),this._drawControl("tl",f,a,d,g),this._drawControl("tr",f,a,d+b,g),this._drawControl("bl",f,a,d,g+e),this._drawControl("br",f,a,d+b,g+e),this.get("lockUniScaling")||(this._drawControl("mt",f,a,d+b/2,g),this._drawControl("mb",f,a,d+b/2,g+e),this._drawControl("mr",f,a,d+b,g+e/2),this._drawControl("ml",f,a,d,g+e/2)),this.hasRotatingPoint&&
this._drawControl("mtr",f,a,d+b/2,g-this.rotatingPointOffset),f.restore(),this},_drawControl:function(f,e,b,g,d){if(this.isControlVisible(f)){f=this.cornerSize;var a=!this.transparentCorners&&this.cornerStrokeColor;switch(this.cornerStyle){case "circle":e.beginPath();e.arc(g+f/2,d+f/2,f/2,0,2*Math.PI,!1);e[b]();a&&e.stroke();break;default:"undefined"!=typeof G_vmlCanvasManager||this.transparentCorners||e.clearRect(g,d,f,f),e[b+"Rect"](g,d,f,f),a&&e.strokeRect(g,d,f,f)}}},isControlVisible:function(f){return this._getControlsVisibility()[f]},
setControlVisible:function(f,e){return this._getControlsVisibility()[f]=e,this},setControlsVisibility:function(f){f||(f={});for(var e in f)this.setControlVisible(e,f[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})})();
fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,f){f=f||{};var e=function(){},b=f.onComplete||e,g=f.onChange||e,d=this;return fabric.util.animate({startValue:h.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(a){h.set("left",a);d.renderAll();g()},onComplete:function(){h.setCoords();b()}}),this},fxCenterObjectV:function(h,f){f=f||{};var e=function(){},b=f.onComplete||e,g=f.onChange||e,d=this;return fabric.util.animate({startValue:h.get("top"),
endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(a){h.set("top",a);d.renderAll();g()},onComplete:function(){h.setCoords();b()}}),this},fxRemove:function(h,f){f=f||{};var e=function(){},b=f.onComplete||e,g=f.onChange||e,d=this;return fabric.util.animate({startValue:h.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){h.set("active",!1)},onChange:function(a){h.set("opacity",a);d.renderAll();g()},onComplete:function(){d.remove(h);b()}}),this}});
fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var h,f,e=[];for(h in arguments[0])e.push(h);for(var b=0,g=e.length;b<g;b++)h=e[b],f=b!==g-1,this._animate(h,arguments[0][h],arguments[1],f)}else this._animate.apply(this,arguments);return this},_animate:function(h,f,e,b){var g,d=this;f=f.toString();e=e?fabric.util.object.clone(e):{};~h.indexOf(".")&&(g=h.split("."));var a=g?this.get(g[0])[g[1]]:this.get(h);"from"in e||(e.from=a);
f=~f.indexOf("=")?a+parseFloat(f.replace("=","")):parseFloat(f);fabric.util.animate({startValue:e.from,endValue:f,byValue:e.by,easing:e.easing,duration:e.duration,abort:e.abort&&function(){return e.abort.call(d)},onChange:function(a){g?d[g[0]][g[1]]=a:d.set(h,a);b||e.onChange&&e.onChange()},onComplete:function(){b||(d.setCoords(),e.onComplete&&e.onComplete())}})}});
(function(h){function f(a,b){var c=a.origin,d=a.axis1,e=a.axis2,f=a.dimension,g=b.nearest,h=b.center,r=b.farthest;return function(){switch(this.get(c)){case g:return Math.min(this.get(d),this.get(e));case h:return Math.min(this.get(d),this.get(e))+.5*this.get(f);case r:return Math.max(this.get(d),this.get(e))}}}var e=h.fabric||(h.fabric={}),b=e.util.object.extend,g={x1:1,x2:1,y1:1,y2:1},d=e.StaticCanvas.supports("setLineDash");return e.Line?void e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,
{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,b){b=b||{};a||(a=[0,0,0,0]);this.callSuper("initialize",b);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",a[3]);this._setWidthHeight(b)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1);this.height=Math.abs(this.y2-this.y1);this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){return this.callSuper("_set",a,b),"undefined"!=
typeof g[a]&&this._setWidthHeight(),this},_getLeftToOriginX:f({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:f({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,b){if(a.beginPath(),b){var c=this.getCenterPoint();a.translate(c.x-this.strokeWidth/2,c.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&d)c=this.calcLinePoints(),
a.moveTo(c.x1,c.y1),a.lineTo(c.x2,c.y2);a.lineWidth=this.strokeWidth;c=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=c},_renderDashedStroke:function(a){var b=this.calcLinePoints();a.beginPath();e.util.drawDashedLine(a,b.x1,b.y1,b.x2,b.y2,this.strokeDashArray);a.closePath()},toObject:function(a){return b(this.callSuper("toObject",a),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,b=this.y1<=this.y2?-1:1;return{x1:a*
this.width*.5,x2:a*this.width*-.5,y1:b*this.height*.5,y2:b*this.height*-.5}},toSVG:function(a){var b=this._createBaseSVGMarkup(),d={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(d=this.calcLinePoints()),b.push("<line ",this.getSvgId(),'x1="',d.x1,'" y1="',d.y1,'" x2="',d.x2,'" y2="',d.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),a?a(b.join("")):b.join("")},complexity:function(){return 1}}),
e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["x1","y1","x2","y2"]),e.Line.fromElement=function(a,c){var d=e.parseAttributes(a,e.Line.ATTRIBUTE_NAMES);return new e.Line([d.x1||0,d.y1||0,d.x2||0,d.y2||0],b(d,c))},void(e.Line.fromObject=function(a){return new e.Line([a.x1,a.y1,a.x2,a.y2],a)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=Math.PI,b=f.util.object.extend;return f.Circle?void f.warn("fabric.Circle is already defined."):(f.Circle=f.util.createClass(f.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*e,initialize:function(b){b=b||{};this.callSuper("initialize",b);this.set("radius",b.radius||0);this.startAngle=b.startAngle||this.startAngle;this.endAngle=b.endAngle||this.endAngle},_set:function(b,d){return this.callSuper("_set",b,d),"radius"===b&&this.setRadius(d),this},toObject:function(e){return b(this.callSuper("toObject",
e),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(b){var d=this._createBaseSVGMarkup(),a=0,c=0,f=(this.endAngle-this.startAngle)%(2*e);0===f?(this.group&&"path-group"===this.group.type&&(a=this.left+this.radius,c=this.top+this.radius),d.push("<circle ",this.getSvgId(),'cx="'+a+'" cy="'+c+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')):d.push('<path d="M '+Math.cos(this.startAngle)*
this.radius+" "+Math.sin(this.startAngle)*this.radius," A "+this.radius+" "+this.radius," 0 ",+(f>e?1:0)+" 1"," "+Math.cos(this.endAngle)*this.radius+" "+Math.sin(this.endAngle)*this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return b?b(d.join("")):d.join("")},_render:function(b,d){b.beginPath();b.arc(d?this.left+this.radius:0,d?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(b);this._renderStroke(b)},
getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(b){return this.radius=b,this.set("width",2*b).set("height",2*b)},complexity:function(){return 1}}),f.Circle.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(["cx","cy","r"]),f.Circle.fromElement=function(e,d){d||(d={});var a=f.parseAttributes(e,f.Circle.ATTRIBUTE_NAMES);if(!("radius"in a&&0<=a.radius))throw Error("value of `r` attribute is required and can not be negative");
a.left=a.left||0;a.top=a.top||0;a=new f.Circle(b(a,d));return a.left-=a.radius,a.top-=a.radius,a},void(f.Circle.fromObject=function(b){return new f.Circle(b)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});return f.Triangle?void f.warn("fabric.Triangle is already defined"):(f.Triangle=f.util.createClass(f.Object,{type:"triangle",initialize:function(e){e=e||{};this.callSuper("initialize",e);this.set("width",e.width||100).set("height",e.height||100)},_render:function(e){var b=this.width/2,f=this.height/2;e.beginPath();e.moveTo(-b,f);e.lineTo(0,-f);e.lineTo(b,f);e.closePath();this._renderFill(e);this._renderStroke(e)},_renderDashedStroke:function(e){var b=this.width/
2,g=this.height/2;e.beginPath();f.util.drawDashedLine(e,-b,g,0,-g,this.strokeDashArray);f.util.drawDashedLine(e,0,-g,b,g,this.strokeDashArray);f.util.drawDashedLine(e,b,g,-b,g,this.strokeDashArray);e.closePath()},toSVG:function(e){var b=this._createBaseSVGMarkup(),f=this.width/2,d=this.height/2,f=[-f+" "+d,"0 "+-d,f+" "+d].join();return b.push("<polygon ",this.getSvgId(),'points="',f,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),e?e(b.join("")):b.join("")},complexity:function(){return 1}}),
void(f.Triangle.fromObject=function(e){return new f.Triangle(e)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=2*Math.PI,b=f.util.object.extend;return f.Ellipse?void f.warn("fabric.Ellipse is already defined."):(f.Ellipse=f.util.createClass(f.Object,{type:"ellipse",rx:0,ry:0,initialize:function(b){b=b||{};this.callSuper("initialize",b);this.set("rx",b.rx||0);this.set("ry",b.ry||0)},_set:function(b,d){switch(this.callSuper("_set",b,d),b){case "rx":this.rx=d;this.set("width",2*d);break;case "ry":this.ry=d,this.set("height",2*d)}return this},getRx:function(){return this.get("rx")*
this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(e){return b(this.callSuper("toObject",e),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(b){var d=this._createBaseSVGMarkup(),a=0,c=0;return this.group&&"path-group"===this.group.type&&(a=this.left+this.rx,c=this.top+this.ry),d.push("<ellipse ",this.getSvgId(),'cx="',a,'" cy="',c,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),
'"/>\n'),b?b(d.join("")):d.join("")},_render:function(b,d){b.beginPath();b.save();b.transform(1,0,0,this.ry/this.rx,0,0);b.arc(d?this.left+this.rx:0,d?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,e,!1);b.restore();this._renderFill(b);this._renderStroke(b)},complexity:function(){return 1}}),f.Ellipse.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(["cx","cy","rx","ry"]),f.Ellipse.fromElement=function(e,d){d||(d={});var a=f.parseAttributes(e,f.Ellipse.ATTRIBUTE_NAMES);a.left=a.left||0;a.top=a.top||0;a=
new f.Ellipse(b(a,d));return a.top-=a.ry,a.left-=a.rx,a},void(f.Ellipse.fromObject=function(b){return new f.Ellipse(b)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;if(f.Rect)return void f.warn("fabric.Rect is already defined");h=f.Object.prototype.stateProperties.concat();h.push("rx","ry","x","y");f.Rect=f.util.createClass(f.Object,{stateProperties:h,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(b){b=b||{};this.callSuper("initialize",b);this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(b,e){if(1===this.width&&
1===this.height)return void b.fillRect(-.5,-.5,1,1);var d=this.rx?Math.min(this.rx,this.width/2):0,a=this.ry?Math.min(this.ry,this.height/2):0,c=this.width,f=this.height,g=e?this.left:-this.width/2,h=e?this.top:-this.height/2,q=0!==d||0!==a;b.beginPath();b.moveTo(g+d,h);b.lineTo(g+c-d,h);q&&b.bezierCurveTo(g+c-.4477152502*d,h,g+c,h+.4477152502*a,g+c,h+a);b.lineTo(g+c,h+f-a);q&&b.bezierCurveTo(g+c,h+f-.4477152502*a,g+c-.4477152502*d,h+f,g+c-d,h+f);b.lineTo(g+d,h+f);q&&b.bezierCurveTo(g+.4477152502*
d,h+f,g,h+f-.4477152502*a,g,h+f-a);b.lineTo(g,h+a);q&&b.bezierCurveTo(g,h+.4477152502*a,g+.4477152502*d,h,g+d,h);b.closePath();this._renderFill(b);this._renderStroke(b)},_renderDashedStroke:function(b){var e=-this.width/2,d=-this.height/2,a=this.width,c=this.height;b.beginPath();f.util.drawDashedLine(b,e,d,e+a,d,this.strokeDashArray);f.util.drawDashedLine(b,e+a,d,e+a,d+c,this.strokeDashArray);f.util.drawDashedLine(b,e+a,d+c,e,d+c,this.strokeDashArray);f.util.drawDashedLine(b,e,d+c,e,d,this.strokeDashArray);
b.closePath()},toObject:function(b){b=e(this.callSuper("toObject",b),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(b),b},toSVG:function(b){var e=this._createBaseSVGMarkup(),d=this.left,a=this.top;return this.group&&"path-group"===this.group.type||(d=-this.width/2,a=-this.height/2),e.push("<rect ",this.getSvgId(),'x="',d,'" y="',a,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),
'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),b?b(e.join("")):e.join("")},complexity:function(){return 1}});f.Rect.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" "));f.Rect.fromElement=function(b,g){if(!b)return null;g=g||{};var d=f.parseAttributes(b,f.Rect.ATTRIBUTE_NAMES);d.left=d.left||0;d.top=d.top||0;d=new f.Rect(e(g?f.util.object.clone(g):{},d));return d.visible=d.visible&&0<d.width&&0<d.height,d};f.Rect.fromObject=function(b){return new f.Rect(b)}})("undefined"!=
typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});return f.Polyline?void f.warn("fabric.Polyline is already defined"):(f.Polyline=f.util.createClass(f.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(e,b){return f.Polygon.prototype.initialize.call(this,e,b)},_calcDimensions:function(){return f.Polygon.prototype._calcDimensions.call(this)},toObject:function(e){return f.Polygon.prototype.toObject.call(this,e)},toSVG:function(e){return f.Polygon.prototype.toSVG.call(this,e)},_render:function(e,
b){f.Polygon.prototype.commonRender.call(this,e,b)&&(this._renderFill(e),this._renderStroke(e))},_renderDashedStroke:function(e){var b,g;e.beginPath();for(var d=0,a=this.points.length;d<a;d++)b=this.points[d],g=this.points[d+1]||b,f.util.drawDashedLine(e,b.x,b.y,g.x,g.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),f.Polyline.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(),f.Polyline.fromElement=function(e,b){if(!e)return null;b||(b={});var g=f.parsePointsAttribute(e.getAttribute("points")),
d=f.parseAttributes(e,f.Polyline.ATTRIBUTE_NAMES);return new f.Polyline(g,f.util.object.extend(d,b))},void(f.Polyline.fromObject=function(e){return new f.Polyline(e.points,e,!0)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend,b=f.util.array.min,g=f.util.array.max,d=f.util.toFixed;return f.Polygon?void f.warn("fabric.Polygon is already defined"):(f.Polygon=f.util.createClass(f.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.points=a||[];this.callSuper("initialize",b);this._calcDimensions();"top"in b||(this.top=this.minY);"left"in b||(this.left=this.minX);this.pathOffset={x:this.minX+this.width/2,y:this.minY+this.height/
2}},_calcDimensions:function(){var a=this.points,c=b(a,"x"),d=b(a,"y"),e=g(a,"x"),a=g(a,"y");this.width=e-c||0;this.height=a-d||0;this.minX=c||0;this.minY=d||0},toObject:function(a){return e(this.callSuper("toObject",a),{points:this.points.concat()})},toSVG:function(a){for(var b,e=[],f=this._createBaseSVGMarkup(),g=0,h=this.points.length;g<h;g++)e.push(d(this.points[g].x,2),",",d(this.points[g].y,2)," ");return this.group&&"path-group"===this.group.type||(b=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+
") "),f.push("<",this.type," ",this.getSvgId(),'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),b," ",this.getSvgTransformMatrix(),'"/>\n'),a?a(f.join("")):f.join("")},_render:function(a,b){this.commonRender(a,b)&&(this._renderFill(a),(this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a)))},commonRender:function(a,b){var c,d=this.points.length;if(!d||isNaN(this.points[d-1].y))return!1;b||a.translate(-this.pathOffset.x,-this.pathOffset.y);
a.beginPath();a.moveTo(this.points[0].x,this.points[0].y);for(var e=0;e<d;e++)c=this.points[e],a.lineTo(c.x,c.y);return!0},_renderDashedStroke:function(a){f.Polyline.prototype._renderDashedStroke.call(this,a);a.closePath()},complexity:function(){return this.points.length}}),f.Polygon.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(),f.Polygon.fromElement=function(a,b){if(!a)return null;b||(b={});var c=f.parsePointsAttribute(a.getAttribute("points")),d=f.parseAttributes(a,f.Polygon.ATTRIBUTE_NAMES);return new f.Polygon(c,
e(d,b))},void(f.Polygon.fromObject=function(a){return new f.Polygon(a.points,a,!0)}))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.array.min,b=f.util.array.max,g=f.util.object.extend,d=Object.prototype.toString,a=f.util.drawArc,c={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},m={m:"l",M:"L"};return f.Path?void f.warn("fabric.Path is already defined"):(f.Path=f.util.createClass(f.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.setOptions(b);a||(a=[]);var c="[object Array]"===d.call(a);(this.path=c?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))&&
(c||(this.path=this._parsePath()),this._setPositionDimensions(b),b.sourcePath&&this.setSourcePath(b.sourcePath))},_setPositionDimensions:function(a){var b=this._parseDimensions();this.minX=b.left;this.minY=b.top;this.width=b.width;this.height=b.height;"undefined"==typeof a.left&&(this.left=b.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0));"undefined"==typeof a.top&&(this.top=b.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0));this.pathOffset=
this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_renderPathCommands:function(b){var c,d,e,f=null,g=0,h=0,k=0,m=0,v=0,x=0,z=-this.pathOffset.x,w=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(z=0,w=0);b.beginPath();for(var B=0,C=this.path.length;B<C;++B){switch(c=this.path[B],c[0]){case "l":k+=c[1];m+=c[2];b.lineTo(k+z,m+w);break;case "L":k=c[1];m=c[2];b.lineTo(k+z,m+w);break;case "h":k+=c[1];b.lineTo(k+z,m+w);break;case "H":k=c[1];b.lineTo(k+z,m+w);break;case "v":m+=
c[1];b.lineTo(k+z,m+w);break;case "V":m=c[1];b.lineTo(k+z,m+w);break;case "m":k+=c[1];m+=c[2];g=k;h=m;b.moveTo(k+z,m+w);break;case "M":k=c[1];m=c[2];g=k;h=m;b.moveTo(k+z,m+w);break;case "c":d=k+c[5];e=m+c[6];v=k+c[3];x=m+c[4];b.bezierCurveTo(k+c[1]+z,m+c[2]+w,v+z,x+w,d+z,e+w);k=d;m=e;break;case "C":k=c[5];m=c[6];v=c[3];x=c[4];b.bezierCurveTo(c[1]+z,c[2]+w,v+z,x+w,k+z,m+w);break;case "s":d=k+c[3];e=m+c[4];null===f[0].match(/[CcSs]/)?(v=k,x=m):(v=2*k-v,x=2*m-x);b.bezierCurveTo(v+z,x+w,k+c[1]+z,m+c[2]+
w,d+z,e+w);v=k+c[1];x=m+c[2];k=d;m=e;break;case "S":d=c[3];e=c[4];null===f[0].match(/[CcSs]/)?(v=k,x=m):(v=2*k-v,x=2*m-x);b.bezierCurveTo(v+z,x+w,c[1]+z,c[2]+w,d+z,e+w);k=d;m=e;v=c[1];x=c[2];break;case "q":d=k+c[3];e=m+c[4];v=k+c[1];x=m+c[2];b.quadraticCurveTo(v+z,x+w,d+z,e+w);k=d;m=e;break;case "Q":d=c[3];e=c[4];b.quadraticCurveTo(c[1]+z,c[2]+w,d+z,e+w);k=d;m=e;v=c[1];x=c[2];break;case "t":d=k+c[1];e=m+c[2];null===f[0].match(/[QqTt]/)?(v=k,x=m):(v=2*k-v,x=2*m-x);b.quadraticCurveTo(v+z,x+w,d+z,e+
w);k=d;m=e;break;case "T":d=c[1];e=c[2];null===f[0].match(/[QqTt]/)?(v=k,x=m):(v=2*k-v,x=2*m-x);b.quadraticCurveTo(v+z,x+w,d+z,e+w);k=d;m=e;break;case "a":a(b,k+z,m+w,[c[1],c[2],c[3],c[4],c[5],c[6]+k+z,c[7]+m+w]);k+=c[6];m+=c[7];break;case "A":a(b,k+z,m+w,[c[1],c[2],c[3],c[4],c[5],c[6]+z,c[7]+w]);k=c[6];m=c[7];break;case "z":case "Z":k=g,m=h,b.closePath()}f=c}},_render:function(a){this._renderPathCommands(a);this._renderFill(a);this._renderStroke(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+
'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){a=g(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(a.sourcePath=this.sourcePath),this.transformMatrix&&(a.transformMatrix=this.transformMatrix),a},toDatalessObject:function(a){a=this.toObject(a);return this.sourcePath&&(a.path=this.sourcePath),delete a.sourcePath,a},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),d="",e=0,f=
this.path.length;e<f;e++)b.push(this.path[e].join(" "));b=b.join(" ");return this.group&&"path-group"===this.group.type||(d=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),c.push("<path ",this.getSvgId(),'d="',b,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),d,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),a?a(c.join("")):c.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a,b,d,e=[],f=[],g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,
h=0,A=this.path.length;h<A;h++){a=this.path[h];d=a.slice(1).trim();for(f.length=0;b=g.exec(d);)f.push(b[0]);a=[a.charAt(0)];d=0;for(var y=f.length;d<y;d++)b=parseFloat(f[d]),isNaN(b)||a.push(b);b=a[0];d=c[b.toLowerCase()];y=m[b]||b;if(a.length-1>d)for(var v=1,x=a.length;v<x;v+=d)e.push([b].concat(a.slice(v,v+d))),b=y;else e.push(a)}return e},_parseDimensions:function(){for(var a,c,d,g,h=[],m=[],u=null,A=0,y=0,v=0,x=0,z=0,w=0,B=0,C=this.path.length;B<C;++B){switch(a=this.path[B],a[0]){case "l":v+=
a[1];x+=a[2];g=[];break;case "L":v=a[1];x=a[2];g=[];break;case "h":v+=a[1];g=[];break;case "H":v=a[1];g=[];break;case "v":x+=a[1];g=[];break;case "V":x=a[1];g=[];break;case "m":v+=a[1];x+=a[2];A=v;y=x;g=[];break;case "M":v=a[1];x=a[2];A=v;y=x;g=[];break;case "c":c=v+a[5];d=x+a[6];z=v+a[3];w=x+a[4];g=f.util.getBoundsOfCurve(v,x,v+a[1],x+a[2],z,w,c,d);v=c;x=d;break;case "C":v=a[5];x=a[6];z=a[3];w=a[4];g=f.util.getBoundsOfCurve(v,x,a[1],a[2],z,w,v,x);break;case "s":c=v+a[3];d=x+a[4];null===u[0].match(/[CcSs]/)?
(z=v,w=x):(z=2*v-z,w=2*x-w);g=f.util.getBoundsOfCurve(v,x,z,w,v+a[1],x+a[2],c,d);z=v+a[1];w=x+a[2];v=c;x=d;break;case "S":c=a[3];d=a[4];null===u[0].match(/[CcSs]/)?(z=v,w=x):(z=2*v-z,w=2*x-w);g=f.util.getBoundsOfCurve(v,x,z,w,a[1],a[2],c,d);v=c;x=d;z=a[1];w=a[2];break;case "q":c=v+a[3];d=x+a[4];z=v+a[1];w=x+a[2];g=f.util.getBoundsOfCurve(v,x,z,w,z,w,c,d);v=c;x=d;break;case "Q":z=a[1];w=a[2];g=f.util.getBoundsOfCurve(v,x,z,w,z,w,a[3],a[4]);v=a[3];x=a[4];break;case "t":c=v+a[1];d=x+a[2];null===u[0].match(/[QqTt]/)?
(z=v,w=x):(z=2*v-z,w=2*x-w);g=f.util.getBoundsOfCurve(v,x,z,w,z,w,c,d);v=c;x=d;break;case "T":c=a[1];d=a[2];null===u[0].match(/[QqTt]/)?(z=v,w=x):(z=2*v-z,w=2*x-w);g=f.util.getBoundsOfCurve(v,x,z,w,z,w,c,d);v=c;x=d;break;case "a":g=f.util.getBoundsOfArc(v,x,a[1],a[2],a[3],a[4],a[5],a[6]+v,a[7]+x);v+=a[6];x+=a[7];break;case "A":g=f.util.getBoundsOfArc(v,x,a[1],a[2],a[3],a[4],a[5],a[6],a[7]);v=a[6];x=a[7];break;case "z":case "Z":v=A,x=y}u=a;g.forEach(function(a){h.push(a.x);m.push(a.y)});h.push(v);
m.push(x)}a=e(h)||0;c=e(m)||0;d=b(h)||0;g=b(m)||0;return{left:a,top:c,width:d-a,height:g-c}}}),f.Path.fromObject=function(a,b){"string"==typeof a.path?f.loadSVGFromURL(a.path,function(c){c=c[0];var d=a.path;delete a.path;f.util.object.extend(c,a);c.setSourcePath(d);b(c)}):b(new f.Path(a.path,a))},f.Path.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat(["d"]),f.Path.fromElement=function(a,b,c){a=f.parseAttributes(a,f.Path.ATTRIBUTE_NAMES);b&&b(new f.Path(a.d,g(a,c)))},void(f.Path.async=!0))})("undefined"!=
typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend,b=f.util.array.invoke,g=f.Object.prototype.toObject;return f.PathGroup?void f.warn("fabric.PathGroup is already defined"):(f.PathGroup=f.util.createClass(f.Path,{type:"path-group",fill:"",initialize:function(b,a){a=a||{};this.paths=b||[];for(var c=this.paths.length;c--;)this.paths[c].group=this;a.toBeParsed&&(this.parseDimensionsFromPaths(a),delete a.toBeParsed);this.setOptions(a);this.setCoords();a.sourcePath&&this.setSourcePath(a.sourcePath)},
parseDimensionsFromPaths:function(b){for(var a,c,d,e=[],g=[],h=this.paths.length;h--;){a=this.paths[h];c=a.height+a.strokeWidth;d=a.width+a.strokeWidth;a=[{x:a.left,y:a.top},{x:a.left+d,y:a.top},{x:a.left,y:a.top+c},{x:a.left+d,y:a.top+c}];d=this.paths[h].transformMatrix;for(var n=0;n<a.length;n++)c=a[n],d&&(c=f.util.transformPoint(c,d,!1)),e.push(c.x),g.push(c.y)}b.width=Math.max.apply(null,e);b.height=Math.max.apply(null,g)},render:function(b){if(this.visible){b.save();this.transformMatrix&&b.transform.apply(b,
this.transformMatrix);this.transform(b);this._setShadow(b);this.clipTo&&f.util.clipContext(this,b);b.translate(-this.width/2,-this.height/2);for(var a=0,c=this.paths.length;a<c;++a)this.paths[a].render(b,!0);this.clipTo&&b.restore();b.restore()}},_set:function(b,a){if("fill"===b&&a&&this.isSameColor())for(var c=this.paths.length;c--;)this.paths[c]._set(b,a);return this.callSuper("_set",b,a)},toObject:function(d){d=e(g.call(this,d),{paths:b(this.getObjects(),"toObject",d)});return this.sourcePath&&
(d.sourcePath=this.sourcePath),d},toDatalessObject:function(b){b=this.toObject(b);return this.sourcePath&&(b.paths=this.sourcePath),b},toSVG:function(b){var a=this.getObjects(),c=this.getPointByOrigin("left","top"),d="translate("+c.x+" "+c.y+")",c=this._createBaseSVGMarkup();c.push("<g ",this.getSvgId(),'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),d,this.getSvgTransform(),'" ',">\n");for(var d=0,e=a.length;d<e;d++)c.push("\t",a[d].toSVG(b));return c.push("</g>\n"),
b?b(c.join("")):c.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var b=this.getObjects()[0].get("fill")||"";return"string"==typeof b&&(b=b.toLowerCase(),this.getObjects().every(function(a){a=a.get("fill")||"";return"string"==typeof a&&a.toLowerCase()===b}))},complexity:function(){return this.paths.reduce(function(b,a){return b+(a&&a.complexity?a.complexity():0)},0)},getObjects:function(){return this.paths}}),
f.PathGroup.fromObject=function(b,a){"string"==typeof b.paths?f.loadSVGFromURL(b.paths,function(c){var d=b.paths;delete b.paths;c=f.util.groupSVGElements(c,b,d);a(c)}):f.util.enlivenObjects(b.paths,function(c){delete b.paths;a(new f.PathGroup(c,b))})},void(f.PathGroup.async=!0))})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend,b=f.util.array.min,g=f.util.array.max,d=f.util.array.invoke;if(!f.Group){var a={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};f.Group=f.util.createClass(f.Object,f.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,initialize:function(a,b,d){b=b||{};this._objects=[];d&&this.callSuper("initialize",b);this._objects=a||[];for(a=this._objects.length;a--;)this._objects[a].group=
this;this.originalState={};b.originX&&(this.originX=b.originX);b.originY&&(this.originY=b.originY);d?this._updateObjectsCoords(!0):(this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",b));this.setCoords();this.saveCoords()},_updateObjectsCoords:function(a){for(var b=this._objects.length;b--;)this._updateObjectCoords(this._objects[b],a)},_updateObjectCoords:function(a,b){if(a.__origHasControls=a.hasControls,a.hasControls=!1,!b){var c=a.getLeft(),d=a.getTop(),e=this.getCenterPoint();
a.set({originalLeft:c,originalTop:d,left:c-e.x,top:d-e.y});a.setCoords()}},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(a){return this._restoreObjectsState(),f.util.resetObjectTransform(this),a&&(this._objects.push(a),a.group=this,a._set("canvas",this.canvas)),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(a){a.set("active",!0);a.group=this},removeWithUpdate:function(a){return this._restoreObjectsState(),
f.util.resetObjectTransform(this),this.forEachObject(this._setObjectActive,this),this.remove(a),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(a){a.group=this;a._set("canvas",this.canvas)},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,stroke:!0,strokeWidth:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,b){var c=this._objects.length;
if(this.delegatedProperties[a]||"canvas"===a)for(;c--;)this._objects[c].set(a,b);else for(;c--;)this._objects[c].setOnGroup(a,b);this.callSuper("_set",a,b)},toObject:function(a){return e(this.callSuper("toObject",a),{objects:d(this._objects,"toObject",a)})},render:function(a){if(this.visible){a.save();this.transformMatrix&&a.transform.apply(a,this.transformMatrix);this.transform(a);this._setShadow(a);this.clipTo&&f.util.clipContext(this,a);this._transformDone=!0;for(var b=0,c=this._objects.length;b<
c;b++)this._renderObject(this._objects[b],a);this.clipTo&&a.restore();a.restore();this._transformDone=!1}},_renderControls:function(a,b){this.callSuper("_renderControls",a,b);for(var c=0,d=this._objects.length;c<d;c++)this._objects[c]._renderControls(a)},_renderObject:function(a,b){if(a.visible){var c=a.hasRotatingPoint;a.hasRotatingPoint=!1;a.render(b);a.hasRotatingPoint=c}},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(a){var b=
a.calcTransformMatrix(),b=f.util.qrDecompose(b),c=new f.Point(b.translateX,b.translateY);return a.scaleX=b.scaleX,a.scaleY=b.scaleY,a.skewX=b.skewX,a.skewY=b.skewY,a.angle=b.angle,a.flipX=!1,a.flipY=!1,a.setPositionByOrigin(c,"center","center"),a},_restoreObjectState:function(a){return this.realizeTransform(a),a.setCoords(),a.hasControls=a.__origHasControls,delete a.__origHasControls,a.set("active",!1),delete a.group,this},destroy:function(){return this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=
this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(a){a.setCoords()}),this},_calcBounds:function(a){for(var b,c,d,e=[],f=[],g=["tr","br","bl","tl"],h=0,u=this._objects.length,A=g.length;h<u;++h)for(b=this._objects[h],b.setCoords(),d=0;d<A;d++)c=g[d],e.push(b.oCoords[c].x),f.push(b.oCoords[c].y);this.set(this._getBounds(e,f,a))},
_getBounds:function(a,d,e){var c=f.util.invertTransform(this.getViewportTransform()),h=f.util.transformPoint(new f.Point(b(a),b(d)),c);a=f.util.transformPoint(new f.Point(g(a),g(d)),c);a={width:a.x-h.x||0,height:a.y-h.y||0};return e||(a.left=h.x||0,a.top=h.y||0,"center"===this.originX&&(a.left+=a.width/2),"right"===this.originX&&(a.left+=a.width),"center"===this.originY&&(a.top+=a.height/2),"bottom"===this.originY&&(a.top+=a.height)),a},toSVG:function(a){var b=this._createBaseSVGMarkup();b.push("<g ",
this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'" style="',this.getSvgFilter(),'">\n');for(var c=0,d=this._objects.length;c<d;c++)b.push("\t",this._objects[c].toSVG(a));return b.push("</g>\n"),a?a(b.join("")):b.join("")},get:function(b){if(b in a){if(this[b])return this[b];for(var c=0,d=this._objects.length;c<d;c++)if(this._objects[c][b])return!0;return!1}return b in this.delegatedProperties?this._objects[0]&&this._objects[0].get(b):this[b]}});f.Group.fromObject=
function(a,b){f.util.enlivenObjects(a.objects,function(c){delete a.objects;b&&b(new f.Group(c,a,!0))})};f.Group.async=!0}})("undefined"!=typeof exports?exports:this);
(function(h){var f=fabric.util.object.extend;return h.fabric||(h.fabric={}),h.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",strokeWidth:0,_lastScaleX:1,_lastScaleY:1,initialize:function(e,b){b||(b={});this.filters=[];this.resizeFilters=[];this.callSuper("initialize",b);this._initElement(e,b)},getElement:function(){return this._element},setElement:function(e,
b,f){return this._element=e,this._originalElement=e,this._initConfig(f),0!==this.filters.length?this.applyFilters(b):b&&b(),this},setCrossOrigin:function(e){return this.crossOrigin=e,this._element.crossOrigin=e,this},getOriginalSize:function(){var e=this.getElement();return{width:e.width,height:e.height}},_stroke:function(e){if(this.stroke&&0!==this.strokeWidth){var b=this.width/2,f=this.height/2;e.beginPath();e.moveTo(-b,-f);e.lineTo(b,-f);e.lineTo(b,f);e.lineTo(-b,f);e.lineTo(-b,-f);e.closePath()}},
_renderDashedStroke:function(e){var b=-this.width/2,f=-this.height/2,d=this.width,a=this.height;e.save();this._setStrokeStyles(e);e.beginPath();fabric.util.drawDashedLine(e,b,f,b+d,f,this.strokeDashArray);fabric.util.drawDashedLine(e,b+d,f,b+d,f+a,this.strokeDashArray);fabric.util.drawDashedLine(e,b+d,f+a,b,f+a,this.strokeDashArray);fabric.util.drawDashedLine(e,b,f+a,b,f,this.strokeDashArray);e.closePath();e.restore()},toObject:function(e){var b=[],g=[],d=this._originalElement,a=1,c=1;this.filters.forEach(function(d){d&&
("Resize"===d.type&&(a*=d.scaleX,c*=d.scaleY),b.push(d.toObject()))});this.resizeFilters.forEach(function(a){a&&g.push(a.toObject())});e=f(this.callSuper("toObject",e),{src:d?d.src||d._src:"",filters:b,resizeFilters:g,crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice});return e.width/=a,e.height/=c,this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(e){var b=this._createBaseSVGMarkup(),f=-this.width/2,d=-this.height/2,a="none";if(this.group&&
"path-group"===this.group.type&&(f=this.left,d=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(a="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),b.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',"<image ",this.getSvgId(),'xlink:href="',this.getSvgSrc(),'" x="',f,'" y="',d,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',a,'"',"></image>\n"),this.stroke||this.strokeDashArray)a=this.fill,this.fill=
null,b.push("<rect ",'x="',f,'" y="',d,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=a;return b.push("</g>\n"),e?e(b.join("")):b.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(e,b,f){fabric.util.loadImage(e,function(d){return this.setElement(d,b,f)},this,f&&f.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(e,b){this.constructor.fromObject(this.toObject(b),
e)},applyFilters:function(e,b,f,d){if(b=b||this.filters,f=f||this._originalElement){var a=f,c=fabric.util.createCanvasElement(),g=fabric.util.createImage(),h=this;return c.width=a.width,c.height=a.height,c.getContext("2d").drawImage(a,0,0,a.width,a.height),0===b.length?(this._element=f,e&&e(),c):(b.forEach(function(a){a&&a.applyTo(c,a.scaleX||h.scaleX,a.scaleY||h.scaleY);!d&&a&&"Resize"===a.type&&(h.width*=a.scaleX,h.height*=a.scaleY)}),g.width=c.width,g.height=c.height,fabric.isLikelyNode?(g.src=
c.toBuffer(void 0,fabric.Image.pngCompression),h._element=g,!d&&(h._filteredEl=g),e&&e()):(g.onload=function(){h._element=g;!d&&(h._filteredEl=g);e&&e();g.onload=c=a=null},g.src=c.toDataURL("image/png")),c)}},_render:function(e,b){var f,d,a,c=this._findMargins();f=b?this.left:-this.width/2;d=b?this.top:-this.height/2;"slice"===this.meetOrSlice&&(e.beginPath(),e.rect(f,d,this.width,this.height),e.clip());!1===this.isMoving&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,
this._lastScaleY=this.scaleY,a=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):a=this._element;a&&e.drawImage(a,f+c.marginX,d+c.marginY,c.width,c.height);this._stroke(e);this._renderStroke(e)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var e,b,f=this.width,d=this.height,a=0,c=0;return"none"===this.alignX&&"none"===this.alignY||(e=[this.width/this._element.width,this.height/this._element.height],
b="meet"===this.meetOrSlice?Math.min.apply(null,e):Math.max.apply(null,e),f=this._element.width*b,d=this._element.height*b,"Mid"===this.alignX&&(a=(this.width-f)/2),"Max"===this.alignX&&(a=this.width-f),"Mid"===this.alignY&&(c=(this.height-d)/2),"Max"===this.alignY&&(c=this.height-d)),{width:f,height:d,marginX:a,marginY:c}},_resetWidthHeight:function(){var e=this.getElement();this.set("width",e.width);this.set("height",e.height)},_initElement:function(e,b){this.setElement(fabric.util.getById(e),null,
b);fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(e){e||(e={});this.setOptions(e);this._setWidthHeight(e);this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(e,b){e&&e.length?fabric.util.enlivenObjects(e,function(e){b&&b(e)},"fabric.Image.filters"):b&&b()},_setWidthHeight:function(e){this.width="width"in e?e.width:this.getElement()?this.getElement().width||0:0;this.height="height"in e?e.height:this.getElement()?
this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(e,b){fabric.util.loadImage(e.src,function(f){fabric.Image.prototype._initFilters.call(e,e.filters,function(d){e.filters=d||[];fabric.Image.prototype._initFilters.call(e,e.resizeFilters,function(a){e.resizeFilters=a||[];a=new fabric.Image(f,e);b&&b(a)})})},null,e.crossOrigin)},fabric.Image.fromURL=function(e,
b,f){fabric.util.loadImage(e,function(d){b&&b(new fabric.Image(d,f))},null,f&&f.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(e,b,g){var d;e=fabric.parseAttributes(e,fabric.Image.ATTRIBUTE_NAMES);e.preserveAspectRatio&&(d=fabric.util.parsePreserveAspectRatioAttribute(e.preserveAspectRatio),f(e,d));fabric.Image.fromURL(e["xlink:href"],b,f(g?fabric.util.object.clone(g):{},e))},
fabric.Image.async=!0,void(fabric.Image.pngCompression=1))})("undefined"!=typeof exports?exports:this);
fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.getAngle()%360;return 0<h?90*Math.round((h-1)/90):90*Math.round(h/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(h){h=h||{};var f=function(){},e=h.onComplete||f,b=h.onChange||f,g=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(d){g.setAngle(d);
b()},onComplete:function(){g.setCoords();e()},onStart:function(){g.set("active",!1)}}),this}});fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.renderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.renderAll.bind(this)}),this}});fabric.Image.filters=fabric.Image.filters||{};
fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var f in h)this[f]=h[f]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}});
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Brightness=f.util.createClass(f.Image.filters.BaseFilter,{type:"Brightness",initialize:function(b){b=b||{};this.brightness=b.brightness||0},applyTo:function(b){var e=b.getContext("2d");b=e.getImageData(0,0,b.width,b.height);for(var d=b.data,a=this.brightness,c=0,f=d.length;c<f;c+=4)d[c]+=a,d[c+1]+=a,d[c+2]+=a;e.putImageData(b,0,0)},toObject:function(){return e(this.callSuper("toObject"),{brightness:this.brightness})}});
f.Image.filters.Brightness.fromObject=function(b){return new f.Image.filters.Brightness(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Convolute=f.util.createClass(f.Image.filters.BaseFilter,{type:"Convolute",initialize:function(b){b=b||{};this.opaque=b.opaque;this.matrix=b.matrix||[0,0,0,0,1,0,0,0,0]},applyTo:function(b){var e,d,a,c,f,h,p,q,n,t=this.matrix,r=b.getContext("2d");e=r.getImageData(0,0,b.width,b.height);b=Math.round(Math.sqrt(t.length));for(var u=Math.floor(b/2),A=e.data,y=e.width,v=e.height,x=r.createImageData(y,v),z=x.data,w=this.opaque?
1:0,B=0;B<v;B++)for(var C=0;C<y;C++){f=4*(B*y+C);for(var E=c=a=d=e=0;E<b;E++)for(var I=0;I<b;I++)p=B+E-u,h=C+I-u,0>p||p>v||0>h||h>y||(q=4*(p*y+h),n=t[E*b+I],e+=A[q]*n,d+=A[q+1]*n,a+=A[q+2]*n,c+=A[q+3]*n);z[f]=e;z[f+1]=d;z[f+2]=a;z[f+3]=c+w*(255-c)}r.putImageData(x,0,0)},toObject:function(){return e(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}});f.Image.filters.Convolute.fromObject=function(b){return new f.Image.filters.Convolute(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.GradientTransparency=f.util.createClass(f.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(b){b=b||{};this.threshold=b.threshold||100},applyTo:function(b){var e=b.getContext("2d");b=e.getImageData(0,0,b.width,b.height);for(var d=b.data,a=this.threshold,c=d.length,f=0,h=d.length;f<h;f+=4)d[f+3]=a+255*(c-f)/c;e.putImageData(b,0,0)},toObject:function(){return e(this.callSuper("toObject"),{threshold:this.threshold})}});
f.Image.filters.GradientTransparency.fromObject=function(b){return new f.Image.filters.GradientTransparency(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.Grayscale=f.util.createClass(f.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(e){for(var b=e.getContext("2d"),f=b.getImageData(0,0,e.width,e.height),d=f.data,a=f.width*f.height*4,c=0;c<a;)e=(d[c]+d[c+1]+d[c+2])/3,d[c]=e,d[c+1]=e,d[c+2]=e,c+=4;b.putImageData(f,0,0)}});f.Image.filters.Grayscale.fromObject=function(){return new f.Image.filters.Grayscale}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.Invert=f.util.createClass(f.Image.filters.BaseFilter,{type:"Invert",applyTo:function(e){var b=e.getContext("2d"),f=b.getImageData(0,0,e.width,e.height),d=f.data,a=d.length;for(e=0;e<a;e+=4)d[e]=255-d[e],d[e+1]=255-d[e+1],d[e+2]=255-d[e+2];b.putImageData(f,0,0)}});f.Image.filters.Invert.fromObject=function(){return new f.Image.filters.Invert}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Mask=f.util.createClass(f.Image.filters.BaseFilter,{type:"Mask",initialize:function(b){b=b||{};this.mask=b.mask;this.channel=-1<[0,1,2,3].indexOf(b.channel)?b.channel:0},applyTo:function(b){if(this.mask){var e=b.getContext("2d"),d=e.getImageData(0,0,b.width,b.height),a=d.data,c=this.mask.getElement(),h=f.util.createCanvasElement(),k=this.channel,p=d.width*d.height*4;h.width=b.width;h.height=b.height;h.getContext("2d").drawImage(c,
0,0,b.width,b.height);c=h.getContext("2d").getImageData(0,0,b.width,b.height).data;for(b=0;b<p;b+=4)a[b+3]=c[b+k];e.putImageData(d,0,0)}},toObject:function(){return e(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}});f.Image.filters.Mask.fromObject=function(b,e){f.util.loadImage(b.mask.src,function(d){b.mask=new f.Image(d,b.mask);e&&e(new f.Image.filters.Mask(b))})};f.Image.filters.Mask.async=!0})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Noise=f.util.createClass(f.Image.filters.BaseFilter,{type:"Noise",initialize:function(b){b=b||{};this.noise=b.noise||0},applyTo:function(b){for(var e=b.getContext("2d"),d=e.getImageData(0,0,b.width,b.height),a=d.data,c=this.noise,f=0,h=a.length;f<h;f+=4)b=(.5-Math.random())*c,a[f]+=b,a[f+1]+=b,a[f+2]+=b;e.putImageData(d,0,0)},toObject:function(){return e(this.callSuper("toObject"),{noise:this.noise})}});f.Image.filters.Noise.fromObject=
function(b){return new f.Image.filters.Noise(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Pixelate=f.util.createClass(f.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(b){b=b||{};this.blocksize=b.blocksize||4},applyTo:function(b){var e,d,a,c,f,h,p=b.getContext("2d"),q=p.getImageData(0,0,b.width,b.height),n=q.data,t=q.height,r=q.width;for(e=0;e<t;e+=this.blocksize)for(d=0;d<r;d+=this.blocksize){b=4*e*r+4*d;a=n[b];c=n[b+1];f=n[b+2];h=n[b+3];for(var u=e,A=e+this.blocksize;u<A;u++)for(var y=d,v=
d+this.blocksize;y<v;y++)b=4*u*r+4*y,n[b]=a,n[b+1]=c,n[b+2]=f,n[b+3]=h}p.putImageData(q,0,0)},toObject:function(){return e(this.callSuper("toObject"),{blocksize:this.blocksize})}});f.Image.filters.Pixelate.fromObject=function(b){return new f.Image.filters.Pixelate(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.RemoveWhite=f.util.createClass(f.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(b){b=b||{};this.threshold=b.threshold||30;this.distance=b.distance||20},applyTo:function(b){for(var e,d,a=b.getContext("2d"),c=a.getImageData(0,0,b.width,b.height),f=c.data,h=this.distance,p=255-this.threshold,q=Math.abs,n=0,t=f.length;n<t;n+=4)b=f[n],e=f[n+1],d=f[n+2],b>p&&e>p&&d>p&&q(b-e)<h&&q(b-d)<h&&q(e-d)<h&&(f[n+3]=
0);a.putImageData(c,0,0)},toObject:function(){return e(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}});f.Image.filters.RemoveWhite.fromObject=function(b){return new f.Image.filters.RemoveWhite(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.Sepia=f.util.createClass(f.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(e){var b,f=e.getContext("2d"),d=f.getImageData(0,0,e.width,e.height),a=d.data,c=a.length;for(e=0;e<c;e+=4)b=.3*a[e]+.59*a[e+1]+.11*a[e+2],a[e]=b+100,a[e+1]=b+50,a[e+2]=b+255;f.putImageData(d,0,0)}});f.Image.filters.Sepia.fromObject=function(){return new f.Image.filters.Sepia}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.Sepia2=f.util.createClass(f.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(e){var b,f,d,a=e.getContext("2d"),c=a.getImageData(0,0,e.width,e.height),h=c.data,k=h.length;for(e=0;e<k;e+=4)b=h[e],f=h[e+1],d=h[e+2],h[e]=(.393*b+.769*f+.189*d)/1.351,h[e+1]=(.349*b+.686*f+.168*d)/1.203,h[e+2]=(.272*b+.534*f+.131*d)/2.14;a.putImageData(c,0,0)}});f.Image.filters.Sepia2.fromObject=function(){return new f.Image.filters.Sepia2}})("undefined"!=
typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Tint=f.util.createClass(f.Image.filters.BaseFilter,{type:"Tint",initialize:function(b){b=b||{};this.color=b.color||"#000000";this.opacity="undefined"!=typeof b.opacity?b.opacity:(new f.Color(this.color)).getAlpha()},applyTo:function(b){var e,d,a,c,h,k,p,q=b.getContext("2d"),n=q.getImageData(0,0,b.width,b.height),t=n.data,r=t.length;e=(new f.Color(this.color)).getSource();b=e[0]*this.opacity;d=e[1]*this.opacity;a=e[2]*
this.opacity;p=1-this.opacity;for(e=0;e<r;e+=4)c=t[e],h=t[e+1],k=t[e+2],t[e]=b+c*p,t[e+1]=d+h*p,t[e+2]=a+k*p;q.putImageData(n,0,0)},toObject:function(){return e(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}});f.Image.filters.Tint.fromObject=function(b){return new f.Image.filters.Tint(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.Multiply=f.util.createClass(f.Image.filters.BaseFilter,{type:"Multiply",initialize:function(b){b=b||{};this.color=b.color||"#000000"},applyTo:function(b){var e,d=b.getContext("2d"),a=d.getImageData(0,0,b.width,b.height),c=a.data,h=c.length;e=(new f.Color(this.color)).getSource();for(b=0;b<h;b+=4)c[b]*=e[0]/255,c[b+1]*=e[1]/255,c[b+2]*=e[2]/255;d.putImageData(a,0,0)},toObject:function(){return e(this.callSuper("toObject"),
{color:this.color})}});f.Image.filters.Multiply.fromObject=function(b){return new f.Image.filters.Multiply(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric;f.Image.filters.Blend=f.util.createClass(f.Image.filters.BaseFilter,{type:"Blend",initialize:function(e){e=e||{};this.color=e.color||"#000";this.image=e.image||!1;this.mode=e.mode||"multiply";this.alpha=e.alpha||1},applyTo:function(e){var b,g,d,a,c,h,k,p=e.getContext("2d");e=p.getImageData(0,0,e.width,e.height);var q=e.data,n=!1;this.image?(n=!0,k=f.util.createCanvasElement(),k.width=this.image.width,k.height=this.image.height,k=new f.StaticCanvas(k),k.add(this.image),
k=k.getContext("2d").getImageData(0,0,k.width,k.height).data):(k=(new f.Color(this.color)).getSource(),b=k[0]*this.alpha,g=k[1]*this.alpha,d=k[2]*this.alpha);for(var t=0,r=q.length;t<r;t+=4)switch(a=q[t],c=q[t+1],h=q[t+2],n&&(b=k[t]*this.alpha,g=k[t+1]*this.alpha,d=k[t+2]*this.alpha),this.mode){case "multiply":q[t]=a*b/255;q[t+1]=c*g/255;q[t+2]=h*d/255;break;case "screen":q[t]=1-(1-a)*(1-b);q[t+1]=1-(1-c)*(1-g);q[t+2]=1-(1-h)*(1-d);break;case "add":q[t]=Math.min(255,a+b);q[t+1]=Math.min(255,c+g);
q[t+2]=Math.min(255,h+d);break;case "diff":case "difference":q[t]=Math.abs(a-b);q[t+1]=Math.abs(c-g);q[t+2]=Math.abs(h-d);break;case "subtract":a-=b;c-=g;h-=d;q[t]=0>a?0:a;q[t+1]=0>c?0:c;q[t+2]=0>h?0:h;break;case "darken":q[t]=Math.min(a,b);q[t+1]=Math.min(c,g);q[t+2]=Math.min(h,d);break;case "lighten":q[t]=Math.max(a,b),q[t+1]=Math.max(c,g),q[t+2]=Math.max(h,d)}p.putImageData(e,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}});f.Image.filters.Blend.fromObject=
function(e){return new f.Image.filters.Blend(e)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=Math.pow,b=Math.floor,g=Math.sqrt,d=Math.abs,a=Math.max,c=Math.round,m=Math.sin,k=Math.ceil;f.Image.filters.Resize=f.util.createClass(f.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(a,b,d){this.rcpScaleX=1/b;this.rcpScaleY=1/d;var e,f=a.width,g=a.height;b=c(f*b);d=c(g*d);"sliceHack"===this.resizeType&&(e=this.sliceByTwo(a,f,g,b,d));"hermite"===this.resizeType&&(e=this.hermiteFastResize(a,
f,g,b,d));"bilinear"===this.resizeType&&(e=this.bilinearFiltering(a,f,g,b,d));"lanczos"===this.resizeType&&(e=this.lanczosResize(a,f,g,b,d));a.width=b;a.height=d;a.getContext("2d").putImageData(e,0,0)},sliceByTwo:function(c,d,e,g,h){var m,k=c.getContext("2d"),r=.5,n=.5,p=1,q=1,t=!1,B=!1,C=d,E=e,I=f.util.createCanvasElement(),J=I.getContext("2d");g=b(g);h=b(h);I.width=a(g,d);I.height=a(h,e);g>d&&(r=2,p=-1);h>e&&(n=2,q=-1);m=k.getImageData(0,0,d,e);c.width=a(g,d);c.height=a(h,e);for(k.putImageData(m,
0,0);!t||!B;)d=C,e=E,g*p<b(C*r*p)?C=b(C*r):(C=g,t=!0),h*q<b(E*n*q)?E=b(E*n):(E=h,B=!0),m=k.getImageData(0,0,d,e),J.putImageData(m,0,0),k.clearRect(0,0,C,E),k.drawImage(I,0,0,d,e,0,0,C,E);return k.getImageData(0,0,g,h)},lanczosResize:function(a,c,f,h,r){var n,p,q,t;function x(a){var m,k,u,z,A,v,y,M,Y,U,K;q=(a+.5)*I;n=b(q);for(m=0;m<r;m++){t=(m+.5)*J;p=b(t);Y=M=y=v=A=0;for(k=n-O;k<=n+O;k++)if(!(0>k||k>=c)){U=b(1E3*d(k-q));L[U]||(L[U]={});for(var da=p-G;da<=p+G;da++)0>da||da>=f||(K=b(1E3*d(da-t)),L[U][K]||
(L[U][K]=E(g(e(U*D,2)+e(K*N,2))/1E3)),u=L[U][K],0<u&&(z=4*(da*c+k),A+=u,v+=u*B[z],y+=u*B[z+1],M+=u*B[z+2],Y+=u*B[z+3]))}z=4*(m*h+a);C[z]=v/A;C[z+1]=y/A;C[z+2]=M/A;C[z+3]=Y/A}return++a<h?x(a):w}a=a.getContext("2d");var z=a.getImageData(0,0,c,f),w=a.getImageData(0,0,h,r),B=z.data,C=w.data,E=function(a){return function(b){if(b>a)return 0;if(b*=Math.PI,1E-16>d(b))return 1;var c=b/a;return m(b)*m(c)/b/c}}(this.lanczosLobes),I=this.rcpScaleX,J=this.rcpScaleY,D=2/this.rcpScaleX,N=2/this.rcpScaleY,O=k(I*
this.lanczosLobes/2),G=k(J*this.lanczosLobes/2),L={};p=n=t=q=void 0;return x(0)},bilinearFiltering:function(a,c,d,e,f){var g,h,m,k,r,n,p,q,t,E,I=0,J=this.rcpScaleX,D=this.rcpScaleY;p=a.getContext("2d");a=4*(c-1);d=p.getImageData(0,0,c,d).data;var N=p.getImageData(0,0,e,f),O=N.data;for(p=0;p<f;p++)for(q=0;q<e;q++)for(r=b(J*q),n=b(D*p),t=J*q-r,E=D*p-n,n=4*(n*c+r),r=0;4>r;r++)g=d[n+r],h=d[n+4+r],m=d[n+a+r],k=d[n+a+4+r],g=g*(1-t)*(1-E)+h*t*(1-E)+m*E*(1-t)+k*t*E,O[I++]=g;return N},hermiteFastResize:function(a,
c,e,f,h){var m=this.rcpScaleX,r=this.rcpScaleY,n=k(m/2),p=k(r/2);a=a.getContext("2d");e=a.getImageData(0,0,c,e).data;a=a.getImageData(0,0,f,h);for(var q=a.data,t=0;t<h;t++)for(var w=0;w<f;w++){for(var B=4*(w+t*f),C=0,E=0,I=0,J=0,D=0,N=0,O=0,G=(t+.5)*r,L=b(t*r);L<(t+1)*r;L++)for(var M=d(G-(L+.5))/p,P=(w+.5)*m,M=M*M,R=b(w*m);R<(w+1)*m;R++){var S=d(P-(R+.5))/n,H=g(M+S*S);1<H&&-1>H||(C=2*H*H*H-3*H*H+1,0<C&&(S=4*(R+L*c),O+=C*e[S+3],I+=C,255>e[S+3]&&(C=C*e[S+3]/250),J+=C*e[S],D+=C*e[S+1],N+=C*e[S+2],E+=
C))}q[B]=J/E;q[B+1]=D/E;q[B+2]=N/E;q[B+3]=O/I}return a},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}});f.Image.filters.Resize.fromObject=function(a){return new f.Image.filters.Resize(a)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.ColorMatrix=f.util.createClass(f.Image.filters.BaseFilter,{type:"ColorMatrix",initialize:function(b){b||(b={});this.matrix=b.matrix||[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]},applyTo:function(b){var e,d,a,c,f=b.getContext("2d"),h=f.getImageData(0,0,b.width,b.height),p=h.data,q=p.length,n=this.matrix;for(b=0;b<q;b+=4)e=p[b],d=p[b+1],a=p[b+2],c=p[b+3],p[b]=e*n[0]+d*n[1]+a*n[2]+c*n[3]+n[4],p[b+1]=e*n[5]+d*n[6]+a*n[7]+
c*n[8]+n[9],p[b+2]=e*n[10]+d*n[11]+a*n[12]+c*n[13]+n[14],p[b+3]=e*n[15]+d*n[16]+a*n[17]+c*n[18]+n[19];f.putImageData(h,0,0)},toObject:function(){return e(this.callSuper("toObject"),{type:this.type,matrix:this.matrix})}});f.Image.filters.ColorMatrix.fromObject=function(b){return new f.Image.filters.ColorMatrix(b)}})("undefined"!=typeof exports?exports:this);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend,b=f.util.object.clone,g=f.util.toFixed,d=f.StaticCanvas.supports("setLineDash"),a=f.Object.NUM_FRACTION_DIGITS;if(f.Text)return void f.warn("fabric.Text is already defined");h=f.Object.prototype.stateProperties.concat();h.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor");f.Text=f.util.createClass(f.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,
fontFamily:!0,fontStyle:!0,lineHeight:!0,text:!0,charSpacing:!0,textAlign:!0,stroke:!1,strokeWidth:!1},_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:h,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,charSpacing:0,initialize:function(a,b){b=b||{};this.text=a;this.__skipDimension=!0;this.setOptions(b);this.__skipDimension=
!1;this._initDimensions()},_initDimensions:function(a){this.__skipDimension||(a||(a=f.util.createCanvasElement().getContext("2d"),this._setTextStyles(a)),this._textLines=this._splitTextIntoLines(),this._clearCache(),this.width=this._getTextWidth(a),this.height=this._getTextHeight(a))},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){this.clipTo&&f.util.clipContext(this,a);this._setOpacity(a);this._setShadow(a);
this._setupCompositeOperation(a);this._renderTextBackground(a);this._setStrokeStyles(a);this._setFillStyles(a);this._renderText(a);this._renderTextDecoration(a);this.clipTo&&a.restore()},_renderText:function(a){this._renderTextFill(a);this._renderTextStroke(a)},_setTextStyles:function(a){a.textBaseline="alphabetic";a.font=this._getFontDeclaration()},_getTextHeight:function(){return this._getHeightOfSingleLine()+(this._textLines.length-1)*this._getHeightOfLine()},_getTextWidth:function(a){for(var b=
this._getLineWidth(a,0),c=1,d=this._textLines.length;c<d;c++){var e=this._getLineWidth(a,c);e>b&&(b=e)}return b},_getNonTransformedDimensions:function(){return{x:this.width,y:this.height}},_renderChars:function(a,b,d,e,f){var c,g,h=a.slice(0,-4);this[h].toLive&&(c=-this.width/2+this[h].offsetX||0,g=-this.height/2+this[h].offsetY||0,b.save(),b.translate(c,g),e-=c,f-=g);if(0!==this.charSpacing){var m=this._getWidthOfCharSpacing();d=d.split("");for(var k=0,p=d.length;k<p;k++)c=d[k],g=b.measureText(c).width+
m,b[a](c,e,f),e+=g}else b[a](d,e,f);this[h].toLive&&b.restore()},_renderTextLine:function(a,b,d,e,f,g){f-=this.fontSize*this._fontSizeFraction;var c=this._getLineWidth(b,g);if("justify"!==this.textAlign||this.width<c)return void this._renderChars(a,b,d,e,f,g);var h,c=d.split(/\s+/),m=0;h=this._getWidthOfWords(b,c.join(""),g,0);h=this.width-h;for(var k=c.length-1,k=0<k?h/k:0,n=0,p=0,q=c.length;p<q;p++){for(;" "===d[m]&&m<d.length;)m++;h=c[p];this._renderChars(a,b,h,e+n,f,g,m);n+=this._getWidthOfWords(b,
h,g,m)+k;m+=h.length}},_getWidthOfWords:function(a,b){var c,d,e=a.measureText(b).width;return 0!==this.charSpacing&&(c=b.split("").length,d=c*this._getWidthOfCharSpacing(),e+=d),e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},isEmptyStyles:function(){return!0},_renderTextCommon:function(a,b){for(var c=0,d=this._getLeftOffset(),e=this._getTopOffset(),f=0,g=this._textLines.length;f<g;f++){var h=this._getHeightOfLine(a,f),m=h/this.lineHeight,A=this._getLineWidth(a,
f),A=this._getLineLeftOffset(A);this._renderTextLine(b,a,this._textLines[f],d+A,e+c+m,f);c+=h}},_renderTextFill:function(a){!this.fill&&this.isEmptyStyles()||this._renderTextCommon(a,"fillText")},_renderTextStroke:function(a){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),a.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),d&&a.setLineDash(this.strokeDashArray)),
a.beginPath(),this._renderTextCommon(a,"strokeText"),a.closePath(),a.restore())},_getHeightOfLine:function(){return this._getHeightOfSingleLine()*this.lineHeight},_getHeightOfSingleLine:function(){return this.fontSize*this._fontSizeMult},_renderTextBackground:function(a){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),
this._removeShadow(a))},_renderTextLinesBackground:function(a){if(this.textBackgroundColor){var b,c,d,e=0;a.fillStyle=this.textBackgroundColor;for(var f=0,g=this._textLines.length;f<g;f++)b=this._getHeightOfLine(a,f),c=this._getLineWidth(a,f),0<c&&(d=this._getLineLeftOffset(c),a.fillRect(this._getLeftOffset()+d,this._getTopOffset()+e,c,b/this.lineHeight)),e+=b;this._removeShadow(a)}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-a)/2:"right"===this.textAlign?this.width-
a:0},_clearCache:function(){this.__lineWidths=[];this.__lineHeights=[]},_shouldClearCache:function(){var a=!1;if(this._forceClearCache)return this._forceClearCache=!1,!0;for(var b in this._dimensionAffectingProps)this["__"+b]!==this[b]&&(this["__"+b]=this[b],a=!0);return a},_getLineWidth:function(a,b){if(this.__lineWidths[b])return-1===this.__lineWidths[b]?this.width:this.__lineWidths[b];var c,d,e=this._textLines[b];return c=""===e?0:this._measureLine(a,b),this.__lineWidths[b]=c,c&&"justify"===this.textAlign&&
(d=e.split(/\s+/),1<d.length&&(this.__lineWidths[b]=-1)),c},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1E3:0},_measureLine:function(a,b){var c,d=this._textLines[b],e=a.measureText(d).width,f=0;return 0!==this.charSpacing&&(c=d.split("").length,f=(c-1)*this._getWidthOfCharSpacing()),e+f},_renderTextDecoration:function(a){if(this.textDecoration){var b=this.height/2,c=[];-1<this.textDecoration.indexOf("underline")&&c.push(.85);-1<this.textDecoration.indexOf("line-through")&&
c.push(.43);-1<this.textDecoration.indexOf("overline")&&c.push(-.12);if(0<c.length){var d,e,f,g,h,u,A,y=0;d=0;for(e=this._textLines.length;d<e;d++){h=this._getLineWidth(a,d);u=this._getLineLeftOffset(h);A=this._getHeightOfLine(a,d);f=0;for(g=c.length;f<g;f++)a.fillRect(this._getLeftOffset()+u,y+(this._fontSizeMult-1+c[f])*this.fontSize-b,h,this.fontSize/15);y+=A}}}},_getFontDeclaration:function(){return[f.isLikelyNode?this.fontWeight:this.fontStyle,f.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+
"px",f.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,b){this.visible&&(a.save(),this._setTextStyles(a),this._shouldClearCache()&&this._initDimensions(a),this.drawSelectionBackground(a),b||this.transform(a),this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this.group&&"path-group"===this.group.type&&a.translate(this.left,this.top),this._render(a),a.restore())},_splitTextIntoLines:function(){return this.text.split(this._reNewline)},toObject:function(a){a=
e(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor,charSpacing:this.charSpacing});return this.includeDefaultValues||this._removeDefaultValues(a),a},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this._getSVGLeftTopOffsets(this.ctx),c=this._getSVGTextAndBg(c.textTop,
c.textLeft);return this._wrapSVGTextAndBg(b,c),a?a(b.join("")):b.join("")},_getSVGLeftTopOffsets:function(a){a=this._getHeightOfLine(a,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:a}},_wrapSVGTextAndBg:function(a,b){var c=this.getSvgFilter(),c=""===c?"":' style="'+c+'"';a.push("\t<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',c,">\n",b.textBgRects.join(""),
"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(!0),'" >\n',b.textSpans.join(""),"\t\t</text>\n","\t</g>\n")},_getSVGTextAndBg:function(a,b){var c=[],d=[],e=0;this._setSVGBg(d);for(var f=0,g=this._textLines.length;f<
g;f++)this.textBackgroundColor&&this._setSVGTextLineBg(d,f,b,a,e),this._setSVGTextLineText(f,c,e,b,a,d),e+=this._getHeightOfLine(this.ctx,f);return{textSpans:c,textBgRects:d}},_setSVGTextLineText:function(b,d,e,h,q){e=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-q+e-this.height/2;return"justify"===this.textAlign?void this._setSVGTextLineJustifed(b,d,e,h):void d.push('\t\t\t<tspan x="',g(h+this._getLineLeftOffset(this._getLineWidth(this.ctx,b)),a),'" ','y="',g(e,a),'" ',this._getFillAttributes(this.fill),
">",f.util.string.escapeXml(this._textLines[b]),"</tspan>\n")},_setSVGTextLineJustifed:function(b,d,e,h){var c=f.util.createCanvasElement().getContext("2d");this._setTextStyles(c);var m,k,r=this._textLines[b].split(/\s+/);m=this._getWidthOfWords(c,r.join(""));m=this.width-m;k=r.length-1;var p=0<k?m/k:0,A=this._getFillAttributes(this.fill);h+=this._getLineLeftOffset(this._getLineWidth(c,b));b=0;for(k=r.length;b<k;b++)m=r[b],d.push('\t\t\t<tspan x="',g(h,a),'" ','y="',g(e,a),'" ',A,">",f.util.string.escapeXml(m),
"</tspan>\n"),h+=this._getWidthOfWords(c,m)+p},_setSVGTextLineBg:function(b,d,e,f,h){b.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',g(e+this._getLineLeftOffset(this._getLineWidth(this.ctx,d)),a),'" y="',g(h-this.height/2,a),'" width="',g(this._getLineWidth(this.ctx,d),a),'" height="',g(this._getHeightOfLine(this.ctx,d)/this.lineHeight,a),'"></rect>\n')},_setSVGBg:function(b){this.backgroundColor&&b.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',
g(-this.width/2,a),'" y="',g(-this.height/2,a),'" width="',g(this.width,a),'" height="',g(this.height,a),'"></rect>\n')},_getFillAttributes:function(a){var b=a&&"string"==typeof a?new f.Color(a):"";return b&&b.getSource()&&1!==b.getAlpha()?'opacity="'+b.getAlpha()+'" fill="'+b.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,b){this.callSuper("_set",a,b);a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}});f.Text.ATTRIBUTE_NAMES=f.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" "));
f.Text.DEFAULT_SVG_FONT_SIZE=16;f.Text.fromElement=function(a,b){if(!a)return null;var c=f.parseAttributes(a,f.Text.ATTRIBUTE_NAMES);b=f.util.object.extend(b?f.util.object.clone(b):{},c);b.top=b.top||0;b.left=b.left||0;"dx"in c&&(b.left+=c.dx);"dy"in c&&(b.top+=c.dy);"fontSize"in b||(b.fontSize=f.Text.DEFAULT_SVG_FONT_SIZE);b.originX||(b.originX="left");c="";"textContent"in a?c=a.textContent:"firstChild"in a&&null!==a.firstChild&&"data"in a.firstChild&&null!==a.firstChild.data&&(c=a.firstChild.data);
var c=c.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),c=new f.Text(c,b),d=c.getHeight()/c.height,d=((c.height+c.strokeWidth)*c.lineHeight-c.height)*d,d=c.getHeight()+d,e=0;return"left"===c.originX&&(e=c.getWidth()/2),"right"===c.originX&&(e=-c.getWidth()/2),c.set({left:c.getLeft()+e,top:c.getTop()-d/2+c.fontSize*(.18+c._fontSizeFraction)/c.lineHeight}),c};f.Text.fromObject=function(a){return new f.Text(a.text,b(a))};f.util.createAccessors(f.Text)})("undefined"!=typeof exports?exports:this);
(function(){var h=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1E3,cursorDuration:600,styles:null,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],initialize:function(f,e){this.styles=
e?e.styles||{}:{};this.callSuper("initialize",f,e);this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache");this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var f=this.styles,e;for(e in f)for(var b in f[e])for(var g in f[e][b])return!1;return!0},setSelectionStart:function(f){f=Math.max(f,0);this._updateAndFire("selectionStart",f)},setSelectionEnd:function(f){f=Math.min(f,this.text.length);this._updateAndFire("selectionEnd",f)},_updateAndFire:function(f,e){this[f]!==
e&&(this._fireSelectionChanged(),this[f]=e);this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed");this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectionStyles:function(f,e){if(2===arguments.length){for(var b=[],g=f;g<e;g++)b.push(this.getSelectionStyles(g));return b}b=this.get2DCursorLocation(f);return this._getStyleDeclaration(b.lineIndex,b.charIndex)||{}},setSelectionStyles:function(f){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,
f);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,f);return this._forceClearCache=!0,this},_extendStyles:function(f,e){var b=this.get2DCursorLocation(f);this._getLineStyle(b.lineIndex)||this._setLineStyle(b.lineIndex,{});this._getStyleDeclaration(b.lineIndex,b.charIndex)||this._setStyleDeclaration(b.lineIndex,b.charIndex,{});fabric.util.object.extend(this._getStyleDeclaration(b.lineIndex,b.charIndex),e)},_render:function(f){this.oldWidth=this.width;this.oldHeight=
this.height;this.callSuper("_render",f);this.ctx=f;this.cursorOffsetCache={};this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active&&this.isEditing){var f,e,b=this.text.split("");this.canvas.contextTop?(e=this.canvas.contextTop,e.save(),e.transform.apply(e,this.canvas.viewportTransform),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e)):(e=this.ctx,e.save());this.selectionStart===this.selectionEnd?(f=this._getCursorBoundaries(b,
"cursor"),this.renderCursor(f,e)):(f=this._getCursorBoundaries(b,"selection"),this.renderSelection(b,f,e));e.restore()}},_clearTextArea:function(f){var e=this.oldWidth+4,b=this.oldHeight+4;f.clearRect(-e/2,-b/2,e,b)},get2DCursorLocation:function(f){"undefined"==typeof f&&(f=this.selectionStart);for(var e=this._textLines.length,b=0;b<e;b++){if(f<=this._textLines[b].length)return{lineIndex:b,charIndex:f};f-=this._textLines[b].length+1}return{lineIndex:b-1,charIndex:this._textLines[b-1].length<f?this._textLines[b-
1].length:f}},getCurrentCharStyle:function(f,e){var b=this._getStyleDeclaration(f,0===e?0:e-1);return{fontSize:b&&b.fontSize||this.fontSize,fill:b&&b.fill||this.fill,textBackgroundColor:b&&b.textBackgroundColor||this.textBackgroundColor,textDecoration:b&&b.textDecoration||this.textDecoration,fontFamily:b&&b.fontFamily||this.fontFamily,fontWeight:b&&b.fontWeight||this.fontWeight,fontStyle:b&&b.fontStyle||this.fontStyle,stroke:b&&b.stroke||this.stroke,strokeWidth:b&&b.strokeWidth||this.strokeWidth}},
getCurrentCharFontSize:function(f,e){var b=this._getStyleDeclaration(f,0===e?0:e-1);return b&&b.fontSize?b.fontSize:this.fontSize},getCurrentCharColor:function(f,e){var b=this._getStyleDeclaration(f,0===e?0:e-1);return b&&b.fill?b.fill:this.cursorColor},_getCursorBoundaries:function(f,e){var b=Math.round(this._getLeftOffset()),g=this._getTopOffset(),d=this._getCursorBoundariesOffsets(f,e);return{left:b,top:g,leftOffset:d.left+d.lineLeft,topOffset:d.top}},_getCursorBoundariesOffsets:function(f,e){if(this.cursorOffsetCache&&
"top"in this.cursorOffsetCache)return this.cursorOffsetCache;for(var b,g=0,d=0,a=0,c=0,h=0,k=0;k<this.selectionStart;k++)"\n"===f[k]?(h=0,c+=this._getHeightOfLine(this.ctx,d),d++,a=0):(h+=this._getWidthOfChar(this.ctx,f[k],d,a),a++),g=this._getLineLeftOffset(this._getLineWidth(this.ctx,d));return"cursor"===e&&(c+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,d)/this.lineHeight-this.getCurrentCharFontSize(d,a)*(1-this._fontSizeFraction)),0!==this.charSpacing&&a===this._textLines[d].length&&
(h-=this._getWidthOfCharSpacing()),b={top:c,left:h,lineLeft:g},this.cursorOffsetCache=b,this.cursorOffsetCache},renderCursor:function(f,e){var b=this.get2DCursorLocation(),g=b.lineIndex,b=b.charIndex,d=this.getCurrentCharFontSize(g,b),a=0===g&&0===b?this._getLineLeftOffset(this._getLineWidth(e,g)):f.leftOffset,c=this.scaleX*this.canvas.getZoom(),c=this.cursorWidth/c;e.fillStyle=this.getCurrentCharColor(g,b);e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity;e.fillRect(f.left+a-c/2,f.top+
f.topOffset,c,d)},renderSelection:function(f,e,b){b.fillStyle=this.selectionColor;f=this.get2DCursorLocation(this.selectionStart);for(var g=this.get2DCursorLocation(this.selectionEnd),d=f.lineIndex,a=g.lineIndex,c=d;c<=a;c++){var h=this._getLineLeftOffset(this._getLineWidth(b,c))||0,k=this._getHeightOfLine(this.ctx,c),p,q=0;p=this._textLines[c];if(c===d){for(var n=0,t=p.length;n<t;n++)n>=f.charIndex&&(c!==a||n<g.charIndex)&&(q+=this._getWidthOfChar(b,p[n],c,n)),n<f.charIndex&&(h+=this._getWidthOfChar(b,
p[n],c,n));n===p.length&&(q-=this._getWidthOfCharSpacing())}else if(c>d&&c<a)q+=this._getLineWidth(b,c)||5;else if(c===a){n=0;for(t=g.charIndex;n<t;n++)q+=this._getWidthOfChar(b,p[n],c,n);g.charIndex===p.length&&(q-=this._getWidthOfCharSpacing())}p=k;(1>this.lineHeight||c===a&&1<this.lineHeight)&&(k/=this.lineHeight);b.fillRect(e.left+h,e.top+e.topOffset,q,k);e.topOffset+=p}},_renderChars:function(f,e,b,g,d,a,c){if(this.isEmptyStyles())return this._renderCharsFast(f,e,b,g,d);c=c||0;var h,k,p=this._getHeightOfLine(e,
a),q="";e.save();d-=p/this.lineHeight*this._fontSizeFraction;for(var n=c,t=b.length+c;n<=t;n++)h=h||this.getCurrentCharStyle(a,n),k=this.getCurrentCharStyle(a,n+1),(this._hasStyleChanged(h,k)||n===t)&&(this._renderChar(f,e,a,n-1,q,g,d,p),q="",h=k),q+=b[n-c];e.restore()},_renderCharsFast:function(f,e,b,g,d){"fillText"===f&&this.fill&&this.callSuper("_renderChars",f,e,b,g,d);"strokeText"===f&&(this.stroke&&0<this.strokeWidth||this.skipFillStrokeCheck)&&this.callSuper("_renderChars",f,e,b,g,d)},_renderChar:function(f,
e,b,g,d,a,c,h){var m,p,q,n,t,r=this._getStyleDeclaration(b,g);if(r?(m=this._getHeightOfChar(e,d,b,g),q=r.stroke,p=r.fill,t=r.textDecoration):m=this.fontSize,q=(q||this.stroke)&&"strokeText"===f,p=(p||this.fill)&&"fillText"===f,r&&e.save(),f=this._applyCharStylesGetWidth(e,d,b,g,r||null),t=t||this.textDecoration,r&&r.textBackgroundColor&&this._removeShadow(e),0!==this.charSpacing){d=d.split("");g=f=0;for(var u=d.length;g<u;g++)b=d[g],p&&e.fillText(b,a+f,c),q&&e.strokeText(b,a+f,c),f+=e.measureText(b).width+
this._getWidthOfCharSpacing()}else p&&e.fillText(d,a,c),q&&e.strokeText(d,a,c);(t||""!==t)&&(n=this._fontSizeFraction*h/this.lineHeight,this._renderCharDecoration(e,t,a,c,n,f,m));r&&e.restore();e.translate(f,0)},_hasStyleChanged:function(f,e){return f.fill!==e.fill||f.fontSize!==e.fontSize||f.textBackgroundColor!==e.textBackgroundColor||f.textDecoration!==e.textDecoration||f.fontFamily!==e.fontFamily||f.fontWeight!==e.fontWeight||f.fontStyle!==e.fontStyle||f.stroke!==e.stroke||f.strokeWidth!==e.strokeWidth},
_renderCharDecoration:function(f,e,b,g,d,a,c){if(e){d=c/15;var h={underline:g+c/10,"line-through":g-c*(this._fontSizeFraction+this._fontSizeMult-1)+d,overline:g-(this._fontSizeMult-this._fontSizeFraction)*c},k=["underline","line-through","overline"];for(g=0;g<k.length;g++)c=k[g],-1<e.indexOf(c)&&f.fillRect(b,h[c],a,d)}},_renderTextLine:function(f,e,b,g,d,a){this.isEmptyStyles()||(d+=this.fontSize*(this._fontSizeFraction+.03));this.callSuper("_renderTextLine",f,e,b,g,d,a)},_renderTextDecoration:function(f){if(this.isEmptyStyles())return this.callSuper("_renderTextDecoration",
f)},_renderTextLinesBackground:function(f){this.callSuper("_renderTextLinesBackground",f);for(var e,b,g,d,a,c=0,h=this._getLeftOffset(),k=this._getTopOffset(),p=0,q=this._textLines.length;p<q;p++){if(e=this._getHeightOfLine(f,p),g=this._textLines[p],""!==g&&this.styles&&this._getLineStyle(p)){b=this._getLineWidth(f,p);b=this._getLineLeftOffset(b);for(var n=0,t=g.length;n<t;n++)(a=this._getStyleDeclaration(p,n))&&a.textBackgroundColor&&(d=g[n],f.fillStyle=a.textBackgroundColor,f.fillRect(h+b+this._getWidthOfCharsAt(f,
p,n),k+c,this._getWidthOfChar(f,d,p,n)+1,e/this.lineHeight))}c+=e}},_getCacheProp:function(f,e){return f+e.fontSize+e.fontWeight+e.fontStyle},_getFontCache:function(f){return fabric.charWidthsCache[f]||(fabric.charWidthsCache[f]={}),fabric.charWidthsCache[f]},_applyCharStylesGetWidth:function(f,e,b,g,d){var a,c,m;g=d||this._getStyleDeclaration(b,g);b=h(g);if(this._applyFontStyles(b),m=this._getFontCache(b.fontFamily),c=this._getCacheProp(e,b),!g&&m[c]&&this.caching)return m[c];"string"==typeof b.shadow&&
(b.shadow=new fabric.Shadow(b.shadow));g=b.fill||this.fill;return f.fillStyle=g.toLive?g.toLive(f,this):g,b.stroke&&(f.strokeStyle=b.stroke&&b.stroke.toLive?b.stroke.toLive(f,this):b.stroke),f.lineWidth=b.strokeWidth||this.strokeWidth,f.font=this._getFontDeclaration.call(b),b.shadow&&(b.scaleX=this.scaleX,b.scaleY=this.scaleY,b.canvas=this.canvas,this._setShadow.call(b,f)),this.caching&&m[c]?m[c]:(a=f.measureText(e).width,this.caching&&(m[c]=a),a)},_applyFontStyles:function(f){f.fontFamily||(f.fontFamily=
this.fontFamily);f.fontSize||(f.fontSize=this.fontSize);f.fontWeight||(f.fontWeight=this.fontWeight);f.fontStyle||(f.fontStyle=this.fontStyle)},_getStyleDeclaration:function(f,e,b){return b?this.styles[f]&&this.styles[f][e]?h(this.styles[f][e]):{}:this.styles[f]&&this.styles[f][e]?this.styles[f][e]:null},_setStyleDeclaration:function(f,e,b){this.styles[f][e]=b},_deleteStyleDeclaration:function(f,e){delete this.styles[f][e]},_getLineStyle:function(f){return this.styles[f]},_setLineStyle:function(f,
e){this.styles[f]=e},_deleteLineStyle:function(f){delete this.styles[f]},_getWidthOfChar:function(f,e,b,g){if(!this._isMeasuring&&"justify"===this.textAlign&&this._reSpacesAndTabs.test(e))return this._getWidthOfSpace(f,b);f.save();e=this._applyCharStylesGetWidth(f,e,b,g);return 0!==this.charSpacing&&(e+=this._getWidthOfCharSpacing()),f.restore(),e},_getHeightOfChar:function(f,e,b){return(f=this._getStyleDeclaration(e,b))&&f.fontSize?f.fontSize:this.fontSize},_getWidthOfCharsAt:function(f,e,b){var g,
d,a=0;for(g=0;g<b;g++)d=this._textLines[e][g],a+=this._getWidthOfChar(f,d,e,g);return a},_measureLine:function(f,e){this._isMeasuring=!0;var b=this._getWidthOfCharsAt(f,e,this._textLines[e].length);return 0!==this.charSpacing&&(b-=this._getWidthOfCharSpacing()),this._isMeasuring=!1,b},_getWidthOfSpace:function(f,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var b=this._textLines[e],g=this._getWidthOfWords(f,b,e,0),g=this.width-g,b=b.length-b.replace(this._reSpacesAndTabs,"").length,b=
Math.max(g/b,f.measureText(" ").width);return this.__widthOfSpace[e]=b,b},_getWidthOfWords:function(f,e,b,g){for(var d=0,a=0;a<e.length;a++){var c=e[a];c.match(/\s/)||(d+=this._getWidthOfChar(f,c,b,a+g))}return d},_getHeightOfLine:function(f,e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var b=this._textLines[e],g=this._getHeightOfChar(f,e,0),d=1,b=b.length;d<b;d++){var a=this._getHeightOfChar(f,e,d);a>g&&(g=a)}return this.__lineHeights[e]=g*this.lineHeight*this._fontSizeMult,this.__lineHeights[e]},
_getTextHeight:function(f){for(var e,b=0,g=0,d=this._textLines.length;g<d;g++)e=this._getHeightOfLine(f,g),b+=g===d-1?e/this.lineHeight:e;return b},toObject:function(f){var e,b,g,d={};for(e in this.styles)for(b in g=this.styles[e],d[e]={},g)d[e][b]=h(g[b]);return fabric.util.object.extend(this.callSuper("toObject",f),{styles:d})}});fabric.IText.fromObject=function(f){return new fabric.IText(f.text,h(f))}})();
(function(){var h=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler();this.initRemovedHandler();this.initCursorSelectionHandlers();this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var f=this;setTimeout(function(){f.selected=!0},100)})},initAddedHandler:function(){var f=this;this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers());
f.canvas&&(f.canvas._iTextInstances=f.canvas._iTextInstances||[],f.canvas._iTextInstances.push(f))})},initRemovedHandler:function(){var f=this;this.on("removed",function(){f.canvas&&(f.canvas._iTextInstances=f.canvas._iTextInstances||[],fabric.util.removeFromArray(f.canvas._iTextInstances,f))})},_initCanvasHandlers:function(){var f=this;this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers(f.canvas)});this.canvas.on("mouse:up",function(){f.canvas._iTextInstances&&
f.canvas._iTextInstances.forEach(function(e){e.__isMousedown=!1})});this.canvas.on("object:selected",function(){fabric.IText.prototype.exitEditingOnOthers(f.canvas)})},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(f,e,b,g){var d;return d={isAborted:!1,abort:function(){this.isAborted=!0}},f.animate("_currentCursorOpacity",e,{duration:b,onComplete:function(){d.isAborted||f[g]()},onChange:function(){f.canvas&&f.selectionStart===
f.selectionEnd&&f.renderCursorOrSelection()},abort:function(){return d.isAborted}}),d},_onTickComplete:function(){var f=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1);this._cursorTimeout1=setTimeout(function(){f._currentTickCompleteState=f._animateCursor(f,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(f){var e=this;f=f?0:this.cursorDelay;this.abortCursorAnimation();this._currentCursorOpacity=1;this._cursorTimeout2=setTimeout(function(){e._tick()},f)},abortCursorAnimation:function(){var f=
this._currentTickState||this._currentTickCompleteState;this._currentTickState&&this._currentTickState.abort();this._currentTickCompleteState&&this._currentTickCompleteState.abort();clearTimeout(this._cursorTimeout1);clearTimeout(this._cursorTimeout2);this._currentCursorOpacity=0;f&&this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.selectionStart=0;this.selectionEnd=this.text.length;this._fireSelectionChanged();this._updateTextarea()},getSelectedText:function(){return this.text.slice(this.selectionStart,
this.selectionEnd)},findWordBoundaryLeft:function(f){var e=0,b=f-1;if(this._reSpace.test(this.text.charAt(b)))for(;this._reSpace.test(this.text.charAt(b));)e++,b--;for(;/\S/.test(this.text.charAt(b))&&-1<b;)e++,b--;return f-e},findWordBoundaryRight:function(f){var e=0,b=f;if(this._reSpace.test(this.text.charAt(b)))for(;this._reSpace.test(this.text.charAt(b));)e++,b++;for(;/\S/.test(this.text.charAt(b))&&b<this.text.length;)e++,b++;return f+e},findLineBoundaryLeft:function(f){for(var e=0,b=f-1;!/\n/.test(this.text.charAt(b))&&
-1<b;)e++,b--;return f-e},findLineBoundaryRight:function(f){for(var e=0,b=f;!/\n/.test(this.text.charAt(b))&&b<this.text.length;)e++,b++;return f+e},getNumNewLinesInSelectedText:function(){for(var f=this.getSelectedText(),e=0,b=0,g=f.length;b<g;b++)"\n"===f[b]&&e++;return e},searchWordBoundary:function(f,e){for(var b=this._reSpace.test(this.text.charAt(f))?f-1:f,g=this.text.charAt(b),d=/[ \n\.,;!\?\-]/;!d.test(g)&&0<b&&b<this.text.length;)b+=e,g=this.text.charAt(b);return d.test(g)&&"\n"!==g&&(b+=
1===e?0:1),b},selectWord:function(f){f=f||this.selectionStart;var e=this.searchWordBoundary(f,-1);f=this.searchWordBoundary(f,1);this.selectionStart=e;this.selectionEnd=f;this._fireSelectionChanged();this._updateTextarea();this.renderCursorOrSelection()},selectLine:function(f){f=f||this.selectionStart;var e=this.findLineBoundaryLeft(f);f=this.findLineBoundaryRight(f);this.selectionStart=e;this.selectionEnd=f;this._fireSelectionChanged();this._updateTextarea()},enterEditing:function(f){if(!this.isEditing&&
this.editable)return this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(f),this.hiddenTextarea.focus(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.canvas.renderAll(),this.initMouseMoveHandler(),this):this},exitEditingOnOthers:function(f){f._iTextInstances&&f._iTextInstances.forEach(function(e){e.selected=
!1;e.isEditing&&e.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler.bind(this))},mouseMoveHandler:function(f){if(this.__isMousedown&&this.isEditing){f=this.getSelectionStartFromPointer(f.e);var e=this.selectionStart,b=this.selectionEnd;f!==this.__selectionStartOnMouseDown&&(f>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=f):(this.selectionStart=f,this.selectionEnd=this.__selectionStartOnMouseDown),
this.selectionStart===e&&this.selectionEnd===b||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text";this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text");this.borderColor=this.editingBorderColor;this.hasControls=this.selectable=!1;this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){if(this.hiddenTextarea&&!this.inCompositionMode&&(this.cursorOffsetCache={},this.hiddenTextarea.value=
this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd,this.selectionStart===this.selectionEnd)){var f=this._calcTextareaPosition();this.hiddenTextarea.style.left=f.left;this.hiddenTextarea.style.top=f.top;this.hiddenTextarea.style.fontSize=f.fontSize}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var f=this.text.split(""),e=this._getCursorBoundaries(f,"cursor"),f=this.get2DCursorLocation(),b=f.lineIndex,g=f.charIndex,
f=this.getCurrentCharFontSize(b,g),g=0===b&&0===g?this._getLineLeftOffset(this._getLineWidth(this.ctx,b)):e.leftOffset,b=this.calcTransformMatrix(),e={x:e.left+g,y:e.top+e.topOffset+f},d=this.canvas.upperCanvasEl,g=d.width-f,d=d.height-f;return e=fabric.util.transformPoint(e,b),e=fabric.util.transformPoint(e,this.canvas.viewportTransform),0>e.x&&(e.x=0),e.x>g&&(e.x=g),0>e.y&&(e.y=0),e.y>d&&(e.y=d),{left:e.x+"px",top:e.y+"px",fontSize:f}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,
borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,
this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var f=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),
f&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),f&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var f in this.styles)this._textLines[f]||delete this.styles[f]},_removeCharsFromTo:function(f,e){for(;e!==f;)this._removeSingleCharAndStyle(f+1),e--;this.selectionEnd=this.selectionStart=f},_removeSingleCharAndStyle:function(f){var e="\n"===this.text[f-1];this.removeStyleObject(e,
e?f:f-1);this.text=this.text.slice(0,f-1)+this.text.slice(f);this._textLines=this._splitTextIntoLines()},insertChars:function(f,e){var b;if(1<this.selectionEnd-this.selectionStart&&this._removeCharsFromTo(this.selectionStart,this.selectionEnd),!e&&this.isEmptyStyles())return void this.insertChar(f,!1);for(var g=0,d=f.length;g<d;g++)e&&(b=fabric.copiedTextStyle[g]),this.insertChar(f[g],g<d-1,b)},insertChar:function(f,e,b){var g="\n"===this.text[this.selectionStart];this.text=this.text.slice(0,this.selectionStart)+
f+this.text.slice(this.selectionEnd);this._textLines=this._splitTextIntoLines();this.insertStyleObjects(f,g,b);this.selectionEnd=this.selectionStart+=f.length;e||(this._updateTextarea(),this.setCoords(),this._fireSelectionChanged(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this}),this.canvas&&this.canvas.renderAll())},insertNewlineStyleObject:function(f,e,b){this.shiftLineStyles(f,1);this.styles[f+1]||(this.styles[f+1]={});var g={},d={};if(this.styles[f]&&this.styles[f][e-
1]&&(g=this.styles[f][e-1]),b)d[0]=h(g);else for(var a in this.styles[f])parseInt(a,10)>=e&&(d[parseInt(a,10)-e]=this.styles[f][a],delete this.styles[f][a]);this.styles[f+1]=d;this._forceClearCache=!0},insertCharStyleObject:function(f,e,b){var g=this.styles[f],d=h(g);0!==e||b||(e=1);for(var a in d){var c=parseInt(a,10);c>=e&&(g[c+1]=d[c],d[c-1]||delete g[c])}this.styles[f][e]=b||h(g[e-1]);this._forceClearCache=!0},insertStyleObjects:function(f,e,b){var g=this.get2DCursorLocation(),d=g.lineIndex,g=
g.charIndex;this._getLineStyle(d)||this._setLineStyle(d,{});"\n"===f?this.insertNewlineStyleObject(d,g,e):this.insertCharStyleObject(d,g,b)},shiftLineStyles:function(f,e){var b=h(this.styles),g;for(g in this.styles){var d=parseInt(g,10);d>f&&(this.styles[d+e]=b[d],b[d-e]||delete this.styles[d])}},removeStyleObject:function(f,e){var b=this.get2DCursorLocation(e);this._removeStyleObject(f,b,b.lineIndex,b.charIndex)},_getTextOnPreviousLine:function(f){return this._textLines[f-1]},_removeStyleObject:function(f,
e,b,g){if(f){var d=this._getTextOnPreviousLine(e.lineIndex),d=d?d.length:0;this.styles[b-1]||(this.styles[b-1]={});for(g in this.styles[b])this.styles[b-1][parseInt(g,10)+d]=this.styles[b][g];this.shiftLineStyles(e.lineIndex,-1)}else for(d in(e=this.styles[b])&&delete e[g],b=h(e),b)f=parseInt(d,10),f>=g&&0!==f&&(e[f-1]=b[f],delete e[f])},insertNewline:function(){this.insertChars("\n")}})})();
fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date;this.__lastLastClickTime=+new Date;this.__lastPointer={};this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(h){this.__newClickTime=+new Date;var f=this.canvas.getPointer(h.e);this.isTripleClick(f)?(this.fire("tripleclick",h),this._stopEvent(h.e)):this.isDoubleClick(f)&&(this.fire("dblclick",h),this._stopEvent(h.e));this.__lastLastClickTime=this.__lastClickTime;
this.__lastClickTime=this.__newClickTime;this.__lastPointer=f;this.__lastIsEditing=this.isEditing;this.__lastSelected=this.selected},isDoubleClick:function(h){return 500>this.__newClickTime-this.__lastClickTime&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y&&this.__lastIsEditing},isTripleClick:function(h){return 500>this.__newClickTime-this.__lastClickTime&&500>this.__lastClickTime-this.__lastLastClickTime&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&
h.preventDefault();h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler();this.initMousedownHandler();this.initMouseupHandler();this.initClicks()},initClicks:function(){this.on("dblclick",function(h){this.selectWord(this.getSelectionStartFromPointer(h.e))});this.on("tripleclick",function(h){this.selectLine(this.getSelectionStartFromPointer(h.e))})},initMousedownHandler:function(){this.on("mousedown",function(h){if(this.editable){var f=this.canvas.getPointer(h.e);
this.__mousedownX=f.x;this.__mousedownY=f.y;this.__isMousedown=!0;this.selected&&this.setCursorByClick(h.e);this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())}})},_isObjectMoved:function(h){h=this.canvas.getPointer(h);return this.__mousedownX!==h.x||this.__mousedownY!==h.y},initMouseupHandler:function(){this.on("mouseup",function(h){this.__isMousedown=!1;this.editable&&!this._isObjectMoved(h.e)&&
(this.__lastSelected&&!this.__corner&&(this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()),this.selected=!0)})},setCursorByClick:function(h){var f=this.getSelectionStartFromPointer(h);h.shiftKey?f<this.selectionStart?(this.selectionEnd=this.selectionStart,this.selectionStart=f):this.selectionEnd=f:(this.selectionStart=f,this.selectionEnd=f);this._fireSelectionChanged();this._updateTextarea()},getSelectionStartFromPointer:function(h){for(var f=
this.getLocalPointer(h),e=0,b,g=0,d=0,a=0,c=this._textLines.length;a<c;a++){h=this._textLines[a];g+=this._getHeightOfLine(this.ctx,a)*this.scaleY;b=this._getLineWidth(this.ctx,a);b=this._getLineLeftOffset(b)*this.scaleX;for(var m=0,k=h.length;m<k;m++){if(e=b,b+=this._getWidthOfChar(this.ctx,h[m],a,this.flipX?k-m:m)*this.scaleX,!(g<=f.y||b<=f.x))return this._getNewSelectionStartFromOffset(f,e,b,d+a,k);d++}if(f.y<g)return this._getNewSelectionStartFromOffset(f,e,b,d+a-1,k)}return this.text.length},
_getNewSelectionStartFromOffset:function(h,f,e,b,g){h=b+(e-h.x>h.x-f?0:1);return this.flipX&&(h=g-h),h>this.text.length&&(h=this.text.length),h}});
fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea");this.hiddenTextarea.setAttribute("autocapitalize","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; opacity: 0; width: 0px; height: 0px; z-index: -999;";fabric.document.body.appendChild(this.hiddenTextarea);fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this));
fabric.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this));fabric.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this));fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this));fabric.util.addListener(this.hiddenTextarea,"cut",this.cut.bind(this));fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this));fabric.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this));fabric.util.addListener(this.hiddenTextarea,
"compositionupdate",this.onCompositionUpdate.bind(this));fabric.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this));!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",
39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMapUp:{67:"copy",88:"cut"},_ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){if(h.keyCode in this._keysMap)this[this._keysMap[h.keyCode]](h);else{if(!(h.keyCode in this._ctrlKeysMapDown&&(h.ctrlKey||h.metaKey)))return;this[this._ctrlKeysMapDown[h.keyCode]](h)}h.stopImmediatePropagation();h.preventDefault();this.canvas&&this.canvas.renderAll()}},
onKeyUp:function(h){return!this.isEditing||this._copyDone?void(this._copyDone=!1):void(h.keyCode in this._ctrlKeysMapUp&&(h.ctrlKey||h.metaKey)&&(this[this._ctrlKeysMapUp[h.keyCode]](h),h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.renderAll()))},onInput:function(h){if(this.isEditing&&!this.inCompositionMode){var f,e,b,g=this.selectionStart||0,d=this.selectionEnd||0,a=this.text.length,c=this.hiddenTextarea.value.length;c>a?(b="left"===this._selectionDirection?d:g,f=c-a,
e=this.hiddenTextarea.value.slice(b,b+f)):(f=c-a+d-g,e=this.hiddenTextarea.value.slice(g,g+f));this.insertChars(e);h.stopPropagation()}},onCompositionStart:function(){this.inCompositionMode=!0;this.prevCompositionLength=0;this.compositionStart=this.selectionStart},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){h=h.data;this.selectionStart=this.compositionStart;this.selectionEnd=this.selectionEnd===this.selectionStart?this.compositionStart+this.prevCompositionLength:
this.selectionEnd;this.insertChars(h,!1);this.prevCompositionLength=h.length},forwardDelete:function(h){if(this.selectionStart===this.selectionEnd){if(this.selectionStart===this.text.length)return;this.moveCursorRight(h)}this.removeChars(h)},copy:function(h){if(this.selectionStart!==this.selectionEnd){var f=this.getSelectedText(),e=this._getClipboardData(h);e&&e.setData("text",f);fabric.copiedText=f;fabric.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd);h.stopImmediatePropagation();
h.preventDefault();this._copyDone=!0}},paste:function(h){var f=null,e=this._getClipboardData(h),b=!0;e?(f=e.getData("text").replace(/\r/g,""),fabric.copiedTextStyle&&fabric.copiedText===f||(b=!1)):f=fabric.copiedText;f&&this.insertChars(f,b);h.stopImmediatePropagation();h.preventDefault()},cut:function(h){this.selectionStart!==this.selectionEnd&&(this.copy(h),this.removeChars(h))},_getClipboardData:function(h){return h&&h.clipboardData||fabric.window.clipboardData},getDownCursorOffset:function(h,
f){var e;e=f?this.selectionEnd:this.selectionStart;var b=this.get2DCursorLocation(e),g=b.lineIndex,d=this._textLines[g].slice(0,b.charIndex),a=this._textLines[g].slice(b.charIndex),c=this._textLines[g+1]||"";if(g===this._textLines.length-1||h.metaKey||34===h.keyCode)return this.text.length-e;e=this._getLineWidth(this.ctx,g);for(var m=this._getLineLeftOffset(e),k=0,p=d.length;k<p;k++)e=d[k],m+=this._getWidthOfChar(this.ctx,e,g,k);b=this._getIndexOnNextLine(b,c,m);return a.length+1+b},_getIndexOnNextLine:function(h,
f,e){var b;h=h.lineIndex+1;for(var g=this._getLineWidth(this.ctx,h),g=this._getLineLeftOffset(g),d=0,a=0,c=f.length;a<c;a++){var m=this._getWidthOfChar(this.ctx,f[a],h,a);if(g+=m,g>e){b=!0;d=Math.abs(g-e)<Math.abs(g-m-e)?a+1:a;break}}return b||(d=f.length),d},moveCursorDown:function(h){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||this._moveCursorUpOrDown("Down",h)},moveCursorDownWithoutShift:function(h){return this._selectionDirection="right",this.selectionEnd+=h,this.selectionStart=
this.selectionEnd,0!==h},swapSelectionPoints:function(){var h=this.selectionEnd;this.selectionEnd=this.selectionStart;this.selectionStart=h},moveCursorDownWithShift:function(h){return this.selectionEnd===this.selectionStart&&(this._selectionDirection="right"),"right"===this._selectionDirection?this.selectionEnd+=h:this.selectionStart+=h,this.selectionEnd<this.selectionStart&&"left"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="right"),this.selectionEnd>this.text.length&&
(this.selectionEnd=this.text.length),0!==h},getUpCursorOffset:function(h,f){var e=f?this.selectionEnd:this.selectionStart,b=this.get2DCursorLocation(e),g=b.lineIndex;if(0===g||h.metaKey||33===h.keyCode)return e;var d,e=this._textLines[g].slice(0,b.charIndex),a=this._textLines[g-1]||"";d=this._getLineWidth(this.ctx,b.lineIndex);for(var c=this._getLineLeftOffset(d),m=0,k=e.length;m<k;m++)d=e[m],c+=this._getWidthOfChar(this.ctx,d,g,m);b=this._getIndexOnPrevLine(b,a,c);return a.length-b+e.length},_getIndexOnPrevLine:function(h,
f,e){var b;h=h.lineIndex-1;for(var g=this._getLineWidth(this.ctx,h),g=this._getLineLeftOffset(g),d=0,a=0,c=f.length;a<c;a++){var m=this._getWidthOfChar(this.ctx,f[a],h,a);if(g+=m,g>e){b=!0;d=Math.abs(g-e)<Math.abs(g-m-e)?a:a-1;break}}return b||(d=f.length-1),d},moveCursorUp:function(h){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,f){var e="moveCursor"+h,b=this["get"+h+"CursorOffset"](f,"right"===this._selectionDirection),e=e+(f.shiftKey?
"WithShift":"WithoutShift");this[e](b)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorUpWithShift:function(h){return this.selectionEnd===this.selectionStart&&(this._selectionDirection="left"),"right"===this._selectionDirection?this.selectionEnd-=h:this.selectionStart-=h,this.selectionEnd<this.selectionStart&&"right"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="left"),
0!==h},moveCursorUpWithoutShift:function(h){return this._selectionDirection="left",this.selectionStart-=h,this.selectionEnd=this.selectionStart,0!==h},moveCursorLeft:function(h){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",h)},_move:function(h,f,e){if(h.altKey)h=this["findWordBoundary"+e](this[f]);else{if(!h.metaKey&&35!==h.keyCode&&36!==h.keyCode)return this[f]+="Left"===e?-1:1,!0;h=this["findLineBoundary"+e](this[f])}if(this[f]!==h)return this[f]=h,!0},_moveLeft:function(h,
f){return this._move(h,f,"Left")},_moveRight:function(h,f){return this._move(h,f,"Right")},moveCursorLeftWithoutShift:function(h){var f=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(f=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,f},moveCursorLeftWithShift:function(h){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(h,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection=
"left",this._moveLeft(h,"selectionStart")):void 0},moveCursorRight:function(h){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,f){var e;this._currentCursorOpacity=1;e="moveCursor"+h+"With"+(f.shiftKey?"Shift":"outShift");this[e](f)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){return"left"===this._selectionDirection&&
this.selectionStart!==this.selectionEnd?this._moveRight(h,"selectionStart"):this.selectionEnd!==this.text.length?(this._selectionDirection="right",this._moveRight(h,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(h){var f=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(f=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,f},removeChars:function(h){this.selectionStart===this.selectionEnd?
this._removeCharsNearCursor(h):this._removeCharsFromTo(this.selectionStart,this.selectionEnd);this.setSelectionEnd(this.selectionStart);this._removeExtraneousStyles();this.canvas&&this.canvas.renderAll();this.setCoords();this.fire("changed");this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(h){0!==this.selectionStart&&(h.metaKey?(h=this.findLineBoundaryLeft(this.selectionStart),this._removeCharsFromTo(h,this.selectionStart),this.setSelectionStart(h)):h.altKey?
(h=this.findWordBoundaryLeft(this.selectionStart),this._removeCharsFromTo(h,this.selectionStart),this.setSelectionStart(h)):(this._removeSingleCharAndStyle(this.selectionStart),this.setSelectionStart(this.selectionStart-1)))}});
(function(){var h=fabric.util.toFixed,f=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(e,b,f,d,a,c){this._getLineStyle(e)?this._setSVGTextLineChars(e,b,f,d,c):fabric.Text.prototype._setSVGTextLineText.call(this,e,b,f,d,a)},_setSVGTextLineChars:function(e,b,f,d,a){f=this._textLines[e];d=0;for(var c=this._getLineLeftOffset(this._getLineWidth(this.ctx,e))-this.width/2,g=this._getSVGLineTopOffset(e),h=this._getHeightOfLine(this.ctx,e),
p=0,q=f.length;p<q;p++){var n=this._getStyleDeclaration(e,p)||{};b.push(this._createTextCharSpan(f[p],n,c,g.lineTop+g.offset,d));var t=this._getWidthOfChar(this.ctx,f[p],e,p);n.textBackgroundColor&&a.push(this._createTextCharBg(n,c,g.lineTop,h,t,d));d+=t}},_getSVGLineTopOffset:function(e){for(var b=0,f=0,d=0;d<e;d++)b+=this._getHeightOfLine(this.ctx,d);return f=this._getHeightOfLine(this.ctx,d),{lineTop:b,offset:(this._fontSizeMult-this._fontSizeFraction)*f/(this.lineHeight*this._fontSizeMult)}},
_createTextCharBg:function(e,b,g,d,a,c){return['\t\t<rect fill="',e.textBackgroundColor,'" x="',h(b+c,f),'" y="',h(g-this.height/2,f),'" width="',h(a,f),'" height="',h(d/this.lineHeight,f),'"></rect>\n'].join("")},_createTextCharSpan:function(e,b,g,d,a){var c=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text",getSvgFilter:fabric.Object.prototype.getSvgFilter},b));return['\t\t\t<tspan x="',h(g+a,f),'" y="',h(d-this.height/2,f),'" ',b.fontFamily?
'font-family="'+b.fontFamily.replace(/"/g,"'")+'" ':"",b.fontSize?'font-size="'+b.fontSize+'" ':"",b.fontStyle?'font-style="'+b.fontStyle+'" ':"",b.fontWeight?'font-weight="'+b.fontWeight+'" ':"",b.textDecoration?'text-decoration="'+b.textDecoration+'" ':"",'style="',c,'">',fabric.util.string.escapeXml(e),"</tspan>\n"].join("")}})})();
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.clone;f.Textbox=f.util.createClass(f.IText,f.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:0,__cachedLines:null,lockScalingY:!0,lockScalingFlip:!0,initialize:function(b,e){this.ctx=f.util.createCanvasElement().getContext("2d");this.callSuper("initialize",b,e);this.setControlsVisibility(f.Textbox.getTextboxControlVisibility());this._dimensionAffectingProps.width=!0},_initDimensions:function(b){this.__skipDimension||(b||(b=f.util.createCanvasElement().getContext("2d"),
this._setTextStyles(b)),this.dynamicMinWidth=0,this._textLines=this._splitTextIntoLines(),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this._clearCache(),this.height=this._getTextHeight(b))},_generateStyleMap:function(){for(var b=0,e=0,d=0,a={},c=0;c<this._textLines.length;c++)"\n"===this.text[d]?(e=0,d++,b++):" "===this.text[d]&&(e++,d++),a[c]={line:b,offset:e},d+=this._textLines[c].length,e+=this._textLines[c].length;return a},_getStyleDeclaration:function(b,e,d){if(this._styleMap){var a=
this._styleMap[b];if(!a)return d?{}:null;b=a.line;e=a.offset+e}return this.callSuper("_getStyleDeclaration",b,e,d)},_setStyleDeclaration:function(b,e,d){var a=this._styleMap[b];b=a.line;e=a.offset+e;this.styles[b][e]=d},_deleteStyleDeclaration:function(b,e){var d=this._styleMap[b];b=d.line;e=d.offset+e;delete this.styles[b][e]},_getLineStyle:function(b){return this.styles[this._styleMap[b].line]},_setLineStyle:function(b,e){this.styles[this._styleMap[b].line]=e},_deleteLineStyle:function(b){delete this.styles[this._styleMap[b].line]},
_wrapText:function(b,e){var d,a=e.split(this._reNewline),c=[];for(d=0;d<a.length;d++)c=c.concat(this._wrapLine(b,a[d],d));return c},_measureText:function(b,e,d,a){var c=0;a=a||0;for(var f=0,g=e.length;f<g;f++)c+=this._getWidthOfChar(b,e[f],d,f+a);return c},_wrapLine:function(b,e,d){var a=0,c=[],f="";e=e.split(" ");for(var g,h=0,q,n=0,t=0,r=!0,u=this._getWidthOfCharSpacing(),A=0;A<e.length;A++)g=e[A],q=this._measureText(b,g,d,h),h+=g.length,a+=n+q-u,a>=this.width&&!r?(c.push(f),f="",a=q,r=!0):a+=u,
r||(f+=" "),f+=g,n=this._measureText(b," ",d,h)+u,h++,r=!1,q>t&&(t=q);return A&&c.push(f),t>this.dynamicMinWidth&&(this.dynamicMinWidth=t-u),c},_splitTextIntoLines:function(){var b=this.textAlign;this.ctx.save();this._setTextStyles(this.ctx);this.textAlign="left";var e=this._wrapText(this.ctx,this.text);return this.textAlign=b,this.ctx.restore(),this._textLines=e,this._styleMap=this._generateStyleMap(),e},setOnGroup:function(b,e){"scaleX"===b&&(this.set("scaleX",Math.abs(1/e)),this.set("width",this.get("width")*
e/("undefined"==typeof this.__oldScaleX?1:this.__oldScaleX)),this.__oldScaleX=e)},get2DCursorLocation:function(b){"undefined"==typeof b&&(b=this.selectionStart);for(var e=this._textLines.length,d=0,a=0;a<e;a++){var c=this._textLines[a].length;if(b<=d+c)return{lineIndex:a,charIndex:b-d};d+=c;"\n"!==this.text[d]&&" "!==this.text[d]||d++}return{lineIndex:e-1,charIndex:this._textLines[e-1].length}},_getCursorBoundariesOffsets:function(b,e){for(var d=0,a=0,c=this.get2DCursorLocation(),f=this._textLines[c.lineIndex].split(""),
g=this._getLineLeftOffset(this._getLineWidth(this.ctx,c.lineIndex)),h=0;h<c.charIndex;h++)a+=this._getWidthOfChar(this.ctx,f[h],c.lineIndex,h);for(h=0;h<c.lineIndex;h++)d+=this._getHeightOfLine(this.ctx,h);return"cursor"===e&&(d+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,c.lineIndex)/this.lineHeight-this.getCurrentCharFontSize(c.lineIndex,c.charIndex)*(1-this._fontSizeFraction)),{top:d,left:a,lineLeft:g}},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},
toObject:function(b){return f.util.object.extend(this.callSuper("toObject",b),{minWidth:this.minWidth})}});f.Textbox.fromObject=function(b){return new f.Textbox(b.text,e(b))};f.Textbox.getTextboxControlVisibility=function(){return{tl:!1,tr:!1,br:!1,bl:!1,ml:!0,mt:!1,mr:!0,mb:!1,mtr:!0}}})("undefined"!=typeof exports?exports:this);
(function(){var h=fabric.Canvas.prototype._setObjectScale;fabric.Canvas.prototype._setObjectScale=function(e,b,f,d,a,c,m){var g=b.target;if(!(g instanceof fabric.Textbox))return h.call(fabric.Canvas.prototype,e,b,f,d,a,c,m);e=e.x/b.scaleX/(g.width+g.strokeWidth)*g.width;return e>=g.getMinWidth()?(g.set("width",e),!0):void 0};fabric.Group.prototype._refreshControlsVisibility=function(){if("undefined"!=typeof fabric.Textbox)for(var e=this._objects.length;e--;)if(this._objects[e]instanceof fabric.Textbox)return void this.setControlsVisibility(fabric.Textbox.getTextboxControlVisibility())};
var f=fabric.util.object.clone;fabric.util.object.extend(fabric.Textbox.prototype,{_removeExtraneousStyles:function(){for(var e in this._styleMap)this._textLines[e]||delete this.styles[this._styleMap[e].line]},insertCharStyleObject:function(e,b,f){var d=this._styleMap[e];e=d.line;b=d.offset+b;fabric.IText.prototype.insertCharStyleObject.apply(this,[e,b,f])},insertNewlineStyleObject:function(e,b,f){var d=this._styleMap[e];e=d.line;b=d.offset+b;fabric.IText.prototype.insertNewlineStyleObject.apply(this,
[e,b,f])},shiftLineStyles:function(e,b){var g=f(this.styles);e=this._styleMap[e].line;for(var d in this.styles){var a=parseInt(d,10);a>e&&(this.styles[a+b]=g[a],g[a-b]||delete this.styles[a])}},_getTextOnPreviousLine:function(e){for(var b=this._textLines[e-1];this._styleMap[e-2]&&this._styleMap[e-2].line===this._styleMap[e-1].line;)b=this._textLines[e-2]+b,e--;return b},removeStyleObject:function(e,b){var f=this.get2DCursorLocation(b),d=this._styleMap[f.lineIndex];this._removeStyleObject(e,f,d.line,
d.offset+f.charIndex)}})})();(function(){var h=fabric.IText.prototype._getNewSelectionStartFromOffset;fabric.IText.prototype._getNewSelectionStartFromOffset=function(f,e,b,g,d){g=h.call(this,f,e,b,g,d);for(b=e=f=0;b<this._textLines.length&&(f+=this._textLines[b].length,!(f+e>=g));b++)"\n"!==this.text[f+e]&&" "!==this.text[f+e]||e++;return g-b+e}})();
(function(){function h(a,c,e){var f=b.parse(a);f.port||(f.port=0===f.protocol.indexOf("https:")?443:80);a=(0===f.protocol.indexOf("https:")?d:g).request({hostname:f.hostname,port:f.port,path:f.path,method:"GET"},function(a){var b="";c&&a.setEncoding(c);a.on("end",function(){e(b)});a.on("data",function(c){200===a.statusCode&&(b+=c)})});a.on("error",function(a){a.errno===process.ECONNREFUSED?fabric.log("ECONNREFUSED: connection refused to "+f.hostname+":"+f.port):fabric.log(a.message);e(null)});a.end()}
function f(a,b){require("fs").readFile(a,function(a,c){if(a)throw fabric.log(a),a;b(c)})}if("undefined"==typeof document||"undefined"==typeof window){var e=require("xmldom").DOMParser,b=require("url"),g=require("http"),d=require("https"),a=require("canvas"),c=require("canvas").Image;fabric.util.loadImage=function(a,b,d){function e(c){c?(g.src=new Buffer(c,"binary"),g._src=a,b&&b.call(d,g)):(g=null,b&&b.call(d,null,!0))}var g=new c;a&&(a instanceof Buffer||0===a.indexOf("data"))?(g.src=g._src=a,b&&
b.call(d,g)):a&&0!==a.indexOf("http")?f(a,e):a?h(a,"binary",e):b&&b.call(d,a)};fabric.loadSVGFromURL=function(a,b,c){a=a.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim();0!==a.indexOf("http")?f(a,function(a){fabric.loadSVGFromString(a.toString(),b,c)}):h(a,"",function(a){fabric.loadSVGFromString(a,b,c)})};fabric.loadSVGFromString=function(a,b,c){a=(new e).parseFromString(a);fabric.parseSVGDocument(a.documentElement,function(a,c){b&&b(a,c)},c)};fabric.util.getScript=function(a,b){h(a,"",function(a){eval(a);
b&&b()})};fabric.Image.fromObject=function(a,b){fabric.util.loadImage(a.src,function(c){var d=new fabric.Image(c);d._initConfig(a);d._initFilters(a.filters,function(c){d.filters=c||[];d._initFilters(a.resizeFilters,function(a){d.resizeFilters=a||[];b&&b(d)})})})};fabric.createCanvasForNode=function(b,c,d,e){e=e||d;var f=fabric.document.createElement("canvas"),g=new a(b||600,c||600,e);b=new a(b||600,c||600,e);f.style={};f.width=g.width;f.height=g.height;d=new (fabric.Canvas||fabric.StaticCanvas)(f,
d);return d.contextContainer=g.getContext("2d"),d.nodeCanvas=g,d.contextCache=b.getContext("2d"),d.nodeCacheCanvas=b,d.Font=a.Font,d};fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()};fabric.StaticCanvas.prototype.createJPEGStream=function(a){return this.nodeCanvas.createJPEGStream(a)};var m=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(a,b){return m.call(this,a,b),this.nodeCanvas.width=a,this};fabric.Canvas&&
(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var k=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(a,b){return k.call(this,a,b),this.nodeCanvas.height=a,this};fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}})();"use strict";
var _slicedToArray=function(){return function(h,f){if(Array.isArray(h))return h;if(Symbol.iterator in Object(h)){var e=[],b=!0,g=!1,d=void 0;try{for(var a=h[Symbol.iterator](),c;!(b=(c=a.next()).done)&&(e.push(c.value),!f||e.length!==f);b=!0);}catch(m){g=!0,d=m}finally{try{if(!b&&a["return"])a["return"]()}finally{if(g)throw d;}}return e}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),rgbToHSV2=function(h,f,e){var b,g,d,a;h/=255;f/=255;e/=255;d=Math.max(h,f,e);g=Math.min(h,
f,e);b=d-g;a=0===d?0:b/d;d===g?g=0:(g=function(){switch(d){case h:return(f-e)/b+(f<e?6:0);case f:return(e-h)/b+2;case e:return(h-f)/b+4}}(),g/=6);return{h:g,s:a,v:d}},hsvToRGB=function(h,f,e){var b,g,d,a,c,m;a=Math.floor(6*h);g=6*h-a;h=e*(1-f);c=e*(1-g*f);f=e*(1-(1-g)*f);switch(a%6){case 0:m=e;d=f;b=h;break;case 1:m=c;d=e;b=h;break;case 2:m=h;d=e;b=f;break;case 3:m=h;d=c;b=e;break;case 4:m=f;d=h;b=e;break;case 5:m=e,d=h,b=c}return{r:Math.floor(255*m),g:Math.floor(255*d),b:Math.floor(255*b)}},curves=
function(h){for(var f=arguments.length,e=Array(1<f?f-1:0),b=1;b<f;b++)e[b-1]=arguments[b];f=[e.length-1];"function"===typeof f?e.pop():"string"===typeof f?(f=Calculate[f],e.pop()):f=Calculate.bezier;"string"===typeof h&&(h=h.split(""));"v"===h[0]&&(h=["r","g","b"]);if(2>e.length)throw"Invalid number of arguments to curves filter";var f=f(e,0,255),g=e[0];if(0<g[0])for(b=0;b<g[0];b++)f[b]=g[1];e=e[e.length-1];if(255>e[0])for(b=0;b<e[0];b++)f[b]=e[1];return[h,f]},Calculate=function(){function h(){}h.distance=
function(f,e,b,g){return Math.sqrt(Math.pow(b-f,2)+Math.pow(g-e,2))};h.randomRange=function(f,e,b){null==b&&(b=!1);f+=Math.random()*(e-f);return b?f.toFixed(b):Math.round(f)};h.luminance=function(f){return.299*f.r+.587*f.g+.114*f.b};h.bezier=function(f,e,b,g,d,a){var c,m,k,p,q,n,t;null==d&&(d=0);null==a&&(a=255);f[0]instanceof Array?(d=e,a=b):f=[f,e,b,g];if(2>f.length)throw"Invalid number of arguments to bezier";e={};g=function(a,b,c){return a*(1-c)+b*c};b=function(a,b,c){return Math.min(Math.max(a,
b),c)};for(c=q=0;1E3>q;c=++q){p=c/1E3;for(k=f;1<k.length;){m=[];c=n=0;for(t=k.length-2;0<=t?n<=t:n>=t;c=0<=t?++n:--n)m.push([g(k[c][0],k[c+1][0],p),g(k[c][1],k[c+1][1],p)]);k=m}e[Math.round(k[0][0])]=Math.round(b(k[0][1],d,a))}d=f[f.length-1][0];e=h.missingValues(e,d);null==e[d]&&(e[d]=e[d-1]);return e};h.hermite=function(f,e,b){var g,d,a,c,m,k,p,q,n,t,r,u,A,y,v,x,z,w;if(2>f.length)throw"Invalid number of arguments to hermite";v={};g=function(a,b,c,d){return[a[0]+b[0]+c[0]+d[0],a[1]+b[1]+c[1]+d[1]]};
n=function(a,b){return[a[0]*b[0],a[1]*b[1]]};x=function(a,b){return[a[0]-b[0],a[1]-b[1]]};d=function(a,b,c){return Math.min(Math.max(a,b),c)};p=z=0;for(w=f.length-2;0<=w?z<=w:z>=w;p=0<=w?++z:--z)for(r=f[p],u=f[p+1],A=u[0]-r[0],y=1/A,p===f.length-2&&(y=1/(A-1)),t=0<p?f[p-1]:r,q=n(x(u,t),[.5,.5]),t=p<f.length-2?f[p+2]:u,p=n(x(t,r),[.5,.5]),a=t=0;0<=A?t<=A:t>=A;a=0<=A?++t:--t)k=a*y,a=2*k*k*k-3*k*k+1,c=k*k*k-2*k*k+k,m=-2*k*k*k+3*k*k,k=k*k*k-k*k,a=g(n(r,[a,a]),n(q,[c,c]),n(u,[m,m]),n(p,[k,k])),v[Math.round(a[0])]=
Math.round(d(a[1],e,b));return v=h.missingValues(v,f[f.length-1][0])};h.missingValues=function(f,e){var b,g,d,a,c,h,k;if(Object.keys(f).length<e+1){a={};for(b=h=0;0<=e?h<=e:h>=e;b=0<=e?++h:--h)if(null!=f[b])a[b]=f[b];else{d=[b-1,a[b-1]];for(g=k=b;b<=e?k<=e:k>=e;g=b<=e?++k:--k)if(null!=f[g]){c=[g,f[g]];break}a[b]=d[1]+(c[1]-d[1])/(c[0]-d[0])*(b-d[0])}return a}return f};return h}();
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.SepiaInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"SepiaInc",initialize:function(e){e=e||{};this.sepia=e.sepia||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=this.sepia;void 0===a&&(a=100);a/=100;return[Math.min(255,e*(1-.607*a)+.769*b*a+.189*f*a),Math.min(255,.349*e*a+b*(1-.314*a)+.168*f*a),Math.min(255,.272*e*a+.534*b*a+f*(1-.869*a)),d]}});f.Image.filters.SepiaInc.fromObject=function(){return new f.Image.filters.SepiaInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.GammaInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"GammaInc",initialize:function(e){e=e||{};this.gamma=e.gamma||1},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=this.gamma;return[255*Math.pow(e/255,a),255*Math.pow(b/255,a),255*Math.pow(f/255,a),d]}});f.Image.filters.GammaInc.fromObject=function(){return new f.Image.filters.GammaInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.ContrastInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"ContrastInc",initialize:function(e){e||(e={});this.contrast=e.contrast||0;this.brightness=e.brightness||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=Math.max(0,this.contrast+1),c=1+Math.min(150,Math.max(-150,this.brightness))/150,g;-1!=a?(c*=a,g=128*-a+128):g=0;var a=e*c+g,h=b*c+g,c=f*c+g;255<a?a=255:0>e&&(a=0);255<h?h=255:0>b&&(h=0);255<c?c=255:0>f&&(c=0);return[a,
h,c,d]}});f.Image.filters.ContrastInc.toObject=function(){return extend(this.callSuper("toObject"),{contrast:this.contrast,brightness:this.brightness})};f.Image.filters.ContrastInc.fromObject=function(){return new f.Image.filters.ContrastInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.HueInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"HueInc",initialize:function(e){e=e||{};this.hue=e.hue||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=this.hue;e=rgbToHSV2(e,b,f);b=100*e.h;b+=Math.abs(a);e.h=b%100/100;a=hsvToRGB(e.h,e.s,e.v);return[a.r,a.g,a.b,d]}});f.Image.filters.HueInc.fromObject=function(){return new f.Image.filters.HueInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.ExposureInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"ExposureInc",initialize:function(e){e=e||{};this.exposure=e.exposure||0;this.bezier=void 0},ajust:function(){var e=this.exposure,b=Math.abs(e)/100,f=[0,255*b],b=[255-255*b,255];0>e&&(f=f.reverse(),b=b.reverse());e=curves("rgb",[0,0],f,b,[255,255]);this.bezier=_slicedToArray(e,2)[1]},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=this.bezier,c=e,g=b,h=f;void 0!==a&&
(c=a[e],g=a[b],h=a[f]);return[c,g,h,d]}});f.Image.filters.ExposureInc.fromObject=function(){return new f.Image.filters.ExposureInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.VibranceInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"VibranceInc",initialize:function(e){e=e||{};this.vibrance=e.vibrance||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=Math.max(e,b,f),c=2*Math.abs(a-(e+b+f)/3)/255*-1*this.vibrance/100;e!==a&&(e+=(a-e)*c);b!==a&&(b+=(a-b)*c);f!==a&&(f+=(a-f)*c);return[e,b,f,d]}});f.Image.filters.VibranceInc.fromObject=function(){return new f.Image.filters.VibranceInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.SaturationInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"SaturationInc",initialize:function(e){e=e||{};this.saturation=e.saturation||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=-.01*this.saturation,c=Math.max(e,b,f);e!==c&&(e+=(c-e)*a);b!==c&&(b+=(c-b)*a);f!==c&&(f+=(c-f)*a);return[e,b,f,d]}});f.Image.filters.SaturationInc.fromObject=function(){return new f.Image.filters.SaturationInc}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.filters.ClipInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"ClipInc",initialize:function(e){e=e||{};this.clip=e.clip||0},applyTo:function(e){},applyFilter:function(e,b,f,d){var a=2.55*Math.abs(this.clip),c=e,g=b,h=f;e>255-a?c=255:e<a&&(c=0);b>255-a?g=255:b<a&&(g=0);f>255-a?h=255:f<a&&(h=0);return[c,g,h,d]}});f.Image.filters.ClipInc.fromObject=function(){return new f.Image.filters.ClipInc}})(window);
(function(h){function f(){this.a=this.b=this.g=this.r=0;this.next=null}function e(a,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:a.width,q=5<arguments.length&&void 0!==arguments[5]?arguments[5]:a.height;if(!(Number.isNaN(c)||1>c)){c|=0;var n=a.getContext("2d"),t=n.getImageData(d,e,h,q),r=t.data,u,A,y,v,x,z,w,B,C,E,I,J,D,N,O,G,L,M,P,R,S,H,Z;u=c+c+1;var ba=h-1,fa=
q-1,X=c+1,Y=X*(X+1)/2,U=new f,K=U;for(y=1;y<u;y++)if(K=K.next=new f,y==X)var da=K;K.next=U;z=x=0;var ga=b[c],ha=g[c];for(A=0;A<q;A++){O=G=L=M=w=B=C=E=0;I=X*(P=r[x]);J=X*(R=r[x+1]);D=X*(S=r[x+2]);N=X*(H=r[x+3]);w+=Y*P;B+=Y*R;C+=Y*S;E+=Y*H;K=U;for(y=0;y<X;y++)K.r=P,K.g=R,K.b=S,K.a=H,K=K.next;for(y=1;y<X;y++)v=x+((ba<y?ba:y)<<2),w+=(K.r=P=r[v])*(Z=X-y),B+=(K.g=R=r[v+1])*Z,C+=(K.b=S=r[v+2])*Z,E+=(K.a=H=r[v+3])*Z,O+=P,G+=R,L+=S,M+=H,K=K.next;y=U;K=da;for(u=0;u<h;u++)r[x+3]=H=E*ga>>ha,0!=H?(H=255/H,r[x]=
(w*ga>>ha)*H,r[x+1]=(B*ga>>ha)*H,r[x+2]=(C*ga>>ha)*H):r[x]=r[x+1]=r[x+2]=0,w-=I,B-=J,C-=D,E-=N,I-=y.r,J-=y.g,D-=y.b,N-=y.a,v=z+((v=u+c+1)<ba?v:ba)<<2,O+=y.r=r[v],G+=y.g=r[v+1],L+=y.b=r[v+2],M+=y.a=r[v+3],w+=O,B+=G,C+=L,E+=M,y=y.next,I+=P=K.r,J+=R=K.g,D+=S=K.b,N+=H=K.a,O-=P,G-=R,L-=S,M-=H,K=K.next,x+=4;z+=h}for(u=0;u<h;u++){G=L=M=O=B=C=E=w=0;x=u<<2;I=X*(P=r[x]);J=X*(R=r[x+1]);D=X*(S=r[x+2]);N=X*(H=r[x+3]);w+=Y*P;B+=Y*R;C+=Y*S;E+=Y*H;K=U;for(y=0;y<X;y++)K.r=P,K.g=R,K.b=S,K.a=H,K=K.next;v=h;for(y=1;y<=
c;y++)x=v+u<<2,w+=(K.r=P=r[x])*(Z=X-y),B+=(K.g=R=r[x+1])*Z,C+=(K.b=S=r[x+2])*Z,E+=(K.a=H=r[x+3])*Z,O+=P,G+=R,L+=S,M+=H,K=K.next,y<fa&&(v+=h);x=u;y=U;K=da;for(A=0;A<q;A++)v=x<<2,r[v+3]=H=E*ga>>ha,0<H?(H=255/H,r[v]=(w*ga>>ha)*H,r[v+1]=(B*ga>>ha)*H,r[v+2]=(C*ga>>ha)*H):r[v]=r[v+1]=r[v+2]=0,w-=I,B-=J,C-=D,E-=N,I-=y.r,J-=y.g,D-=y.b,N-=y.a,v=u+((v=A+X)<fa?v:fa)*h<<2,w+=O+=y.r=r[v],B+=G+=y.g=r[v+1],C+=L+=y.b=r[v+2],E+=M+=y.a=r[v+3],y=y.next,I+=P=K.r,J+=R=K.g,D+=S=K.b,N+=H=K.a,O-=P,G-=R,L-=S,M-=H,K=K.next,
x+=h}n.putImageData(t,d,e)}}var b=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,
302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,
282,280,278,275,273,271,269,267,265,263,261,259],g=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,
23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],d=h.fabric||(h.fabric={});d.Image.filters.StackBlur=d.util.createClass(d.Image.filters.BaseFilter,{type:"StackBlur",initialize:function(a){a=a||{};this.radius=a.radius||0},applyTo:function(a){e(a,
this.radius)}});d.Image.filters.StackBlur.fromObject=function(){return new d.Image.filters.StackBlur}})(window);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.NoiseInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"NoiseInc",initialize:function(b){b=b||{};this.noise=b.noise||0},applyTo:function(b){},applyFilter:function(b,e,d,a){var c=(.5-Math.random())*this.noise;return[b+c,e+c,d+c,a]},toObject:function(){return e(this.callSuper("toObject"),{noise:this.noise})}});f.Image.filters.NoiseInc.fromObject=function(b){return new f.Image.filters.NoiseInc(b)}})(window);
(function(h){var f=h.fabric||(h.fabric={}),e=f.util.object.extend;f.Image.filters.BrightnessInc=f.util.createClass(f.Image.filters.BaseFilter,{type:"BrightnessInc",initialize:function(b){b=b||{};this.brightness=b.brightness||0},applyTo:function(b){},applyFilter:function(b,e,d,a){var c=Math.floor(this.brightness/100*255);return[b+c,e+c,d+c,a]},toObject:function(){return e(this.callSuper("toObject"),{brightness:this.brightness})}});f.Image.filters.BrightnessInc.fromObject=function(b){return new f.Image.filters.BrightnessInc(b)}})(window);
(function(h){var f=h.fabric||(h.fabric={});f.Image.mapFilters=function(e,b,g,d){b=b||this.filters;if(g=g||this._originalElement){var a=g,c=f.util.createCanvasElement(),h=f.util.createImage(),k=this,p=c.getContext("2d");c.width=a.width;c.height=a.height;c.getContext("2d").drawImage(a,0,0,a.width,a.height);if(0===b.length)return this._element=g,e&&e(),c;g=p.getImageData(0,0,c.width,c.height);var q=g.data,n=q.length,t=b.filter(function(a){return 0>["Convolute","StackBlur"].indexOf(a.type)});b=b.filter(function(a){return 0<=
["Convolute","StackBlur"].indexOf(a.type)});if(t.length){for(var r=0;r<n;r+=4){var u=t.reduce(function(a,b){return void 0!==b?b.applyFilter(a[0],a[1],a[2],a[3]):a},[q[r],q[r+1],q[r+2],q[r+3]]);q[r]=u[0];q[r+1]=u[1];q[r+2]=u[2];q[r+3]=u[3]}p.putImageData(g,0,0)}b.length&&b.forEach(function(a){a&&a.applyTo(c,a.scaleX||k.scaleX,a.scaleY||k.scaleY)});h.width=c.width;h.height=c.height;f.isLikelyNode?(h.src=c.toBuffer(void 0,f.Image.pngCompression),k._element=h,!d&&(k._filteredEl=h),e&&e()):(h.onload=function(){k._element=
h;!d&&(k._filteredEl=h);e&&e();h.onload=c=a=null},h.src=c.toDataURL("image/png"));return c}}})(window);"use strict";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;window.URL=window.URL||window.webkitURL||window.mozURL;
Array.prototype.includes||(Array.prototype.includes=function(h,f){var e=Object(this),b=parseInt(e.length)||0;if(0===b)return!1;var g=parseInt(f)||0;0<=g||(g=b+g,0>g&&(g=0));for(var d;g<b;){d=e[g];if(h===d||h!==h&&d!==d)return!0;g++}return!1});"use strict";
var _createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
function _toConsumableArray(h){if(Array.isArray(h)){for(var f=0,e=Array(h.length);f<h.length;f++)e[f]=h[f];return e}return Array.from(h)}var ImagePlugin=ImagePlugin||{};
ImagePlugin.Utils=function(h,f){function e(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(1<c.length)return b=c.map(function(b){a.append(b);return p(b[0])}),Promise.all(b);if(Array.isArray(c[0]))return e.apply(void 0,[a].concat(_toConsumableArray(c[0])));a.append(c[0]);return p(c[0][0])}function b(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"item";return h("<"+(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"div")+">").attr("data-cutter-"+
b,a).addClass("cutter-"+b+" cutter-"+a)}function g(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return b(a,"text",2<arguments.length&&void 0!==arguments[2]?arguments[2]:"span").text(c)}function d(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"default";""===c&&(c=a);return b(a,"action","button").attr("type","button").text(c).addClass("cutter-btn-"+d).addClass("cutter-clickable")}function a(a,c){return b(a,
"input","input").attr("type",c).attr("name","ns-"+a)}function c(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return b(a,"option","option").attr("value",c).text(c)}function m(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{width:0,height:0,format:"jpeg"},c=document.createElement("canvas"),d=b.width,e=b.height;c.width=d;c.height=e;var f=c.getContext("2d");try{return f.drawImage(a,0,0,d,e),c.toDataURL("image/"+b.format)}catch(J){return console.log(J),!1}}function k(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return m(a,{width:b.width?b.width:a.width||a.videoWidth,height:b.height?b.width:a.height||a.videoHeight,format:b.format?cong.format:"png"})}function p(a){return new Promise(function(b){setTimeout(function(){requestAnimationFrame(function(){window.getComputedStyle(a).cssText;requestAnimationFrame(function(){b(a)})})},0)})}function q(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b.forEach(function(a){a.attr("data-state",
"init");a.removeClass("cutter-active")})}function n(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b.forEach(function(a){a.attr("data-state","active");a.addClass("cutter-active")})}function t(a){function b(a){return 10>a?"0"+a:a}a=a.split("-");if(1>a.length)return"";var c=new Date;return a.reduce(function(a,d){switch(d){case "dd":return a+"-"+b(c.getDate());case "mm":return a+"-"+b(c.getMonth()+1);case "yyyy":return a+"-"+b(c.getFullYear());default:return a}},"").slice(1)}function r(a,
b,c,d){return Math.min(c/a,d/b)}function u(a,b,c,d){c=r(a,b,c,d);return{width:a*c,height:b*c}}function A(a){a.preventDefault();a.stopPropagation()}function y(a){return"undefined"!==typeof a}function v(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;a.attr("value",b);a.val(b);c&&a.trigger("change")}var x=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";_classCallCheck(this,a);this.current=b;this.switchMap={}}_createClass(a,[{key:"register",
value:function(a,b){var c=b.onIn;if(void 0===c&&"function"!==typeof c)throw Error("All switch events (onIn) must be defined.");this.switchMap[a]=b}},{key:"authorize",value:function(a){var b=this.switchMap[a];return void 0!==b&&(b=b.auth,void 0!==b&&"function"===typeof b&&!1===b.call(this,a))?!1:!0}},{key:"routeIn",value:function(a,b){var c=this,d=this.switchMap[a],e=Promise.resolve();if(void 0!==d)var f=d.onIn,e=e.then(function(){return f({params:b,previous:c.current,current:a})});return e}},{key:"routeOut",
value:function(a,b){var c=this,d=this.switchMap[a],e=Promise.resolve();if(void 0!==d){var f=d.onOut;void 0!==f&&(e=e.then(function(){return f({previous:c.current,current:a,params:b})}))}return e}},{key:"routeTo",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},f=Promise.resolve(),g=this.current;(a!==g||b)&&this.authorize(a)&&(this.current=
a,f=this.routeOut(g,e).then(function(b){return c.routeIn(a,d)}));return f}}]);return a}();return{makeElement:b,makeText:g,makeAction:d,makeToolbar:function(a){return b(a,"toolbar","div")},makeInput:a,makeOption:c,makeSelect:function(a){for(var d=b(a,"select","select"),e=arguments.length,f=Array(1<e?e-1:0),g=1;g<e;g++)f[g-1]=arguments[g];e=f.map(function(b){return c(a,b)});d.append.apply(d,e);return d},makeGroup:function(a){for(var c=b(a,"group","div"),d=arguments.length,e=Array(1<d?d-1:0),f=1;f<d;f++)e[f-
1]=arguments[f];return c.append.apply(c,e)},makeSearch:function(c){var e=b("search-form-"+c,"form","form"),f=a(c,"search");c=d("search-action-"+c).attr("type","submit");e.append(f,c);return{form:e,input:f,button:c}},videoToImage:k,sourceToImage:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=new Image;return h.Deferred(function(d){c.onload=function(a){d.resolve(c)};c.onerror=d.reject;if("string"===typeof a)c.src=a;else{var e=a.prop("nodeName");c.width=a.width();c.height=
a.height();if("VIDEO"===e)c.src=k(a[0],b);else if("CANVAS"===e)c.src=a[0].toDataURL(b.format,1);else return d.resolve(a)}}).promise()},setInitState:q,setActiveState:n,setDisabled:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b.forEach(function(a){a.addClass("cutter-disabled");a.attr("disabled","true")})},setEnabled:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b.forEach(function(a){a.removeClass("cutter-disabled");a.removeAttr("disabled")})},
ajustSizeTo:function(a,b){a.prop("width",b.width());a.prop("height",b.height())},download:function(a){var b=a.filename,c=a.format,d=a.url;a=t(a.dateFormat);if(void 0===b||""===b)b="output";b=b+"-"+a+"."+c;c=document.createElement("a");c.style.display="none";c.setAttribute("href",d);c.setAttribute("download",b);document.body.appendChild(c);c.click();document.body.removeChild(c);window.URL.revokeObjectURL(d)},secAndMin:function(a){a=parseFloat(a).toFixed(2);return[a%60,a/60]},separateCamelCase:function(a){var b=
a.charAt(0);a=a.substring(1).split("").reduce(function(a,b){return b===b.toUpperCase()?a+" "+b:a+b},"");return b+a},parseImageExif:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{disableImageHead:!0,disableExifGps:!1,disableExifSub:!1,disableExifThumbnail:!1};return h.Deferred(function(c){f.parseMetaData(a,function(b){b.exif?c.resolve(b.exif):c.reject(Error("Couldn't parse EXIF data from file: "+a.name))},b)}).promise()},noOperation:A,calcAspectRatioFit:u,makeRouter:function(){return new x(0<
arguments.length&&void 0!==arguments[0]?arguments[0]:"")},makeDispatcher:function(a,b){var c=this;return function(d){var e=d.target.dataset;void 0!==e&&(e=e[a],void 0!==e&&(d.action=e,b.call(c,d)))}},playOnReady:function(a){a.on("canplay",function(b){a[0].play()})},throttle:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:250,c=arguments[2],d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&g<d+b?(clearTimeout(e),e=setTimeout(function(){d=g;a.apply(f,h)},b)):(d=
g,a.apply(f,h))}},applyLanguage:function(a,b){if(y(b)&&y(a)&&0<a.length)return b.hasOwnProperty("title")&&a.attr("title",b.title),b.hasOwnProperty("text")&&a.text(b.text),b.hasOwnProperty("placeholder")&&a.attr("placeholder",b.placeholder),a},getBaseURL:function(){var a=window.location;return a.protocol+"//"+a.host+"/"+a.pathname.split("/")[1]},makeContextMenu:function(a){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];a=h(a);var e=h(document),f=h(window),g=void 0,r=!1;a.on("contextmenu",
function(b){target=b.target;b.stopPropagation();b.preventDefault();var c=0,d=0;b||(b=window.event);if(b.pageX||b.pageY)c=b.pageX,d=b.pageY;else if(b.clientX||b.clientY)c=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=b.clientY+document.body.scrollTop+document.documentElement.scrollTop;b={x:c,y:d};h.contains(a[0],target)&&!r?m(1,b):r&&m(0)});e.on("click",function(a){1===(a.which||a.button)&&m(0)});f.on("keyup",function(a){27===(a.which||a.keyCode)&&m(0)});var m=function(e){var f=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};if(0<e){var m=f.x,f=f.y;list=b("contextmenu","menu","ul").css({position:"absolute",left:m+"px",top:f+"px"});g=d.reduce(function(a,b){var d=b.title,e=b.action,f=h("<li>"),d=h("<a href='javascript:;'>").text(d);d.on("click",function(a){a.preventDefault();h.isFunction(e)&&e.call(c,a)});f.append(d);return a.append(f)},list);r=!0;a.append(g)}else y(g)&&(g.remove(),r=!1)};return m},isImageURL:function(a){return null!==a.match(/\.(jpeg|jpg|gif|png)$/)},
getBase64Image:m,makeInputRange:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{min:0,max:100,value:0,step:1},e=a("settings-controls-"+b,"range");e.attr(d);c.length&&c.forEach(function(a){e.on("change",function(b){b=Number(e.val());var c=Number(a.val());b!==c&&v(a,b)});a.attr(d);a.on("change",function(b){b=Number(e.val());var c=Number(a.val());b!==c&&v(e,c)})});return e},calcAspectRatio:r,makeEphemeral:function(a){var c=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:300,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"global",f=void 0;return{activate:function(){void 0!==f&&(n(f),f.css({opacity:1,visibility:"visible"}),f.on("transitionend",function(){f.off()}))},deactivate:function(a){void 0!==f&&(q(f),f.css({opacity:0,visibility:"hidden"}),f.on("transitionend",function(){h.isFunction(a)&&a(f);f.off()}))},render:function(g,h){g=g||a;h=h||d;f=b("ephemeral","item");f.attr("disabled","true");f.attr("data-cutter-ns",
h);f.css({opacity:0,visibility:"hidden",zIndex:1E3,cursor:"not-allowed",transition:"all "+c+"ms"});return e(g,f)},unrender:function(a){return f.remove()}}},makeNotification:function(a,c){function f(){var a=h.extend({},c,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});if(v)r(),f(a);else{v=!0;t.html(a.message);switch(a.type){case "success":m.attr("data-cutter-type","success");break;case "danger":m.attr("data-cutter-type","danger");break;case "warning":m.attr("data-cutter-type","danger");
break;default:m.attr("data-cutter-type","info")}n(m);k=setTimeout(function(b){r(a.onLifespanEnd)},a.lifespan)}}function r(a){v&&(q(m),v=!1,void 0!==k&&(clearTimeout(k),k=void 0),h.isFunction(a)&&a(m))}var m=void 0,k=void 0,u=void 0,t=void 0,v=!1;c=h.extend({},{message:"",lifespan:3500,type:"info",onLifespanEnd:void 0,ns:""},c);return{deactivate:r,activate:f,render:function(){var f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c,k=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,f=
h.extend({},c,f);m=b("notification","box");t=g("notification-msg");u=d("quit").addClass("alt");u.html("&#x2716");u.on("click",function(a){A(a);r(f.onLifespanEnd)});m.attr("data-cutter-namespace",f.ns).css("z-index",1E3);m.append(t,u);return e(k,m)},unrender:function(b){void 0!==k&&(clearTimeout(k),k=void 0);void 0!==m&&(m.remove(),m=void 0,void 0!==a&&p(a[0]))}}},fmt:function(a,b){if(0===a.length)return"";if(void 0===b)return a;var c=Object.keys(b);return 0===c.length?a:c.reduce(function(a,c){return a.replace(RegExp("\\{"+
c+"\\}","gi"),b[c].toString())},a)},setInput:v,toFixedNumber:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return Number(Number(parseFloat(a)).toFixed(b))},getBounds:function(a,b,c){var d=Math.abs(Math.cos(c));c=Math.abs(Math.sin(c));return{h:b*d+a*c,w:b*c+a*d}},flipCanvas:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,c=a.getContext("2d");b?(c.translate(0,a.height),c.scale(1,-1)):(c.translate(a.width,0),c.scale(-1,1));c.drawImage(a,0,0)},
cloneCanvas:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;if(a){var c=a.cloneNode(!0);if(!b)for(b=0;b<c.attributes.length;b++)/^data-/i.test(c.attributes[b].name)&&c.removeAttribute(c.attributes[b].name);c.getContext("2d").drawImage(a,0,0);return c}},sizesToAspectRatio:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a.prop("width"),d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:a.prop("height"),e=4<arguments.length&&void 0!==arguments[4]?
arguments[4]:b.prop("width"),f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:b.prop("height");void 0===c&&(c=a.width());void 0===d&&(d=a.height());void 0===e&&(e=b.width());void 0===f&&(f=b.height());c=u(c,d,e,f);return a.css({width:c.width,height:c.height})},waitReflow:p,appendTo:e,html:function(a,b){a.html(b);return p(b[0])}}}(jQuery,loadImage);"use strict";
_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();function _toConsumableArray(h){if(Array.isArray(h)){for(var f=0,e=Array(h.length);f<h.length;f++)e[f]=h[f];return e}return Array.from(h)}
function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){var b=function(){function b(d){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,b);this.view=d;this.conf=a;this.dom=void 0;this.records=[];this.undos=[];this.current=0;this.opened=this.active=!1;this.defaultUndo=void 0}_createClass(b,[{key:"addRecord",value:function(){for(var b=this,a=arguments.length,c=Array(a),g=0;g<a;g++)c[g]=arguments[g];var a=this.dom.list,g=c.length,h=this.size(),g=this.current+g;if(this.isFull()){c.forEach(function(a){b.records=
b.records.slice(1);b.current--});var p=[].concat(_toConsumableArray(this.records)),a=[].slice.call(a.children()).map(function(a,c){return b.hideEl(a,200*(h-c))});this.records=[];this.current=0;return f.when.apply(f,a).done(function(a){b.addRecord.apply(b,p.concat(c))})}a&&[].slice.call(a.children(),this.current,g).forEach(function(a,d){b.setEl(a,c[d]);b.showEl(a,200*(b.current+d))});c.forEach(function(a){a.state=e.cloneCanvas(a.state,!1);b.records.push(a)});this.current=g;1<this.current&&this.activate()}},
{key:"addUndo",value:function(){for(var b=this,a=arguments.length,c=Array(a),e=0;e<a;e++)c[e]=arguments[e];c.forEach(function(a){f.isFunction(a.rewind)&&f.isFunction(a.pred)&&b.undos.push(a)})}},{key:"undo",value:function(b,a){var c=this,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1;if(this.isEmpty())this.deactivate(),this.close();else{var e=this.dom.list,g=a;if(void 0===g){var h=this.size();this.current===h?(g=this.records.pop(),this.hideEl.call(this,e.children().get(this.current-1)),
this.current--):d=Math.abs(this.current-h)}else d=this.records.indexOf(g),g=this.records[d];if(0<=d){var n=this.size()-d;[].slice.call(e.children(),d).forEach(function(a,b){c.hideEl(a,200*(n-b))});this.records=this.records.slice(0,-n);this.current=d}d=this.undos;if(d.length){f.isFunction(this.conf.onBeforeUndo)&&this.conf.onBeforeUndo.call(this,g);var t=!1;d.forEach(function(a){a.pred()&&!t&&(a.rewind(g.state),t=!0)});t||void 0!==g.state&&this.defaultUndo.rewind(g.state)}b?b.call(this,g):f.isFunction(this.conf.onUndo)&&
this.conf.onUndo.call(this,g);this.isEmpty()&&this.renew(g)}}},{key:"showEl",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b=f(b);b.show();return this.slide(0,this.conf.inDuration||350,a,void 0,b)}},{key:"hideEl",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b=f(b);var c=this.conf.outDuration||350,d=1.2*b.width();return this.slide(d,c,a,function(a){a.off();a.hide()},b)}},{key:"appendEl",value:function(b,a,c){var d=this;a=f(a);var e=
this.conf.inDuration||350;return f.when(b.append(b,a)).then(function(b){if(f.contains(document.documentElement,a[0]))return d.slide(0,e,c,void 0,a)})}},{key:"removeEl",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b=f(b);var c=this.conf.outDuration||350,d=1.2*b.width();return this.slide(d,c,a,function(a){return a.remove()},b)}},{key:"hasPrev",value:function(){return 1<this.current}},{key:"size",value:function(){return this.records.length}},{key:"isEmpty",value:function(){return 0===
this.records.length}},{key:"isFull",value:function(){return this.conf.capacity===this.records.length}},{key:"render",value:function(){var b=this,a=this.dom=this.makeDom(),c=a.drawer,g=a.undo,h=a.list;a.open.on("click",function(a){b.opened?b.close():b.open();f.isFunction(b.conf.toggleDrawer)&&b.conf.toggleDrawer.call(b,a)});g.on("click",function(a){b.undo()});e.appendTo(this.view,c).then(function(){b.populate(h)})}},{key:"populate",value:function(b){for(var a=this,c=Promise.resolve(),d=function(d){c=
c.then(function(){return e.appendTo(b,a.makeEl(b,d))})},f=0;f<this.conf.capacity;f++)d(f);return c}},{key:"slide",value:function(b,a,c,e,g){var d=this;return f.Deferred(function(h){g.css({transform:"translateX("+b+"px)",transition:"transform "+a+"ms ease-in-out "+c+"ms"}).on("transitionend",function(){f.isFunction(e)&&e.call(d,g);h.resolve();g.off("transitionend")})}).promise()}},{key:"makeItem",value:function(b,a){var c=this,d=e.makeElement("history-item","item","li"),g=e.makeAction("history-action"),
h=a.title?a.title:a.changes;d.width(b.width());d.prop("width",b.width());d.css("display","block");g.attr("title",h);g.html(a.changes);g.on("click",function(b){f.isFunction(c.conf.onTimeleapClick)&&c.undo.call(c,c.conf.onTimeleapClick,a)});return d.append(g)}},{key:"makeEl",value:function(b,a){var c=e.makeElement("history-item","item","li"),d=e.makeAction("history-action"),f=b.height()/this.conf.capacity,g=b.outerWidth();c.css({width:g,height:f+"px",top:f*a+"px",left:"auto",transform:"translateX("+
g+"px)"});return c.append(d)}},{key:"setEl",value:function(b,a){var c=this,d=f(b).find("button");d.attr("title",a.title?a.title:a.changes);d.html(a.changes);d.off();d.on("click",function(b){f.isFunction(c.conf.onTimeleapClick)&&c.undo.call(c,c.conf.onTimeleapClick,a)})}},{key:"makeDom",value:function(){var b=e.makeAction("history-opener"),a=e.makeAction("history-undo"),c=e.makeText("history-heading"),f=e.makeElement("history-list","list","ol"),g=e.makeGroup("history-drawer",b,a,c,f);e.applyLanguage(c,
this.conf.lang.heading);e.applyLanguage(a,this.conf.lang.undo);e.applyLanguage(b,this.conf.lang.open);return{drawer:g,open:b,heading:c,undo:a,list:f}}},{key:"initialState",value:function(){this.records=[];this.current=0;this.opened=this.active=!1}},{key:"unrender",value:function(){this.dom&&(this.dom.drawer.remove(),this.dom=void 0)}},{key:"renew",value:function(){for(var b=this,a=arguments.length,c=Array(a),e=0;e<a;e++)c[e]=arguments[e];return this.clear().done(function(a){b.addRecord.apply(b,c)})}},
{key:"clear",value:function(){var b=this,a=this.dom.drawer,c=function(a){var c=b.dom.list;return c.empty().promise().then(function(a){b.initialState();b.populate(c)})};return f.Deferred(function(d){b.opened||b.active?(b.hide(),a.attr("disabled","disabled"),a.on("transitionend",function(e){c().then(function(c){a.removeAttr("disabled");d.resolve.call(b)});a.off("transitionend")})):c().then(function(a){d.resolve.call(b)})}).promise()}},{key:"hide",value:function(){this.deactivate();this.close()}},{key:"show",
value:function(){this.activate();this.open()}},{key:"activate",value:function(){this.active=!0;var b=this.dom.drawer;e.setActiveState(b);b.hasClass("cutter-disabled")&&e.setEnabled(b)}},{key:"deactivate",value:function(){this.active=!1;e.setInitState(this.dom.drawer)}},{key:"open",value:function(){this.opened=!0;this.dom.drawer.addClass("cutter-open");e.setEnabled(this.dom.drawer)}},{key:"close",value:function(){this.opened=!1;this.dom.drawer.removeClass("cutter-open");e.setDisabled(this.dom.drawer)}}]);
return b}();h.History=b})(ImagePlugin||{},jQuery,ImagePlugin.Utils);"use strict";_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){f=function(){function b(e,d){_classCallCheck(this,b);this.view=e;this.conf=d}_createClass(b,[{key:"makeFileControls",value:function(){var b=e.makeInput("filename","text"),d=e.makeSelect("filetype","jpg","png"),a=e.makeAction("download"),c=e.makeGroup("file-meta",b,d,a),f=e.makeToolbar("file-controls");e.setDisabled(b,d,a);f.append(c);return{toolbar:f,controls:{filename:b,filetype:d,download:a}}}},{key:"make",value:function(){var b=e.makeElement("sidebar","box","section"),d=e.makeElement("preview",
"box","section"),a=e.makeElement("main","main","main"),c=this.makeFileControls();b.append(c.toolbar);a.append(d,b);return{main:a,toolbars:{file:c},sidebar:b,preview:d}}}]);return b}();h.View=f})(ImagePlugin||{},jQuery,ImagePlugin.Utils);"use strict";_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();
function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){var b=function(){function b(d,a){_classCallCheck(this,b);this.view=d;this.conf=a;this.dom=void 0;this.available=a.available;this.disabled=["filters","settings","crop"]}_createClass(b,[{key:"applyLanguage",value:function(){var b=this.conf.lang.controls,a=b.source,c=b.crop,f=b.filters,g=b.settings,h=this.dom.controls,q=h.source,n=h.crop,t=h.filters,r=h.settings;e.applyLanguage(h.camera,b.camera);e.applyLanguage(q,a);e.applyLanguage(n,c);e.applyLanguage(t,f);e.applyLanguage(r,g)}},{key:"render",
value:function(){var b=this,a=this.dom=this.makeDom(),c=a.toolbar,g=a.label,h=a.controls,a=this.conf.panes;0<a.length?(a=a[0].toLowerCase(),e.applyLanguage(g,this.conf.lang.controls[a])):e.applyLanguage(g,this.conf.lang.controls.init);Object.keys(h).forEach(function(a){if(b.available[a]){var c=h[a];e.setInitState(c);-1<b.disabled.indexOf(a)&&e.setDisabled(c)}});c.on("click","[data-cutter-action]",e.makeDispatcher("cutterAction",function(a){var c=a.action;if(0>b.disabled.indexOf(c)){var d=h[c];a.action=
c;a.control=d;f.isFunction(b.conf.onClick)&&!1===b.conf.onClick.call(b,a)||g.text(d.text())}}));this.applyLanguage();this.view.append(this.dom.label,this.dom.toolbar)}},{key:"makeControls",value:function(){var b=this;return Object.keys(this.available).reduce(function(a,c){var d=b.available[c];void 0!==d&&d&&(a[c]=e.makeAction(c,"","primary"));return a},{})}},{key:"makeDom",value:function(){var b=this.makeControls(),a=e.makeText("controls-active"),c=e.makeToolbar("image-controls");Object.keys(b).forEach(function(a){b[a].appendTo(c)});
return{label:a,toolbar:c,controls:b}}},{key:"enable",value:function(){for(var b=this.dom.controls,a=arguments.length,c=Array(a),f=0;f<a;f++)c[f]=arguments[f];this.disabled=c.reduce(function(a,c){if(-1<a.indexOf(c)){if(b.hasOwnProperty(c))return e.setEnabled(b[c]),a.filter(function(a){return c!==a});throw Error("Undefined control: "+c);}return a},this.disabled)}},{key:"disable",value:function(){for(var b=this.dom.controls,a=arguments.length,c=Array(a),f=0;f<a;f++)c[f]=arguments[f];this.disabled=c.reduce(function(a,
c){if(0>a.indexOf(c)){if(b.hasOwnProperty(c))return e.setDisabled(b[c]),a.concat(c);throw Error("Undefined control: "+c);}return a},this.disabled)}}]);return b}();h.PanesToolbar=b})(ImagePlugin||{},jQuery,ImagePlugin.Utils);"use strict";ImagePlugin=ImagePlugin||{};
ImagePlugin.Exporter=function(h,f,e){return{init:function(b,f){var d=this,a=b.controls,c=a.filename,g=a.filetype,a=a.download;e.applyLanguage(c,f.lang.controls.filename);e.applyLanguage(g,f.lang.controls.filetype);var h=c.val(),p="image/"+g.val();c.on("change",function(a){var e=c.val().trim();e!==h&&("function"===typeof f.onFilenameChanged&&(a.filename=e,a.view=b,f.onFilenameChanged.call(d,a)),h=e)});g.on("change",function(a){var c=g.val().toLowerCase();c!==p&&("function"===typeof f.onFiletypeChanged&&
(a.filetype=c,a.view=b,f.onFiletypeChanged.call(d,a)),p=c)});a.on("click",function(a){"function"===typeof f.onClickDownload&&(a.view=b,f.onClickDownload.call(d,a))})}}}(jQuery,jQuery.fn.cropper,ImagePlugin.Utils);"use strict";
var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"===typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();
function _toConsumableArray(h){if(Array.isArray(h)){for(var f=0,e=Array(h.length);f<h.length;f++)e[f]=h[f];return e}return Array.from(h)}function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){var b=function(){function b(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{endpoints:{},currentEndPoint:""};_classCallCheck(this,b);this.view=a;this.conf=c;this.data=this.dom=void 0;this.currentEndPointKey=c.currentEndPoint;this.currentEndPoint=c.endpoints[this.currentEndPointKey];this.currentQuery=""}_createClass(b,[{key:"search",value:function(a){var b=this,d=a.query,e=a.endpoint,g=a.data;a=a.timeout;var h=g;void 0!==d&&(h=Object.assign({q:d},g));return f.ajax({type:"GET",
url:e,data:h,timeout:a,dataType:"json"}).then(function(a){f.isFunction(b.conf.onSearchSucces)&&("object"===("undefined"===typeof a?"undefined":_typeof(a))?b.data=a:"string"===typeof a&&(b.data=JSON.parse(a)),b.conf.onSearchSucces(b.data));return a},function(){if(f.isFunction(b.conf.onSearchFail))b.conf.onSearchFail();return!1}).done(function(a){if(f.isFunction(b.conf.onAfterSearch)&&!1===b.conf.onAfterSearch.call(b))return!1})}},{key:"clear",value:function(){this.data=void 0}},{key:"render",value:function(){var a=
this,b=this.makeDom(),d=b.form,g=b.input,h=b.button,q=b.selector,n=this.conf.lang,t=b.contextMenu.ref,r=this.currentEndPoint,u=this.currentEndPointKey;h.attr("data-context",this.conf.currentEndPoint);e.applyLanguage(g,n.endpoints[this.conf.currentEndPoint]);e.applyLanguage(h,n.button);e.setInitState(t);d.attr({action:this.currentEndPoint.url,method:"GET"});q.on("click",function(a){e.noOperation(a);"init"===t.attr("data-state")?(e.setActiveState(t),t.addClass("outer-close")):(e.setInitState(t),t.removeClass("outer-close"))});
t.on("click","li",function(b){e.noOperation(b);(b=f(b.target).attr("data-change-context-to"))&&Reflect.has(a.conf.endpoints,b)&&(r=a.conf.endpoints[b],u=b,d.attr({action:r}),h.attr("data-context",b),Reflect.has(n.endpoints,b)?e.applyLanguage(g,n.endpoints[b]):e.applyLanguage(g,n.endpoints["default"]));e.setInitState(t)});g.on("focus",function(b){f.isFunction(a.conf.onFocus)&&a.conf.onFocus.call(a)});g.on("focusout",function(b){f.isFunction(a.conf.onFocusout)&&a.conf.onFocusout.call(a)});d.submit("click",
function(b){e.noOperation(b);var c=g.val().trim();if(3>c.length&&f.isFunction(a.conf.onValidation))return a.conf.onValidation.call(a,b,{input:c}),!1;if(f.isFunction(a.conf.onBeforeSearch)&&!1===a.conf.onBeforeSearch.call(a,b,{input:c}))return!1;a.currentQuery=c;a.currentEndPointKey=u;a.currentEndPoint=r;a.search({query:c,endpoint:a.currentEndPoint.url,data:a.currentEndPoint.data,timeout:a.currentEndPoint.timeout||3E4})});return e.appendTo(this.view,d)}},{key:"makeDom",value:function(){var a=this,
b=e.makeAction("search-selector"),d=e.makeElement("search-context-menu","list","ul"),f=e.makeSearch("google-images"),g=Object.keys(this.conf.endpoints).map(function(b){var c=e.makeElement("search-"+b+"-context","item","li");c.attr("data-change-context-to",b);Reflect.has(a.conf.lang.endpoints,b)?e.applyLanguage(c,a.conf.lang.endpoints[b]):e.applyLanguage(c,a.conf.lang.endpoints["default"]);d.append(c);return c});f.form.append(b,d);return Object.assign(f,{selector:b,contextMenu:{ref:d,items:g}})}}]);
return b}(),g=function(){function b(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,b);this.view=a;this.conf=c;this.dom=void 0;this.items=[]}_createClass(b,[{key:"renderListUntilFit",value:function(a){var b=this;if(a&&a.length)return a.forEach(function(a){a=b.makeItem(a);b.items.push(a)}),this.addUntilFit(0,this.view.height(),this.items).then(function(a){a.length&&Promise.race(a).then(function(a){if(f.isFunction(b.conf.onFirstLoadedImage))b.conf.onFirstLoadedImage({image:{dom:a}})})})}},
{key:"render",value:function(){var a=this.dom=this.makeDom(),b=a.view,a=a.apply;a.on("click",this.onSave.bind(this)());b.on("scroll",e.throttle(this.onScroll.bind(this)()));return e.appendTo(this.view,a,b)}},{key:"unrenderList",value:function(){this.dom.list&&this.dom.list.children.remove()}},{key:"unrender",value:function(){if(void 0!==this.dom)return this.dom.apply.remove(),this.dom.view.remove(),this.dom=void 0,this.items=[],e.waitReflow(this.view[0])}},{key:"renderList",value:function(a){var b=
this;if(a.length){var d=this.dom.list;a=a.map(function(a){a=b.makeItem(a);a.load();return a.item});return e.appendTo.apply(e,[d].concat(_toConsumableArray(a)))}}},{key:"addUntilFit",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=arguments[1],d=arguments[2],f=this.dom.list,g=d.length;return new Promise(function(c){function h(a,r,k,m){void 0===a||k===g-1?c(m):(m=m.concat(a.load()),e.appendTo(f,a.item).then(function(){var e=a.item.height();r+=e;r>=b?c(m):(e=k+1,h(d[e],
r,e,m))}))}return h(d[a],0,a,[])})}},{key:"onScroll",value:function(){var a=this;return function(b){b=a.dom.view.scrollTop();var c=a.dom.view.height(),d=a.dom.list.height(),e=a.dom.list.children().length,d=Math.round(d-c);if(b>=d-30&&b<=d&&f.isFunction(a.conf.onBottomScroll))a.conf.onBottomScroll({scrolltop:b,added:e,height:c})}}},{key:"onSave",value:function(){var a=this;return function(b){e.noOperation(b);f.isFunction(a.conf.onSave)&&a.conf.onSave.call(a,b)}}},{key:"makeItem",value:function(a){var b=
this,d=f.Deferred(),g=a.filename,h=a.url,q=a.height,n=a.width;g||(g=h);var t=a.id,r=e.makeElement("search-list-item","item","li").css("position","relative"),u=e.makeGroup("search-list-info"),A=e.makeText("search-list-name",g),q=e.makeText("search-list-size",n+"x"+q),y=e.makeEphemeral(r,300,"search-list-thumbnail"),v=new Image;u.append(A,q);r.append(v,u);y.render().then(function(a){return y.activate()});v.style.display="none";g&&v.setAttribute("data-filename",g);void 0!==t&&v.setAttribute("data-library-id",
t);v.onload=function(c){v.title=g;v.alt=g;v.style.display="block";v.classList.add("image-plugin-search-list-thumbnail");r.on("click",function(c){f.isFunction(b.conf.onThumbnailClick)&&(c.image=Object.assign(a,{dom:v}),b.conf.onThumbnailClick.call(b,c))});y.deactivate(function(a){return a.remove()});d.resolve(v)};v.onerror=function(a){console.log(a);try{a.preventDefault(),a.stopPropagation(),y.deactivate(function(a){return a.remove()}),r.css("display","none"),d.reject()}catch(z){console.log("error")}};
return{item:r,load:function(a){v.src=b.conf.proxy+"?url="+encodeURI(h);return d.promise()}}}},{key:"makeDom",value:function(){var a=e.makeAction("search-apply","","secondary"),b=e.makeElement("search-view","box"),d=e.makeElement("search-list","list","ul");e.applyLanguage(a,this.conf.lang.save);b.append(d);return{apply:a,view:b,list:d}}}]);return b}();h.Search={Searcher:b,List:g}})(ImagePlugin,jQuery,ImagePlugin.Utils);"use strict";
_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){var b=function(){function b(d,a){_classCallCheck(this,b);this.view=d;this.conf=a;this.source=this.stream=this.video=void 0;this.active=this.auth=!1}_createClass(b,[{key:"requestMedia",value:function(b){var a=this;return f.Deferred(function(b){navigator.getUserMedia({video:!0},function(c){a.stream=c;a.source=window.URL.createObjectURL(c);a.auth=!0;b.resolve(a.source)},function(c){a.auth=!1;a.destroySource();b.reject(c)})}).promise()}},{key:"render",value:function(){var b=this,a=0<
arguments.length&&void 0!==arguments[0]?arguments[0]:{videoSource:void 0},c=e.makeElement("source-camera-video","item","video"),a=a.videoSource;void 0===a&&void 0!==this.source&&(a=this.source);c.on("play",function(a){b.activate();a.video=c;if(f.isFunction(b.conf.onConnected))b.conf.onConnected(a)});c.on("loadedmetadata",function(a){a=c.prop("videoWidth");var d=c.prop("videoHeight");a=e.calcAspectRatioFit(a,d,b.view.width(),b.view.height());d=a.height;c.prop("width",a.width);c.prop("height",d);b.view.append(c)});
e.playOnReady(c);c.prop("src",a);c.prop("autoplay",!0);this.video=c}},{key:"unrender",value:function(){void 0!==this.video&&(this.deactivate(),this.video.css("display","none"),this.video.remove(),this.video=void 0)}},{key:"activate",value:function(){this.active=!0;void 0!==this.video&&this.video[0].play()}},{key:"deactivate",value:function(){this.active=!1;void 0!==this.video&&this.video[0].pause()}},{key:"destroySource",value:function(){void 0!==this.stream&&(this.stream.getTracks().forEach(function(b){b.stop()}),
URL.revokeObjectURL(this.source),this.stream=this.source=void 0)}}]);return b}();h.Sources={Camera:b}})(ImagePlugin||{},jQuery,ImagePlugin.Utils);"use strict";_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();
function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e,b,g,d,a,c){function m(a,b,c){var d=this,f=e.makeGroup(a+"-controls");a=Object.keys(c).reduce(function(a,c){var e=b.call(d,c);a[c]=e;f.append(e.group);return a},{});return Object.assign(a,{group:f})}b=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,a);this.view=b;this.conf=c;this.source=void 0;this.pending=this.active=!1;this.image=this.dom=void 0}_createClass(a,[{key:"makeDom",value:function(){var a=e.makeElement("picture-pane",
"pane"),b=e.makeAction("discard-picture","","secondary"),c=e.makeAction("take-picture","","secondary"),d=e.makeText("help","","p"),f=this.conf.lang,g=f.discardSnapshot,h=f.help;e.applyLanguage(c,f.takeSnapshot);e.applyLanguage(b,g);e.applyLanguage(d,h);a.append(c,b,d);return{pane:a,discard:b,take:c}}},{key:"activate",value:function(){e.setActiveState(this.dom.pane);this.active=!0}},{key:"deactivate",value:function(){e.setInitState(this.dom.pane);this.active=!1}},{key:"toInitialState",value:function(){this.source=
null;this.pending=this.active=!1;this.dom=void 0;this.image=null}},{key:"render",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=Object.assign(this.conf,b);this.dom=this.makeDom();var c=b.onDiscardedPicture,d=b.onTookPicture,g=this.dom,b=g.pane,h=g.take,g=g.discard;e.setInitState(b);h.on("click",function(b){if(void 0!==a.source)a.pending=!0,e.sourceToImage(a.source).then(function(c){a.image=c;b.image=c;if(f.isFunction(d)&&!1===d.call(a,b))return!1;a.pending=
!1});else throw Error("Source no provided");});g.on("click",function(b){if(void 0!==a.image&&(a.image=void 0,f.isFunction(c)&&!1===c.call(a,b)))return!1});this.view.append(b)}},{key:"unrender",value:function(){this.dom&&(this.dom.pane.remove(),this.dom=void 0)}}]);return a}();g=function(){function a(b,c){_classCallCheck(this,a);this.view=b;this.conf=c;this.file=void 0}_createClass(a,[{key:"render",value:function(){var a=this;this.view.on("dragenter",function(a){e.noOperation(a)});this.view.on("dragexit",
function(a){e.noOperation(a)});this.view.on("dragleave",function(b){e.noOperation(b);a.view.removeClass("cutter-over")});this.view.on("dragover",function(b){e.noOperation(b);a.view.addClass("cutter-over")});this.view.on("drop",function(b){e.noOperation(b);a.onFileDroped(b);a.view.addClass("cutter-over")})}},{key:"getfile",value:function(){return this.file}},{key:"setfile",value:function(a){this.file=a;if(f.isFunction(this.conf.onFileChanged))this.conf.onFileChanged(this._file)}},{key:"read",value:function(a){var b=
this,c=new FileReader;c.onloadend=function(a){return function(d){b.file=a;b.file.image=c.result;console.log(b.file);if(f.isFunction(b.conf.onReadFile))b.conf.onReadFile(b.file)}}(a);c.readAsDataURL(a)}},{key:"onFileDroped",value:function(a){e.noOperation(a);var b=a.originalEvent.dataTransfer.files,c=b.length;if(f.isFunction(this.conf.onDrop)&&!1===this.conf.onDrop.call(this,a))return!1;if(0<c)if(a=b[0],b=a.type,b.match("image.*")&&!b.match("image/tiff"))this.read(a);else return f.isFunction(this.conf.onError)&&
(this.conf.onError.call(this,{type:"InvalidFileType",fileType:b}),console.log("Accepted file type is : image.* \n Given: "+b)),!1;else if(f.isFunction(this.conf.onIvalidDrop)&&!1===this.conf.onIvalidDrop.call(this))return!1}}]);return a}();d=function(){function a(b,c){_classCallCheck(this,a);this.view=b;this.conf=c;this.dom=void 0}_createClass(a,[{key:"render",value:function(){var a=e.makeInput("source-in-input","file");a.on("change",this.onFilePeeked.bind(this));a.attr("accept","image/*");this.dom=
a;return e.appendTo(this.view,a)}},{key:"read",value:function(a){var b=this,c=new FileReader;c.onloadend=function(a){return function(d){a.image;if(f.isFunction(b.conf.onReadFile))b.conf.onReadFile(c.result)}}(a);c.readAsDataURL(a)}},{key:"onFilePeeked",value:function(a){e.noOperation(a);a=a.target.files;if(0<a.length){a=a[0];var b=a.type;if(b.match("image.*")&&!b.match("image/tiff"))this.read(a);else return f.isFunction(this.conf.onError)&&(this.conf.onError.call(this,{type:"InvalidFileType",fileType:b}),
console.log("Accepted file type is : image.*\n Given: "+b)),!1}}}]);return a}();var k=function(){function a(b,c){_classCallCheck(this,a);this.view=b;this.conf=c;this.active=!1;this.dom=void 0;this.reading=!1;this._file=void 0}_createClass(a,[{key:"buildInfoList",value:function(a){var b=Object.keys(a).sort(),c=f("<template>");return b.reduce(function(b,c){var d=e.separateCamelCase(c),f=e.makeElement("source-info-entry","item","li"),d=e.makeText("source-info-key",d+":"),g=e.makeText("source-info-value",
a[c]);f.append(d,g);b.append(f);return b},c)}},{key:"read",value:function(a){var b=this,c=new FileReader;c.onloadend=function(a){return function(d){a.image=c.result;a.exif=void 0;b.parse(a)}}(a);c.readAsDataURL(a)}},{key:"parse",value:function(a){var b=this;a.exif=void 0;e.parseImageExif(a).then(function(b){a.exif=b.getAll()},function(a){console.log(a.message)}).done(function(){b.file=a;if(f.isFunction(b.conf.onReadFile))b.conf.onReadFile(b.file)})}},{key:"onPaste",value:function(a){a.stopPropagation();
a.preventDefault();a=encodeURI(a.originalEvent.clipboardData.getData("text"));if(""!==a){if(f.isFunction(this.conf.onPaste)&&!1===this.conf.onPaste.call(this,a))return!1;this.readUrl(a)}else f.isFunction(this.conf.onError)&&this.conf.onError.call(this,{source:a,type:"InvalidSource"})}},{key:"readUrl",value:function(a){function b(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",d=new Blob([a],{type:b}),e="untitle";""===c?c=a:e=c;d=new File([d],"untitle"!==e?e.split("/").pop().split(".")[0]:
e,{type:b});d.image=c;return d}var c=this;if(-1<a.indexOf("data:image/")){var d=a.slice(11,15),d=-1<d.indexOf("jpeg")?"jpeg":-1<d.indexOf("png")?"png":"";if(""!==d)d=b(a,d),this.parse(d);else return f.isFunction(this.conf.onError)&&(this.conf.onError.call(this,{fileType:d,type:"InvalidFileType"}),console.log("Accepted file type is : image.*\n Given: "+d)),!1}else e.sourceToImage(this.conf.proxy+"?url="+a).then(function(a){var d="jpeg",g=a.src;-1<g.split(".").indexOf("png")&&(d="png");var h=a.naturalWidth,
r=a.naturalHeight,k="image/"+d;try{var m=e.getBase64Image(a,{width:h,height:r,format:d}),n=b(m,k,g);c.parse(n)}catch(J){f.isFunction(c.conf.onError)&&c.conf.onError.call(c,{type:"UnknowError"}),console.log(J)}},function(){f.isFunction(c.conf.onError)&&c.conf.onError.call(c,{source:a,type:"BadRequest"});console.log("ImagePlugin.Desktop.readUrl: A problem occured while laoding the image");return!1})}},{key:"onFilePeeked",value:function(a){e.noOperation(a);a=a.target.files;if(0<a.length){a=a[0];var b=
a.type;if(b.match("image.*"))this.read(a);else return f.isFunction(this.conf.onError)&&(this.conf.onError.call(this,{type:"InvalidFileType",fileType:b}),console.log("Accepted file type is : image.*\n Given: "+b)),!1}}},{key:"onFileDroped",value:function(a){e.noOperation(a);var b=a.originalEvent,c=b.dataTransfer,b=b.dataTransfer.files,d=b.length;if(f.isFunction(this.conf.onDrop)&&!1===this.conf.onDrop.call(this,a))return!1;if(0<d)if(a=b[0],c=a.type,c.match("image.*"))this.read(a);else return f.isFunction(this.conf.onError)&&
(this.conf.onError.call(this,{type:"InvalidFileType",fileType:c}),console.log("Accepted file type is : image.* \n Given: "+c)),!1;else a=f(c.getData("text/html")),a.is("img")&&this.readUrl(encodeURI(a.attr("src")))}},{key:"render",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=Object.assign(this.conf,b),c=this.dom=this.makeDom(),b=c.input,d=c.pane,c=c.dropzone;c.on("dragenter",function(a){e.noOperation(a)});c.on("dragexit",function(a){e.noOperation(a)});
c.on("dragleave",function(b){e.noOperation(b);a.dom.dropzone.removeClass("cutter-over")});c.on("dragover",function(b){e.noOperation(b);a.dom.dropzone.addClass("cutter-over")});c.on("drop",function(b){e.noOperation(b);a.dom.dropzone.addClass("cutter-over");a.onFileDroped(b)});c.on("paste",function(b){a.dom.dropzone.addClass("cutter-over");a.onPaste(b)});b.on("change",this.onFilePeeked.bind(this));e.setInitState(d);this.view.append(d)}},{key:"unrender",value:function(){this.dom&&(this.dom.pane.remove(),
this.dom=void 0)}},{key:"makeDom",value:function(){var a=e.makeElement("source-pane","pane"),b=e.makeInput("source-in-input","file"),c=e.makeText("source-input-heading",""),d=e.makeText("source-output-heading",""),f=e.makeElement("source-out","item","output"),g=e.makeElement("source-dropzone","box"),h=e.makeElement("source-info","list","ul"),k=e.makeGroup("source-in",b,c);e.applyLanguage(g,this.conf.lang.dropzone);e.applyLanguage(b,this.conf.lang.fileButton);e.applyLanguage(c,this.conf.lang.fileButton);
e.applyLanguage(d,this.conf.lang.imageInfoHeading);g.attr("contenteditable","true");f.append(d,h);b.attr("accept","image/*");a.append(g,k,f);return{pane:a,input:b,output:f,dropzone:g,infoList:h}}},{key:"activate",value:function(){e.setActiveState(this.dom.pane);this.active=!0}},{key:"deactivate",value:function(){e.setInitState(this.dom.pane);this.active=!1}},{key:"file",get:function(){return this._file},set:function(a){var b=this;this._file=a;requestAnimationFrame(function(c){var d=void 0,g=void 0,
h=b.buildInfoList({name:a.name,size:Math.round(a.size/1024)+"Kb",type:a.type});void 0!==a.exif&&(d=b.buildInfoList(a.exif),g=e.makeText("source-output-heading","Exif"));requestAnimationFrame(function(c){c=f("<template>");c.append(h.children());void 0!==d&&c.append(g,d.children());e.setActiveState(b.dom.pane);b.dom.infoList.html(c.children());b.dom.dropzone.css("background-image","url("+a.image+")")})});if(f.isFunction(this.conf.onFileChanged))this.conf.onFileChanged(this._file)}}]);return a}(),p=
function(){function b(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,b);this.view=a;this.conf=c;this.cropper=void 0;this.active=this.cropping=!1;this.initialProperties={topX:0,topY:0,bottomX:0,bottomY:0,width:0,height:0};this.currentProperties=Object.assign({},this.initialProperties)}_createClass(b,[{key:"makeControl",value:function(a){var b=e.makeElement("crop-control","box","label"),c=e.makeInput("crop-control-"+a+"-value","number"),d=e.makeInputRange("crop-control-"+
a,[c]);d.attr("data-property",a);c.attr("data-property",a);b.text(this.conf.lang.controls[a]);b.append(d,c);return{group:b,range:d,number:c}}},{key:"makeControls",value:function(){return m.call(this,"crop",this.makeControl,this.initialProperties)}},{key:"render",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{canvas:void 0},c=this.dom=this.makeDom(),d=c.pane,g=c.apply,h=c.reset,c=c.controls;this.initCropper({canvas:b.canvas});g.on("click",function(b){return a.save()});
h.on("click",function(b){return a.reset()});Number.isNaN(this.conf.aspectRatio)||(this.dom.aspectRatio.number.attr("disabled",!0),this.dom.aspectRatio.number.attr({min:this.conf.aspectRatio,max:this.conf.aspectRatio}));e.setDisabled(this.dom.pane);c.group.on("change","[data-cutter-input]",e.makeDispatcher("property",function(c){var d=c.action;c.action=d;if(f.isFunction(b.onPropertyChange)&&!1===b.onPropertyChange.call(a,c))return!1;a.applyControl(d)}));this.view.append(d);this.active=!0}},{key:"setControlAttr",
value:function(a,b){this.dom.controls[a].range.attr(b);this.dom.controls[a].number.attr(b)}},{key:"roundCropData",value:function(a){a.x=Math.round(a.x);a.y=Math.round(a.y);a.width=Math.round(a.width);a.height=Math.round(a.height);return a}},{key:"cropperToProperties",value:function(a){var b=a=this.roundCropData(a);a=b.x;var c=b.y,d=b.width,b=b.height;return{topX:a,topY:c,bottomX:a+d,bottomY:c+b,width:d,height:b}}},{key:"initCropper",value:function(){var b=this;this.cropper=new a((0<arguments.length&&
void 0!==arguments[0]?arguments[0]:{canvas:void 0}).canvas,{viewMode:1,guides:!1,background:!1,dragMode:"none",autoCropArea:1,aspectRatio:this.conf.aspectRatio,ready:function(a){a=b.cropper.getData();b.cropping=!1;b.initialProperties=b.cropperToProperties(a);var c={x:{min:0,max:a.width},y:{min:0,max:a.height}},d=b.dom.aspectRatio,f=d.number,g=d.check;b.boundControls(c);f.attr({step:"0.01",value:e.toFixedNumber(a.width/a.height),min:"0.01",max:c.x.max,readonly:"readonly"});g.on("change",function(a){a=
g.prop("checked");var c=b.cropper.getData();a?b.cropper.setAspectRatio(c.width/c.height):b.cropper.setAspectRatio(NaN);b.cropper.setData(c)});b.dom.aspectRatio.check.attr("checked",!1);e.setEnabled(b.dom.pane)},crop:function(a){b.cropping=!0;var c=b.cropperToProperties(a.detail);a=e.toFixedNumber(c.width/c.height);e.setInput(b.dom.aspectRatio.number,a);Object.keys(c).forEach(function(a){b.setControlProperty(a,c[a])})}})}},{key:"boundControls",value:function(a){var b={min:Math.round(a.x.min),max:Math.round(a.x.max)};
a={min:Math.round(a.y.min),max:Math.round(a.y.max)};this.setControlAttr("topX",b);this.setControlAttr("topY",a);this.setControlAttr("bottomX",b);this.setControlAttr("bottomY",a);this.setControlAttr("width",b);this.setControlAttr("height",a)}},{key:"setControlProperty",value:function(a,b){var c=this.dom.controls[a].number,d=this.dom.controls[a].range;this.currentProperties[a]=b;e.setInput(d,b);e.setInput(c,b)}},{key:"forEachControl",value:function(a){var b=this;Object.keys(this.dom.controls).forEach(function(c){"group"!==
c&&a(b.dom.controls[c].group)})}},{key:"applyControl",value:function(a){if(this.currentProperties.hasOwnProperty(a)){var b=~~this.dom.controls[a].number.val(),c=this.cropper.getData(),d=c.width,c=c.height;this.setControlProperty(a,b);switch(a){case "topX":this.cropper.setData({x:b});break;case "topY":this.cropper.setData({y:b});break;case "bottomX":this.cropper.setData({x:Math.round(b-d)});break;case "bottomY":this.cropper.setData({y:Math.round(b-c)});break;case "width":this.cropper.setData({width:b});
break;case "height":this.cropper.setData({height:b})}}}},{key:"destroyCropper",value:function(){void 0!==this.cropper&&(this.cropper.destroy(),this.cropping=!1)}},{key:"restartCropper",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{canvas:void 0};this.destroyCropper();this.initCropper({canvas:a.canvas})}},{key:"save",value:function(){if(this.cropping){var a=this.cropper.getCroppedCanvas();f.isFunction(this.conf.onSave)&&this.conf.onSave.call(this,{canvas:a});a={x:{min:0,
max:this.currentProperties.width},y:{min:0,max:this.currentProperties.height}};e.setDisabled(this.dom.pane);this.boundControls(a);this.cropping=!1}}},{key:"reset",value:function(){if(this.cropping){var a=this.initialProperties,b=a.topX,c=a.topY,d=a.width,a=a.height;this.dom.aspectRatio.check.prop("checked",!1).trigger("change");this.cropper.setAspectRatio(NaN);this.cropper.setData({x:b,y:c,width:d,height:a});f.isFunction(this.conf.onReset)&&this.conf.onReset.call(this);this.currentProperties=Object.assign({},
this.initialProperties)}}},{key:"snapshot",value:function(a){return{type:"crop",state:a,changes:this.conf.lang.onSaveNotification}}},{key:"unrender",value:function(){this.dom&&(this.destroyCropper(),this.dom.pane.remove(),this.dom=void 0,this.active=!1)}},{key:"makeDom",value:function(){var a=e.makeGroup("crop-mutators"),b=e.makeAction("crop-apply","","secondary"),c=e.makeAction("crop-reset","","secondary"),d=e.makeElement("crop-pane","pane"),f=this.makeControls(),g=e.makeElement("crop-aspect-ratio",
"box","label"),h=e.makeInput("crop-aspect-ratio-check","checkbox"),k=e.makeInput("crop-aspect-ratio-number","number");e.applyLanguage(g,this.conf.lang.aspectRatio.label);e.applyLanguage(h,this.conf.lang.aspectRatio.check);e.applyLanguage(k,this.conf.lang.aspectRatio.number);e.applyLanguage(b,this.conf.lang.saveButton);e.applyLanguage(c,this.conf.lang.resetButton);g.append(h,k);a.append(b,c);f.group.append(g);d.append(a,f.group);return{controls:f,apply:b,reset:c,pane:d,aspectRatio:{group:g,number:k,
check:h}}}}]);return b}(),q=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,a);this.view=b;this.conf=c;this.dom=void 0;this.filtering=!1;this.filters=this.initFilters();this.transform=this.initTransform();this.canvasState=void 0}_createClass(a,[{key:"makeFilterControl",value:function(a){var b={min:-100,max:100,value:0,step:1,"data-filter":a};switch(a){case "gamma":b.min="0";b.max="10";b.step="0.1";break;case "stackBlur":b.min="0";b.max=
"20";break;case "contrast":b.min="-1";b.max="1";b.value="0";b.step="0.1";break;case "clip":case "hue":case "sepia":case "noise":case "sharpen":b.min="0";b.max="100";break;default:b.min="-100",b.max="100"}var c=e.makeElement("settings-control","box","label"),d=e.makeInput("settings-controls-"+a+"-value","number"),f=e.makeInputRange("settings-controls-"+a,[d],b),b=e.makeAction("quit");b.on("click",function(a){f.attr("value","0");f.val("0");f.trigger("change")});e.applyLanguage(b,this.conf.lang.resetButton);
b.html("&#x2716");c.text(this.conf.lang.controls[a]);c.append(f,d,b);return{group:c,slider:f,number:d,reset:b}}},{key:"makeFilterControls",value:function(){return m.call(this,"settings-filter",this.makeFilterControl,this.filters)}},{key:"applyFilters",value:function(){var a=this;this.forEachFilter(function(b){var c=b.val;0!==c&&a.editor.filter(b.key,c)})}},{key:"render",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{canvas:void 0},d=this.dom=this.makeDom(),g=
d.pane,h=d.apply,k=d.reset,m=d.controls,n=d.flip,p=d.flop,d=d.rotatecw;e.throttle(this.applyFilters.bind(this));h.on("click",function(b){return a.save()});k.on("click",function(b){return a.reset(a.canvasState)});d.click(function(b){var c=a.canvas.getActiveObject(),d=(a.transform.rotation+90)%360;void 0!==c&&(c.rotate(d),a.transform.rotation=d,a.canvas.setDimensions({width:a.canvas.getHeight(),height:a.canvas.getWidth()},{backstoreOnly:!0}),a.renderCanvas(),f.isFunction(a.conf.onTransform)&&(b.canvas=
a.canvas.getElement(),a.conf.onTransform.call(a,b)),c.center().setCoords())});n.click(function(b){b=a.canvas.getActiveObject();void 0!==b&&(a.transform.flip?(b.flipX=!1,a.transform.flip=!1):(b.flipX=!0,a.transform.flip=!0),a.renderCanvas())});p.click(function(b){b=a.canvas.getActiveObject();void 0!==b&&(a.transform.flop?(b.flipY=!1,a.transform.flop=!1):(b.flipY=!0,a.transform.flop=!0),a.renderCanvas())});m.group.on("change","[data-filter]",e.makeDispatcher("filter",function(d){var e=d.action,g=Number(a.dom.controls[e].slider.val());
if(f.isFunction(b.onFilterChange)&&!1===b.onFilterChange.call(a,d))return!1;void 0!==a.canvas&&(d=a.canvas.getActiveObject(),a.filters.hasOwnProperty(e)&&(f.isFunction(a.conf.onBeforeRender)&&a.conf.onBeforeRender.call(a),e=a.filters[e],e.val=g,e.apply(g),g=Object.keys(a.filters).reduce(function(b,c){var d=a.filters[c];return 0!==d.val?b.concat(d.ref):b},[]),c.Image.mapFilters.call(d,a.renderCanvas.bind(a),g)))}));this.initCanvas(b.canvas).then(function(b){a.preview=a.canvas.getElement();a.canvas.on({"after:render":function(b){if(f.isFunction(a.conf.onAfterRender)&&
!1===a.conf.onAfterRender.call(a,b))return!1}});a.renderCanvas();a.view.append(g)})}},{key:"renderCanvas",value:function(){this.canvas.renderAll()}},{key:"initFilters",value:function(){var a=c.Image.filters,b=new a.BrightnessInc,d=new a.VibranceInc,e=new a.HueInc,f=new a.GammaInc,g=new a.ClipInc,h=new a.StackBlur,k=new a.ContrastInc,m=new a.SaturationInc,n=new a.ExposureInc,p=new a.SepiaInc,q=new a.NoiseInc,t=new a.Convolute;return{brightness:{ref:b,val:0,apply:function(a){b.brightness=a}},vibrance:{ref:d,
val:0,apply:function(a){d.vibrance=a}},hue:{ref:e,val:0,apply:function(a){e.hue=a}},clip:{ref:g,val:0,apply:function(a){g.clip=a}},stackBlur:{ref:h,val:0,apply:function(a){h.radius=a}},contrast:{ref:k,val:0,apply:function(a){k.contrast=a}},saturation:{ref:m,val:0,apply:function(a){m.saturation=a}},exposure:{ref:n,val:0,apply:function(a){n.exposure=a;n.ajust()}},gamma:{ref:f,val:0,apply:function(a){f.gamma=a+1}},sepia:{ref:p,val:0,apply:function(a){p.sepia=a}},noise:{ref:q,val:0,apply:function(a){q.noise=
a}},sharpen:{ref:t,val:0,apply:function(a){a/=100;t.matrix=[0,-a,0,-a,4*a+1,-a,0,-a,0]}}}}},{key:"initTransform",value:function(){return{rotation:0,flip:!1,flop:!1}}},{key:"destroyCanvas",value:function(){this.filters=this.initFilters();this.transform=this.initTransform();this.canvas=void 0}},{key:"initCanvas",value:function(a){var b=this;return f.Deferred(function(d){var f=e.cloneCanvas(a),g=f.toDataURL();b.canvasState=e.cloneCanvas(a);b.canvas=new c.Canvas(f);b.renderOnAddRemove=!1;b.stateful=!1;
new c.Image.fromURL(g,function(a){a.selectable=!1;a.hasBorders=!1;a.hasControls=!1;a.hasRotatingPoint=!1;Object.keys(b.filters).forEach(function(c){a.filters.push(b.filters[c].ref)});b.canvas.add(a);b.canvas.setActiveObject(a);d.resolve(b.canvas)})}).promise().then(function(){f.isFunction(b.conf.onInitCanvas)&&b.conf.onInitCanvas.call(b,{canvas:b.canvas.getElement()})})}},{key:"addFiltersTo",value:function(a){for(var b,c=arguments.length,d=Array(1<c?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];(b=a.filters).push.apply(b,
d)}},{key:"resetCanvas",value:function(a){this.destroyCanvas();return this.initCanvas(a)}},{key:"forEachFilter",value:function(a){var b=this;Object.keys(this.filters).forEach(function(c){var d=b.dom.controls[c];a({dom:d,key:c,oldval:b.filters[c].val,val:~~d.number.val(),filter:b.filters[c]})})}},{key:"save",value:function(){if(this.isValidSave()){var a=this.canvas.getElement();this.canvasState=e.cloneCanvas(a);f.isFunction(this.conf.onSave)&&this.conf.onSave.call(this,a)}}},{key:"isValidSave",value:function(){var a=
this,b=this.transform.flip||this.transform.flop||0!==this.transform.rotation,c=Object.keys(this.filters).some(function(b){return 0!==a.filters[b].val});return b||c}},{key:"resetControls",value:function(){this.forEachFilter(function(a){var b=a.dom.slider;a=a.dom.number;b.attr("value","0");a.attr("value","0");b.val("0");a.val("0")})}},{key:"reset",value:function(a){var b=this;if(void 0!==a)return f.Deferred().resolve().then(function(c){f.isFunction(b.conf.onReset)&&b.conf.onReset.call(b,a)}).then(function(c){return b.resetCanvas(a).then(function(a){return b.resetControls()})}).done(function(a){f.isFunction(b.conf.onResetDone)&&
b.conf.onResetDone.call(b)})}},{key:"snapshot",value:function(a){var b=function(a,b,c){return Object.keys(a).reduce(function(d,e){var f=c[e],g=b(a[e]);"number"===typeof g?0!==g&&(g=g.toString(),"rotation"===e&&(g+="\u00b0"),d+=f+" "+g+", "):"boolean"===typeof g&&g&&(d+=f+", ");return d},"")},c=b(this.filters,function(a){return a.val},this.conf.lang.controls),b=b(this.transform,function(a){return a},this.conf.lang.transform);return{changes:(c+b).slice(0,-2),type:"settings",state:a}}},{key:"makeDom",
value:function(){var a=e.makeGroup("filters-mutators"),b=e.makeAction("filters-apply","","secondary"),c=e.makeAction("filters-reset","","secondary"),d=e.makeElement("settings-pane","pane"),f=e.makeAction("settings-flip","","secondary"),g=e.makeAction("settings-flop","","secondary"),h=e.makeAction("settings-rotatecw","","secondary"),k=e.makeGroup("settings-rotation",f,g,h);e.applyLanguage(f,this.conf.lang.flipButton);e.applyLanguage(g,this.conf.lang.flopButton);e.applyLanguage(h,this.conf.lang.rotate90Button);
e.applyLanguage(b,this.conf.lang.saveButton);e.applyLanguage(c,this.conf.lang.resetButton);var m=this.makeFilterControls();a.append(b,c);d.append(a,k,m.group);return{controls:m,apply:b,reset:c,pane:d,flip:f,flop:g,rotatecw:h}}},{key:"unrender",value:function(){void 0!==this.dom&&(this.dom.pane.remove(),this.dom=void 0);this.destroyCanvas()}}]);return a}(),n=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,a);this.view=b;this.conf=c;this.toInitialState()}
_createClass(a,[{key:"makePreset",value:function(a){var b=e.makeAction("filters-"+a,e.separateCamelCase(a));b.attr("data-preset",a);this.presets[a]&&b.addClass("cutter-set");return b}},{key:"makePresets",value:function(){var a=this,b=e.makeElement("filters-presets","list","ul"),c=Object.keys(this.presets).reduce(function(c,d){var e=a.makePreset(d);c[d]=e;b.append(e);return c},{});return Object.assign(c,{group:b})}},{key:"applyFilter",value:function(a){var b=this;if(!this.presets[a]){if(f.isFunction(this.conf.onSelect)&&
!1===this.conf.onSelect.call(this,a))return!1;this.filterer.revert(!1);this.filterer[a]();this.currentFilter=a;this.filtering=!0;this.filterer.render(function(c){b.filtering=!1;if(f.isFunction(b.conf.onPreview)&&!1===b.conf.onPreview.call(b,a))return!1})}}},{key:"render",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{canvas:void 0},b=Object.assign(this.conf,b),c=this.dom=this.makeDom(),d=c.pane,g=c.presets;c.apply.on("click",function(b){return a.save(b)});g.group.on("click",
"[data-preset]",e.makeDispatcher("preset",function(c){var d=c.action;c.preset=a.dom.presets[d];if(f.isFunction(b.onApplyFilter)&&!1===b.onApplyFilter.call(a,c))return!1;a.setActive(d);a.applyFilter(d)}));this.filterer=Caman(b.canvas,function(){});this.view.append(d)}},{key:"setActive",value:function(a){void 0!==this.currentFilter&&this.dom.presets[this.currentFilter].removeClass("cutter-set");this.dom.presets[a].addClass("cutter-set")}},{key:"save",value:function(a){if(void 0!==this.currentFilter&&
!this.presets[this.currentFilter]){this.presets[this.currentFilter]=1;this.setActive(this.currentFilter);var b=this.currentFilter,c=this.filterer.canvas;f.isFunction(this.conf.onSave)&&(a.canvas=c,a.filterName=b,this.conf.onSave.call(this,a))}}},{key:"replaceCanvas",value:function(a){a=f(a).removeData().removeAttr("data-caman-id")[0];this.currentFilter=void 0;this.filterer=Caman(a,null);return a}},{key:"makeDom",value:function(){var a=e.makeAction("filters-apply","Aplicar filtro","secondary"),b=e.makeElement("filters-pane",
"pane"),c=this.makePresets();e.applyLanguage(a,this.conf.lang.saveButton);b.append(a,c.group);return{presets:c,apply:a,pane:b}}},{key:"snapshot",value:function(a){var b=e.separateCamelCase((1<arguments.length&&void 0!==arguments[1]?arguments[1]:{filtername:""}).filtername),b=b.charAt(0).toUpperCase()+b.slice(1);return{type:"filters",state:a,changes:e.fmt(this.conf.lang.onSaveNotification,{filter:'<strong class="cap">'+b+"</strong>"}),title:e.fmt(this.conf.lang.onSaveNotification,{filter:""+b})}}},
{key:"unrender",value:function(){this.dom&&(this.dom.pane.remove(),this.dom=void 0);void 0!==this.filterer&&(this.filterer.revert(),this.filterer.canvas.removeAttribute("data-caman-id"),this.filterer=void 0)}},{key:"clearPresets",value:function(){var a=this;Object.keys(this.dom.presets).forEach(function(b){b=a.dom.presets[b];b.hasClass("cutter-set")&&b.removeClass("cutter-set")});this.initialPresets()}},{key:"initialPresets",value:function(){this.presets={vintage:0,lomo:0,clarity:0,sinCity:0,sunrise:0,
crossProcess:0,orangePeel:0,love:0,grungy:0,jarques:0,pinhole:0,oldBoot:0,glowingSun:0,hazyDays:0,herMajesty:0,nostalgia:0,hemingway:0,concentrate:0}}},{key:"toInitialState",value:function(){this.filterer=this.dom=void 0;this.filtering=!1;this.currentFilter=void 0;this.initialPresets()}}]);return a}();h.Panes={Camera:b,Desktop:k,Filters:n,Settings:q,Crop:p,Dropzone:g,FilePeeker:d}})(ImagePlugin||{},jQuery,ImagePlugin.Utils,ImagePlugin.Editor,loadImage,Caman,Cropper,fabric);"use strict";
_createClass=function(){function h(f,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(f,g.key,g)}}return function(f,e,b){e&&h(f.prototype,e);b&&h(f,b);return f}}();function _classCallCheck(h,f){if(!(h instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(h,f,e){var b=function(){function b(d,a){_classCallCheck(this,b);this.conf=a;this.dom=this.makeDom();var c=this.dom.previewer;this.hidden=this.active=!1;this.canvas=this.previewed=this.image=void 0;d.append(c)}_createClass(b,[{key:"hasPreview",value:function(){return void 0!==this.previewed}},{key:"preview",value:function(b){var a=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:f.Deferred().resolve().promise();return d.then(function(e){if(void 0===
b)return a.hidden&&void 0!==a.canvas&&(a.canvas.css("visibility","visible"),a.hidden=!1),a.hasPreview()&&(f('*[data-cutter-box="previewer-preview"]').remove(),a.previewed=void 0,a.image=void 0),d;if("string"===typeof b)return a.previewImage(b,c,d).then(function(b){return!1===b?!1:a.preview(b,c,d)});e=b.nodeName;if("IMG"===e||"VIDEO"===e)return a.image=b,a.previewCanvas(b,c,d);if("CANVAS"===e)return a.previewCanvas(b,c,d)})}},{key:"previewCanvas",value:function(b){var a=this,c=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:!1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:f.Deferred().resolve().promise(),g=b.nodeName;if("IMG"===g||"VIDEO"===g){var h=document.createElement("canvas"),q=h.getContext("2d"),n=void 0,t=void 0;"IMG"===g?(g=b.naturalHeight,n=b.naturalWidth,t=g):(n=b.videoWidth,t=b.videoHeight);h.width=n;h.height=t;return d.then(function(e){a.redraw(q,b,n,t);return a.previewCanvas(h,c,d)})}if("CANVAS"===g)return d.then(function(d){a.previewed=b;d=e.makeElement("previewer-preview",
"box");d.prop("width",b.width);d.prop("height",b.height);d.append(b);a.ajustPreview(d);a.dom.previewer.append(d);c&&void 0!==a.canvas&&(a.canvas.css("visibility","hidden"),a.hidden=!0);return b})}},{key:"getCanvasElement",value:function(){if(void 0!==this.canvas)return this.canvas[0]}},{key:"setCanvas",value:function(){var b=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.previewed;if(void 0===a)this.clear();else return a=e.cloneCanvas(a),this.canvas=a=f(a),this.ajustPreview(a),
e.setActiveState(this.dom.previewer),e.html(this.dom.previewer,a).then(function(a){b.preview();b.active||b.activate();f.isFunction(b.conf.onSet)&&b.conf.onSet.call(b,b.canvas[0]);return b.getCanvasElement()})}},{key:"replace",value:function(b,a){var c=this;return this.preview(b).then(function(d){return!1!==d&&c.replaceCanvas(d,a,b)})}},{key:"modify",value:function(b,a){var c=this;return this.preview(b).then(function(d){return!1!==d&&c.modifyCanvas(d,a,b)})}},{key:"replaceCanvas",value:function(){var b=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.previewed,a=this,c=arguments[1],e=arguments[2];if(void 0!==b)return this.setCanvas(b).then(function(b){f.isFunction(a.conf.onReplaced)&&a.conf.onReplaced.call(a,b,c,e);return b})}},{key:"modifyCanvas",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.previewed,a=this,c=arguments[1],e=arguments[2];if(void 0!==b)return this.setCanvas(b).then(function(b){f.isFunction(a.conf.onModified)&&a.conf.onModified.call(a,
b,c,e);return b})}},{key:"clear",value:function(){this.hasPreview()&&this.preview();void 0!==this.canvas&&(this.active&&this.deactivate(),this.canvas.remove(),this.canvas=void 0);f.isFunction(this.conf.onClear)&&this.conf.onClear.call(this)}},{key:"ajustPreview",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.preview,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:b.prop("width"),c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:b.prop("height"),
f=this.size(),a=e.calcAspectRatioFit(a,c,f.width,f.height);b.css({width:a.width,height:a.height})}},{key:"size",value:function(){var b=this.dom.previewer.width(),a=this.dom.previewer.height();return{width:b,height:a}}},{key:"previewImage",value:function(b){var a=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:f.Deferred().resolve().promise();return"string"===typeof b?d.then(function(){return e.sourceToImage(b).then(function(b){return a.previewImage(b,
c,d)},function(a){console.log("ImagePlugin.Previewe.previewImage: Error could not load the image from: "+b);return!1})}):d.then(function(){return b}).promise()}},{key:"redraw",value:function(b,a,c,e){var d=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;b.clearRect(d,f,c,e);b.drawImage(a,d,f,c,e)}},{key:"makeDom",value:function(){return{previewer:e.makeElement("previewer","box","div")}}},{key:"activate",value:function(){this.active=
!0;f.isFunction(this.conf.onActivate)&&this.conf.onActivate.call(this)}},{key:"deactivate",value:function(){this.active=!1;f.isFunction(this.conf.onDeactivate)&&this.conf.onDeactivate.call(this)}}]);return b}();h.Previewer=b})(ImagePlugin||{},jQuery,ImagePlugin.Utils);"use strict";ImagePlugin=ImagePlugin||{};
ImagePlugin.Core=function(h,f,e){function b(){void 0!==e&&e.reset();void 0!==g&&(g.main.off(),g.main.remove(),g=void 0);w=z=x=v=y=A=u=r=t=q=p=k=m=c=d=a=void 0;void 0!==n&&(n.destroySource(),n=void 0)}var g=void 0,d=void 0,a=void 0,c=void 0,m=void 0,k=void 0,p=void 0,q=void 0,n=void 0,t=void 0,r=void 0,u=void 0,A=void 0,y=void 0,v=void 0,x=void 0,z=void 0,w=void 0,B=void 0,C=void 0,E="",I=[];return{init:function(J,D){function N(a){var b=t.dom.previewer,c=h(a.parentElement);a=f.calcAspectRatioFit(a.width,
a.height,b.width(),b.height());c.css({width:a.width,height:a.height})}function O(a){if(void 0===m)return!1;m.hasOwnProperty(a)&&m[a].addClass("cutter-set")}function G(a){if(void 0===m)return!1;m.hasOwnProperty(a)&&m[a].removeClass("cutter-set")}function L(b,c){void 0!==a&&a.activate(b)}var M=D.panes;g=(new ImagePlugin.View(J,D)).make();d=f.makeEphemeral(g.main);a=void 0;D.enableNotifications&&(a=f.makeNotification(g.preview,{lifespan:D.notificationDuration||5E3}));c=g.toolbars.file.controls;var M=
k={search:M.includes("search"),camera:M.includes("camera"),crop:M.includes("crop"),settings:M.includes("settings")},P=M.search,R=M.camera,S=M.crop,H=M.settings;w=new ImagePlugin.History(g.preview,{lang:D.lang.history,capacity:5,inDuration:350,outDuration:250,onUndo:function(a){"replace"===a.type&&(I=[])},onTimeleapClick:function(a){}});w.defaultUndo={rewind:function(a){t.replace(a,"history")},pred:function(a){return!0}};w.addUndo({rewind:function(a){t.modify(a,"history").then(function(a){u.reset(a)})},
pred:function(a){return"settings"===v.current}},{rewind:function(a){t.modify(a,"history").then(function(a){A.restartCropper({canvas:a})})},pred:function(a){return"crop"===v.current}});z=ImagePlugin.Exporter;if(P){var Z=-1,ba=!1;p=new ImagePlugin.Search.Searcher(g.sidebar,{endpoints:D.search.endpoints,currentEndPoint:D.search.currentEndPoint,size:D.search.size,lang:D.lang.search,onBeforeSearch:function(a){d.activate();Z=-1;ba=!1},onAfterSearch:function(a){d.deactivate();p.clear()},onSearchSucces:function(a){if(0<
a.length)return"library"===p.currentEndPointKey?-1===Z?(Z=p.currentEndPoint.data.pag+1,v.routeTo("search",!0,{data:a})):!1:v.routeTo("search",!0,{data:a});L({message:D.lang.search.onEmptySearchNotification})},onValidation:function(){L({message:D.lang.search.onValidationNotification})},onSearchFail:function(a){L({message:D.lang.search.onErrorNotification})},onFocus:function(a){x.dom.label.text(D.lang.search.label.text)},onFocusout:function(a){}});q=new ImagePlugin.Search.List(g.sidebar,{proxy:D.files.proxy,
lang:D.lang.search,onSave:function(a){if(void 0!==t.hasPreview()&&void 0!==t.image){var b=t.image.src.split("/").pop().split("?").pop(),c=f.fmt(D.lang.search.onSaveNotification,{image:"<strong>"+b+"</strong>"});t.replaceCanvas(t.previewed,"searchList",t.image).then(function(a){w.renew({context:"searchList",type:"replace",state:a,title:f.fmt(D.lang.search.onSaveNotification,{image:""+b}),changes:c})});L({message:f.fmt(D.lang.search.onSaveNotification,{image:"<strong>"+b+"</strong>"})})}else L({message:D.lang.search.onNoSelectedNotification})},
onThumbnailClick:function(a){if(t.active)t.preview().then(function(){return t.preview(a.image.dom)});else{var b=a.image.dom,c=b.src,d=c.slice(c.indexOf("url=")+4),e=f.fmt(D.lang.search.onSaveNotification,{image:"<strong>"+d+"</strong>"});t.preview().then(function(){return t.replace(b,"searchList")}).then(function(a){w.renew({context:"searchList",type:"replace",state:a,title:f.fmt(D.lang.search.onSaveNotification,{image:""+d}),changes:e})});L({message:f.fmt(D.lang.search.onSaveNotification,{image:"<strong>"+
d+"</strong>"})})}},onBottomScroll:function(a){var b=a.added;a=a.height;if("web"===p.currentEndPointKey)return q.addUntilFit(b,2*a,q.items);if("library"===p.currentEndPointKey){var c=p.currentEndPoint;ba||(d.activate(),p.search({query:search.currentQuery,endpoint:c.url,timeout:c.timeout||3E4,data:Object.assign({},c.data,{pag:Z})}).then(function(a){var b=Math.abs(a.length-c.data.cant);if(0===a.length||0<b)d.deactivate(),ba=!0;q.renderList(a);Z++}))}}})}n=new ImagePlugin.Sources.Camera(g.preview,{onConnected:function(a){r.source=
a.video;v.routeTo("camera")}});t=new ImagePlugin.Previewer(g.preview,{onPreviewChange:function(a){},onActivate:function(a){x.enable("crop","settings");f.setEnabled(c.filename,c.filetype,c.download)},onDeactivate:function(a){w.clear();x.disable("crop","settings");f.setDisabled(c.filename,c.filetype,c.download,c.accept)},onReplaced:function(a,b,c){E=b;C=c},onModified:function(a,b,c){I.push({source:a,context:b,originalImage:c})}});r=new ImagePlugin.Panes.Camera(g.sidebar,{lang:D.lang.cameraSourcePane,
onTookPicture:function(a){t.active&&!n.active||t.replace(a.image,"cameraPane").then(function(a){n.deactivate();L({message:D.lang.cameraSourcePane.onSaveNotification});w.renew({context:"cameraPane",type:"replace",state:a,changes:D.lang.cameraSourcePane.onSaveNotification})})},onDiscardedPicture:function(a){t.clear();w.clear();n.activate();L({message:D.lang.cameraSourcePane.onDiscardNotifaction})}});B=new ImagePlugin.Panes.Dropzone(g.preview,{onDrop:function(a){d.activate()},onReadFile:function(a){d.deactivate();
t.replace(a.image,"desktopPane").then(function(b){w.renew({context:"desktopPane",type:"replace",state:b,changes:f.fmt(D.lang.desktopSourcePane.onSaveNotification,{filename:""+a.name})})})},onError:function(a){d.deactivate();var b=desktopPane.dom.dropzone;b.hasClass("cutter-over")&&b.removeClass("cutter-over");switch(a.type){case "InvalidFileType":L({message:f.fmt(D.lang.desktopSourcePane.onInvalidFileTypeNotification,{filetype:"<strong>"+a.fileType+"</strong>"})});break;case "InvalidSource":a=a.source;
""!==a?L({message:f.fmt(D.lang.desktopSourcePane.onInvalidSourceNotification,{source:"<strong>"+a+"</strong>"})}):L({message:D.lang.desktopSourcePane.onEmptyNotification});break;case "BadRequest":L({message:f.fmt(D.lang.desktopSourcePane.onBadRequestNotification,{source:"<strong>"+a.source+"</strong>"})});break;default:L({message:D.lang.desktopSourcePane.onUnknowErrorNotification})}}});u=new ImagePlugin.Panes.Settings(g.sidebar,{lang:D.lang.settingsPane,onReset:function(a){d.activate();t.preview()},
onResetDone:function(a){d.deactivate()},onTransform:function(a){N(a.canvas)},onInitCanvas:function(a){t.preview(a.canvas,!0);N(a.canvas)},onSave:function(a){t.modify(a,"settingsPane").then(function(a){w.addRecord(u.snapshot(a));u.reset(a);L({message:D.lang.settingsPane.onSaveNotification})})}});A=new ImagePlugin.Panes.Crop(g.sidebar,{lang:D.lang.cropPane,aspectRatio:D.crop.aspectRatio,onSave:function(a){t.modify(a.canvas,"cropPane").then(function(a){w.addRecord(A.snapshot(a))})},onReset:function(a){}});
y={filename:"",url:"",format:D.output.format,dateFormat:D.output.dateFormat};z.init(g.toolbars.file,{lang:D.lang.toolbars.file,onFilenameChanged:function(a){y.filename=a.filename},onFiletypeChanged:function(a){y.format=a.filetype},onClickDownload:function(a){var b=g.toolbars.file.controls.download;a="jpg"===y.format?"jpeg":y.format;b.addClass("cutter-pending");f.sourceToImage(t.canvas,{filename:y.filename,format:"image/"+a}).then(function(a){b.removeClass("cutter-pending");y.url=a.src;f.download(y)})},
onClickAccept:function(a){if(t.active){var b=t.getCanvasElement(),c=D.output,d=c.width,e=c.height,c=c.format,f=document.createElement("canvas"),g=f.getContext("2d");if(Number.isNaN(d)||Number.isNaN(e))d=b.width,e=b.height;f.width=d;f.height=e;g.drawImage(b,0,0,d,e);h.isFunction(D.onAccept)&&(b={imageDataURL:f.toDataURL("image/"+c)},"searchList"===E&&(e=C,void 0!==e&&(d=e.src,b.imageURL=d,(d=e.getAttribute("data-library-id"))&&0===I.length&&(b.libraryID=d))),h.proxy(D.onAccept,J)(a,b))}},onClickCancel:function(a){b();
h.isFunction(D.onCancel)&&h.proxy(D.onCancel,J)(a)}});var fa=h('<div class="cutter-tutorial">');fa.text(D.lang.desktopSourcePane.dropzone.text);v=f.makeRouter();v.register("init",{onIn:function(){return f.appendTo(g.sidebar,fa)},onOut:function(){return fa.remove().promise()}});v.register("search",{onIn:function(a){return q.render().then(function(){if("web"===p.currentEndPointKey)return q.renderListUntilFit(a.params.data);if("library"===p.currentEndPointKey)return q.renderList(a.params.data)})},onOut:function(a){t.preview();
return q.unrender()}});v.register("camera",{onIn:function(a){t.active&&t.canvas.css("display","none");O("camera");r.render();r.activate()},onOut:function(a){t.active&&t.canvas.css("display","block");G("camera");r.unrender();n.unrender()},auth:function(a){return R}});v.register("settings",{onIn:function(a){O("settings");u.render({canvas:t.getCanvasElement()})},onOut:function(a){G("settings");u.unrender();t.hasPreview()&&t.preview()},auth:function(a){return H&&t.active}});v.register("crop",{onIn:function(a){O("crop");
A.render({canvas:t.getCanvasElement()})},onOut:function(a){G("crop");A.unrender()},auth:function(a){return S&&t.active}});x=new ImagePlugin.PanesToolbar(g.sidebar,{lang:D.lang.toolbars.panes,available:Object.assign(k,{search:void 0}),panes:D.panes,onClick:function(a){switch(a.action){case "camera":n.active||(n.auth?n.render():n.requestMedia().then(function(a){n.render({videoSource:a})}));break;case "crop":A.active&&!A.cropping&&t.active?A.restartCropper({canvas:t.getCanvasElement()}):v.routeTo("crop");
break;case "settings":v.routeTo("settings");break;default:console.log("Unknow Action")}}});var M=J.width(),X=J.height(),Y=g.main;768>M&&(M=768);Y.css({width:M,height:X});Y.on("click.cutter",function(a){a=a.target;var b=Y.find(".outer-close.cutter-active");0===b.has(a).length&&(f.setInitState(b),b.removeClass("outer-close"))});e(Y[0]).bind(["mod+z"],function(){w.isEmpty()||w.undo();return!1});f.waitReflow(J[0]).then(function(){var b=J.find("[data-cutter-main='main']"),c=Promise.resolve(),e=[d,w,x];
D.enableNotifications&&e.push(a);P&&e.unshift(p);c=c.then(function(){return Promise.all(e.map(function(a){return a.render()}))}).then(function(){m=x.dom.controls;f.setDisabled(w.dom.drawer)});b.length&&(c=c.then(function(){b.remove();return f.waitReflow(J[0])}));c.then(function(){f.appendTo(J,Y).then(function(){B.render();D.defaultImage&&""!==D.defaultImage&&(d.activate(),t.replace(D.defaultImage).then(function(a){a||L({message:f.fmt(D.lang.onDefaultImageErrorNotification,{source:"<strong>"+D.defaultImage+
"</strong>"})});d.deactivate()}));Y.focus()})})})},destroy:b}};"use strict";_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"===typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h};
(function(h,f,e,b,g){function d(a,c){this.options=e.extend(!0,e.fn.imagePlugin.defaults,c);this.$element=e(a);this.ipc=new b.Core(e,b.Utils,g)}d.prototype={constructor:d,version:"0.1",init:function(){this.ipc.init(this.$element,this.options)},destroy:function(){this.ipc.destroy()}};e.fn.imagePlugin=function(a,b){var c=[].slice.call(arguments,1);return this.each(function(){var b=e(this),f=b.data("fn.imagePlugin"),g="object"===("undefined"===typeof a?"undefined":_typeof(a))?a:g;f||b.data("fn.imagePlugin",
f=new d(this,g));"string"===typeof a&&f[a]?(f[a].apply(f,c),"destroy"===a&&b.removeData("fn.imagePlugin")):f.init()})};e.fn.imagePlugin.defaults={defaultImage:"",panes:["camera","crop","settings"],files:{proxy:"inc/file_proxy.php"},enableNotifications:!0,crop:{aspectRatio:NaN},search:{endpoints:{web:{url:"./inc/google_images_helper.php",data:{c:20,s:"xlarge"}},library:{url:"https://dev1.iwalp.com/dev/filter_library.php",data:{cant:20,pag:1}}},currentEndPoint:"web"},output:{width:NaN,height:NaN,format:"jpg",
dateFormat:"dd-mm-yyyy"},onCancel:function(a){},onAccept:function(a,b){console.log(b.imageDataURL)},lang:{onDefaultImageErrorNotification:"Ocurri\u00f3 un problema mientras se obten\u00eda la imagen predeterminada desde la fuente:<br/><br/>{source}.",search:{endpoints:{web:{title:"Buscar en la web...",placeholder:"Buscar en la web...",text:"Busqueda en google"},library:{title:"Buscar en la librer\u00eda...",placeholder:"Buscar en la librer\u00eda...",text:"Busqueda en la librer\u00eda"},"default":{title:"Buscar...",
placeholder:"Buscar...",text:"Buscar"}},button:{title:"Realizar busqueda"},label:{text:"Buscar Imagenes"},save:{text:"Seleccionar imagen"},onEmptySearchNotification:"No hubo resultados de b\u00fasqueda.",onSaveNotification:'La imagen "{image}" fue selecionada.',onNoSelectedNotification:"Es requerido selecionar una imagen antes de guardar.",onErrorNotification:"Ocurri\u00f3 un problema mientras se realizaba la busqueda, por favor intente nuevamente.",onValidationNotification:"El texto de busqueda no puede tener menos de 3 caracteres."},
cameraSourcePane:{takeSnapshot:{title:"Tomar Foto",text:"Tomar Foto"},discardSnapshot:{title:"Descartar Foto",text:"Descartar Foto"},help:{text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit"},onSaveNotification:"Foto tomada!",onDiscardNotifaction:"Foto descartada!"},desktopSourcePane:{dropzone:{title:"Arrastra una imagen de internet, \u00f3 toma una foto desde la webcam para comenzar la edici\u00f3n.",placeholder:"Arrastra una imagen de internet, \u00f3 toma una foto desde la webcam para comenzar la edici\u00f3n.",
text:"Arrastra una imagen de internet, \u00f3 toma una foto desde la webcam para comenzar la edici\u00f3n."},fileButton:{title:"Archivo",text:"Archivo"},imageInfoHeading:{title:"Informaci\u00f3n de la imagen",text:"Informaci\u00f3n de la imagen"},imageInfo:{name:"Nombre",size:"Tama\u00f1o",width:"Ancho",height:"Alto",extension:"Extension"},onEmptyNotification:"No se puede obtener una imagen desde una fuente vac\u00eda.",onInvalidFileTypeNotification:"Tipo de archivo invalido:<br/><br/>{filetype}",
onBadRequestNotification:"Ocurri\u00f3 un problema mientras se obten\u00eda la imagen desde la fuente:<br/><br/>{source}",onInvalidSourceNotification:"La fuente otorgada no pudo ser reconocida: <br/><br/>{source}",onUnknowError:"Ocurri\u00f3 un error desconocido.",onSaveNotification:'Archivo "{filename}" subido.'},filtersPane:{saveButton:{title:"Aplicar Filtros",text:"Aplicar Filtros"},onSaveNotification:'Filtro "{filter}" aplicado.'},settingsPane:{saveButton:{title:"Aplicar",text:"Aplicar"},resetButton:{title:"Resetear",
text:"Resetear"},flipButton:{title:"Reflejar lateralmente",text:"Flip"},flopButton:{title:"Reflejar verticalmente",text:"Flop"},rotate90Button:{title:"Rotar 90\u00b0 a sentido de la agujas del reloj",text:"Rotar 90\u00b0"},controls:{brightness:"brillo",vibrance:"viveza",hue:"matiz",gamma:"gama",clip:"corte",stackBlur:"difuminar",contrast:"contraste",saturation:"saturaci\u00f3n",exposure:"exposici\u00f3n",sepia:"sepia",noise:"ruido",sharpen:"afilado"},transform:{flip:"flip",flop:"flop",rotation:"rotaci\u00f3n"},
onSaveNotification:"Ajustes aplicados!"},cropPane:{saveButton:{title:"Aplicar",text:"Aplicar"},resetButton:{title:"Resetear",text:"Resetear"},controls:{topX:"tope X",topY:"tope Y",bottomX:"abajo X",bottomY:"abajo Y",width:"ancho px",height:"alto px"},aspectRatio:{label:{title:"R. de aspecto",text:"R. de aspecto"},check:{title:"Fijar R. de aspecto"},number:{title:"R. de aspecto"}},onSaveNotification:"Recorte aplicado."},toolbars:{panes:{toolbar:{tile:"Barra de tableros."},controls:{init:{title:"Selecciona una opci\u00f3n disponible",
text:"Opciones"},camera:{title:"Tablero de fuente de la camara",text:"Camara"},source:{title:"Tablero de fuente del escritorio",text:"Subir archivo"},crop:{title:"Tablero de recorte",text:"Recorte"},settings:{title:"Tablero de ajustes",text:"Ajustes"},filters:{title:"Tablero de filtros",text:"Filtros"}}},file:{toolbar:{tile:"Barra de exportaci\u00f3n"},controls:{filename:{title:"Nombre del archivo",placeholder:"Nombre del archivo"},filetype:{title:"Tipo de archivo"},accept:{title:"Aceptar"},cancel:{title:"Cancelar"}}}},
history:{heading:{text:"Historial de acciones",title:"Historial de acciones"},undo:{title:"Regresar al estado anterior"},open:{title:"Abrir historial de acciones"}}}}})(window,document,jQuery,ImagePlugin,Mousetrap);